import{as as q,S as P,a3 as R,d as y,s as b,m as d,U as k,a4 as W,e as v,o as C,p as x,X as z,L as F,at as H,f as j,au as I,av as B,aw as G,W as J}from"./BmSCDJil.js";import{s as X,m as U}from"./CrNMAWWc.js";import{m as O,g as L,a as T,b as N}from"./DQaJP6Gt.js";import{r as V}from"./DdT0iQQs.js";import{f as Q}from"./8Pd8KtZp.js";var Z=function(g){q(e,g);function e(o){var r=g.call(this)||this;return r._value=o,r}return Object.defineProperty(e.prototype,"value",{get:function(){return this.getValue()},enumerable:!1,configurable:!0}),e.prototype._subscribe=function(o){var r=g.prototype._subscribe.call(this,o);return!r.closed&&o.next(this._value),r},e.prototype.getValue=function(){var o=this,r=o.hasError,l=o.thrownError,c=o._value;if(r)throw l;return this._throwIfClosed(),c},e.prototype.next=function(o){g.prototype.next.call(this,this._value=o)},e}(P);const w="PieLabels",K=L(w,"label-g"),tt=L(w,"line-g"),et=L(w,"text"),_=2,it={name:w,defaultParams:k,layerIndex:W,validator:(g,{validateColumns:e})=>e(g,{outerRadius:{toBeTypes:["number"]},outerRadiusWhileHighlight:{toBeTypes:["number"]},startAngle:{toBeTypes:["number"]},endAngle:{toBeTypes:["number"]},labelCentroid:{toBeTypes:["number"]},labelFn:{toBeTypes:["Function"]},labelColorType:{toBeOption:"ColorType"}})};function at({pieData:g,arc:e,arcMouseover:o,labelCentroid:r,lineStartCentroid:l,fullParams:c}){return g.map((t,n)=>{const[i,u]=e.centroid(t),[h,s]=o.centroid(t),f=c.labelFn(t.data);return{pieDatum:t,arcIndex:n,arcLabels:f.split(`
`),lineStartX:i*l,lineStartY:u*l,lineStartMouseoverX:h*l,lineStartMouseoverY:s*l,x:i*r,y:u*r,mouseoverX:h*r,mouseoverY:s*r,textWidth:0,collisionShiftX:0,collisionShiftY:0,quadrant:i>=0&&u<=0?1:i<0&&u<=0?2:i<0&&u>0?3:4}}).filter(t=>t.pieDatum.data.visible)}function nt({labelGSelection:g,data:e,fullParams:o,fullChartParams:r,textSizePx:l}){const c=g.selectAll("text").data(e,t=>t.pieDatum.id).join("text").classed(et,!0).attr("font-weight","bold").attr("text-anchor",t=>t.quadrant==1||t.quadrant==4?"start":"end").style("dominant-baseline",t=>t.quadrant==1||t.quadrant==2?"auto":"hanging").style("cursor",t=>r.highlightTarget&&r.highlightTarget!="none"?"pointer":"none").attr("font-size",r.styles.textSize).attr("x",0).attr("y",0).attr("fill",(t,n)=>T({datum:t.pieDatum.data,colorType:o.labelColorType,fullChartParams:r})).each((t,n,i)=>{V(b(i[n]),{textArr:t.arcLabels,textSizePx:l,quadrant:t.quadrant})});return c.transition().attr("transform",t=>"translate("+t.x+","+t.y+")"),c}function st(g,e,o){const r=g.nodes(),l=o,c=r.map((t,n)=>{const i=t.getBBox(),u=[e[n].x,e[n].y];return{node:t,x:u[0],y:u[1],width:i.width,height:i.height}});for(let t=0;t<c.length;t++){const n=c[t];for(let i=t+1;i<c.length;i++){const u=c[i];e[t].textWidth=n.width;const h=n.x+e[t].collisionShiftX,s=n.y+e[t].collisionShiftY,f=u.x+e[i].collisionShiftX,a=u.y+e[i].collisionShiftY;if(!(h+n.width/2<f-u.width/2||h-n.width/2>f+u.width/2||s+n.height/2<a-u.height/2||s-n.height/2>a+u.height/2)){if(e[i].quadrant==2){const p=a>s?-l*2:-l;e[i].collisionShiftY+=p}else if(e[i].quadrant==4){const p=a>s?l:l*2;e[i].collisionShiftY+=p}}}}for(let t=c.length-1;t>=0;t--){const n=c[t];for(let i=t-1;i>=0;i--){const u=c[i];e[t].textWidth=n.width;const h=n.x+e[t].collisionShiftX,s=n.y+e[t].collisionShiftY,f=u.x+e[i].collisionShiftX,a=u.y+e[i].collisionShiftY;if(!(h+n.width/2<f-u.width/2||h-n.width/2>f+u.width/2||s+n.height/2<a-u.height/2||s-n.height/2>a+u.height/2)){if(e[i].quadrant==1){const p=a>s?-l*2:-l;e[i].collisionShiftY+=p}else if(e[i].quadrant==3){const p=a>s?l:l*2;e[i].collisionShiftY+=p}}}}g.data(e).transition().attr("transform",t=>`translate(${t.x+t.collisionShiftX},${t.y+t.collisionShiftY})`)}function rt({lineGSelection:g,data:e,fullParams:o,fullChartParams:r}){const l=e.filter(t=>t.collisionShiftX||t.collisionShiftY),c=g.selectAll("polyline").data(l,t=>t.pieDatum.id).join("polyline").attr("stroke",t=>T({datum:t.pieDatum.data,colorType:o.labelColorType,fullChartParams:r})).attr("stroke-width",1).attr("fill","none").attr("points",t=>[[t.lineStartX,t.lineStartY],[t.lineStartX,t.lineStartY]]);return c.transition().attr("points",t=>{let n=t.x+t.collisionShiftX,i=t.y+t.collisionShiftY;return[[n,i],[t.lineStartX,t.lineStartY]]}),c}function lt({textSelection:g,lineSelection:e,ids:o,fullChartParams:r}){if(g.interrupt("highlight"),e.interrupt("highlight"),!o.length){g.transition("highlight").duration(200).attr("transform",l=>`translate(${l.x+l.collisionShiftX},${l.y+l.collisionShiftY})`).style("opacity",1),e.transition("highlight").duration(200).style("opacity",1);return}g.each((l,c,t)=>{const n=b(t[c]);o.includes(l.pieDatum.id)?n.style("opacity",1).transition("highlight").duration(200).attr("transform",i=>i.collisionShiftX||i.collisionShiftY?`translate(${i.x+i.collisionShiftX},${i.y+i.collisionShiftY})`:`translate(${i.mouseoverX+i.collisionShiftX},${i.mouseoverY+i.collisionShiftY})`):n.style("opacity",r.styles.unhighlightedOpacity).transition("highlight").duration(200).attr("transform",i=>`translate(${i.x+i.collisionShiftX},${i.y+i.collisionShiftY})`)}),e.each((l,c,t)=>{const n=b(t[c]);o.includes(l.pieDatum.data.id)?n.style("opacity",1).transition("highlight").duration(200):n.style("opacity",r.styles.unhighlightedOpacity).transition("highlight").duration(200)})}function ot(g,e){const o=new P;e.containerSelection.selectAll("g").remove();const r=e.containerSelection.append("g");r.classed(tt,!0);const l=e.containerSelection.append("g");l.classed(K,!0);const c=new P,t=new P;let n=[];const i=e.seriesContainerPosition$.pipe(y(o),d(h=>h.width<h.height?h.width:h.height),v()),u=e.fullParams$.pipe(y(o),d(h=>h.labelCentroid>=_?_:h.labelCentroid));return C({shorterSideWith:i,containerVisibleComputedLayoutData:e.containerVisibleComputedLayoutData$,fullParams:e.fullParams$,fullChartParams:e.fullChartParams$,textSizePx:e.textSizePx$,lineStartCentroid:u}).pipe(y(o),x(async h=>h)).subscribe(h=>{const s=O({axisWidth:h.shorterSideWith,innerRadius:0,outerRadius:h.fullParams.outerRadius,padAngle:0,cornerRadius:0}),f=O({axisWidth:h.shorterSideWith,innerRadius:0,outerRadius:h.fullParams.outerRadiusWhileHighlight,padAngle:0,cornerRadius:0}),a=U({data:h.containerVisibleComputedLayoutData,startAngle:h.fullParams.startAngle,endAngle:h.fullParams.endAngle});n=at({pieData:a,arc:s,arcMouseover:f,labelCentroid:h.fullParams.labelCentroid,lineStartCentroid:h.lineStartCentroid,fullParams:h.fullParams}),r.selectAll("polyline").remove();const p=nt({labelGSelection:l,data:n,fullParams:h.fullParams,fullChartParams:h.fullChartParams,textSizePx:h.textSizePx});setTimeout(()=>{st(p,n,h.textSizePx);const m=rt({lineGSelection:r,data:n,fullParams:h.fullParams,fullChartParams:h.fullChartParams});t.next(m)},1e3),c.next(p)}),C({textSelection:c,lineSelection:t,highlight:e.seriesHighlight$.pipe(d(h=>h.map(s=>s.id))),fullChartParams:e.fullChartParams$}).pipe(y(o),x(async h=>h)).subscribe(h=>{lt({textSelection:h.textSelection,lineSelection:h.lineSelection,ids:h.highlight,fullChartParams:h.fullChartParams})}),()=>{o.next(void 0)}}const Tt=R(it)(({selection:g,observer:e,subject:o})=>{const r=new P,{seriesCenterSelection$:l}=X({selection:g,pluginName:w,separateSeries$:e.separateSeries$,seriesLabels$:e.seriesLabels$,seriesContainerPosition$:e.seriesContainerPosition$}),c=[];return l.pipe(y(r)).subscribe(t=>{c.forEach(n=>n()),t.each((n,i,u)=>{const h=b(u[i]),s=e.visibleComputedLayoutData$.pipe(y(r),d(a=>a[i]??a[0])),f=e.seriesContainerPosition$.pipe(y(r),d(a=>a[i]??a[0]));c[i]=ot(w,{containerSelection:h,containerVisibleComputedLayoutData$:s,fullParams$:e.fullParams$,fullChartParams$:e.fullChartParams$,textSizePx$:e.textSizePx$,seriesHighlight$:e.seriesHighlight$,seriesContainerPosition$:f,event$:o.event$})})}),()=>{r.next(void 0)}}),Y="Rose",ut=Math.PI*2,ht={name:Y,defaultParams:z,layerIndex:F,validator:(g,{validateColumns:e})=>e(g,{outerRadius:{toBeTypes:["number"]},padAngle:{toBeTypes:["number"]},strokeColorType:{toBeOption:"ColorType"},strokeWidth:{toBeTypes:["number"]},cornerRadius:{toBeTypes:["number"]},arcScaleType:{toBe:'"area" | "radius"',test:r=>r==="area"||r==="radius"},angleIncreaseWhileHighlight:{toBeTypes:["number"]}})};function ct({cornerRadius:g,outerRadius:e,axisWidth:o,maxValue:r,arcScaleType:l,fullParams:c}){const t=o/2*e,n=l==="area"?.5:1,i=B().domain([0,r]).range([0,t]).exponent(n);return u=>{const h=i(u.prevValue),s=i(u.value),f=G(h,s);return a=>{const p=f(a);return N().innerRadius(0).outerRadius(p).padAngle(c.padAngle).padRadius(p).cornerRadius(g)(u)}}}function pt({pathSelection:g,ids:e,fullParams:o,fullChartParams:r,tweenArc:l}){if(g.interrupt("highlight"),!e.length){g.transition("highlight").style("opacity",1).attr("d",c=>l(c)(1));return}g.each((c,t,n)=>{const i=b(n[t]);e.includes(c.data.id)?i.style("opacity",1).transition("highlight").ease(I).duration(500).attr("d",u=>l({...u,startAngle:u.startAngle-o.angleIncreaseWhileHighlight,endAngle:u.endAngle+o.angleIncreaseWhileHighlight})(1)):i.style("opacity",r.styles.unhighlightedOpacity).transition("highlight").attr("d",u=>l(u)(1))})}function gt(g,e){const o=new P,r=L(g,"path");let l=[];const c=e.seriesContainerPosition$.pipe(y(o),d(a=>a.width<a.height?a.width:a.height),v()),t=C({containerVisibleComputedLayoutData:e.containerVisibleComputedLayoutData$,fullParams:e.fullParams$}).pipe(y(o),x(async a=>a),d(a=>{const p=ut/a.containerVisibleComputedLayoutData.length;return a.containerVisibleComputedLayoutData.map((m,S)=>({id:m.id,data:m,index:S,value:m.value,startAngle:p*S,endAngle:p*(S+1),padAngle:a.fullParams.padAngle,prevValue:l[S]&&l[S].id===m.id?l[S].value:0}))})),n=e.fullChartParams$.pipe(y(o),d(a=>a.highlightTarget),v()),i=e.visibleComputedLayoutData$.pipe(d(a=>Math.max(...a.flat().map(p=>p.value))),v()),u=C({fullParams:e.fullParams$,axisWidth:c,maxValue:i}).pipe(y(o),x(async a=>a),d(a=>ct({cornerRadius:a.fullParams.cornerRadius,outerRadius:a.fullParams.outerRadius,axisWidth:a.axisWidth,maxValue:a.maxValue,arcScaleType:a.fullParams.arcScaleType,fullParams:a.fullParams}))),h=e.fullChartParams$.pipe(y(o),d(a=>a.transitionDuration),v()),s=new Z(!1),f=new H(a=>{C({pieData:t,tweenArc:u,transitionDuration:h,fullParams:e.fullParams$,fullChartParams:e.fullChartParams$}).pipe(y(o),x(async p=>p)).subscribe(p=>{const m=p.pieData.map(($,D)=>($.prevValue=l[D]&&l[D].id===$.id?l[D].value:0,$));s.next(!0);const S=e.containerSelection.selectAll("path").data(m,$=>$.id).join("path").classed(r,!0).style("cursor","pointer").attr("fill",($,D)=>$.data.color).attr("stroke",($,D)=>T({datum:$.data,colorType:p.fullParams.strokeColorType,fullChartParams:p.fullChartParams})).attr("stroke-width",p.fullParams.strokeWidth);S.interrupt("graphicMove"),S.transition("graphicMove").duration(p.transitionDuration).attrTween("d",p.tweenArc).on("end",()=>{a.next(S),s.next(!1)}),l=Object.assign([],m)})}).pipe(j(1));return C({pathSelection:f,SeriesDataMap:e.SeriesDataMap$,computedData:e.computedData$,highlightTarget:n}).pipe(y(o),x(async a=>a)).subscribe(a=>{a.pathSelection.on("mouseover",(p,m)=>{p.stopPropagation(),e.event$.next({type:"series",eventName:"mouseover",pluginName:g,highlightTarget:a.highlightTarget,datum:m.data,series:a.SeriesDataMap.get(m.data.seriesLabel),seriesIndex:m.data.seriesIndex,seriesLabel:m.data.seriesLabel,event:p,data:a.computedData})}).on("mousemove",(p,m)=>{p.stopPropagation(),e.event$.next({type:"series",eventName:"mousemove",pluginName:g,highlightTarget:a.highlightTarget,datum:m.data,series:a.SeriesDataMap.get(m.data.seriesLabel),seriesIndex:m.data.seriesIndex,seriesLabel:m.data.seriesLabel,event:p,data:a.computedData})}).on("mouseout",(p,m)=>{p.stopPropagation(),e.event$.next({type:"series",eventName:"mouseout",pluginName:g,highlightTarget:a.highlightTarget,datum:m.data,series:a.SeriesDataMap.get(m.data.seriesLabel),seriesIndex:m.data.seriesIndex,seriesLabel:m.data.seriesLabel,event:p,data:a.computedData})}).on("click",(p,m)=>{p.stopPropagation(),e.event$.next({type:"series",eventName:"click",pluginName:g,highlightTarget:a.highlightTarget,datum:m.data,series:a.SeriesDataMap.get(m.data.seriesLabel),seriesIndex:m.data.seriesIndex,seriesLabel:m.data.seriesLabel,event:p,data:a.computedData})})}),C({pathSelection:f,highlight:e.seriesHighlight$.pipe(d(a=>a.map(p=>p.id))),fullParams:e.fullParams$,fullChartParams:e.fullChartParams$,tweenArc:u,isTransitionMoving:s}).pipe(y(o),x(async a=>a),Q(a=>!a.isTransitionMoving)).subscribe(a=>{pt({pathSelection:a.pathSelection,ids:a.highlight,fullParams:a.fullParams,fullChartParams:a.fullChartParams,tweenArc:a.tweenArc})}),()=>{o.next(void 0)}}const Yt=R(ht)(({selection:g,name:e,subject:o,observer:r})=>{const l=new P,{seriesCenterSelection$:c}=X({selection:g,pluginName:Y,separateSeries$:r.separateSeries$,seriesLabels$:r.seriesLabels$,seriesContainerPosition$:r.seriesContainerPosition$}),t=[];return c.pipe(y(l)).subscribe(n=>{t.forEach(i=>i()),n.each((i,u,h)=>{const s=b(h[u]),f=r.visibleComputedLayoutData$.pipe(y(l),d(p=>JSON.parse(JSON.stringify(p[u]??p[0])))),a=r.seriesContainerPosition$.pipe(y(l),d(p=>JSON.parse(JSON.stringify(p[u]??p[0]))));t[u]=gt(Y,{containerSelection:s,computedData$:r.computedData$,visibleComputedData$:r.visibleComputedData$,visibleComputedLayoutData$:r.visibleComputedLayoutData$,containerVisibleComputedLayoutData$:f,SeriesDataMap$:r.SeriesDataMap$,fullParams$:r.fullParams$,fullChartParams$:r.fullChartParams$,seriesHighlight$:r.seriesHighlight$,seriesContainerPosition$:a,event$:o.event$})})}),()=>{l.next(void 0),t.forEach(n=>n())}}),A="RoseLabels",mt=L(A,"label-g"),ft=L(A,"line-g"),yt=L(A,"text"),E=2,St={name:A,defaultParams:J,layerIndex:W,validator:(g,{validateColumns:e})=>e(g,{outerRadius:{toBeTypes:["number"]},labelCentroid:{toBeTypes:["number"]},labelFn:{toBeTypes:["Function"]},labelColorType:{toBeOption:"ColorType"},arcScaleType:{toBe:'"area" | "radius"',test:r=>r==="area"||r==="radius"}})};function dt({pieData:g,labelCentroid:e,arcScaleType:o,maxValue:r,axisWidth:l,outerRadius:c,lineStartCentroid:t,fullParams:n}){const i=l/2*c,u=o==="area"?.5:1,h=B().domain([0,r]).range([0,i]).exponent(u);return g.map((s,f)=>{const a=h(s.value),p=N().innerRadius(0).outerRadius(a).padAngle(0).padRadius(a).cornerRadius(0),[m,S]=p.centroid(s),[$,D]=[m,S],M=n.labelFn(s.data);return{pieDatum:s,arcIndex:f,arcLabels:M.split(`
`),lineStartX:m*t,lineStartY:S*t,lineStartMouseoverX:$*t,lineStartMouseoverY:D*t,x:m*e,y:S*e,mouseoverX:$*e,mouseoverY:D*e,textWidth:0,collisionShiftX:0,collisionShiftY:0,quadrant:m>=0&&S<=0?1:m<0&&S<=0?2:m<0&&S>0?3:4}}).filter(s=>s.pieDatum.data.visible)}function $t({labelGSelection:g,data:e,fullParams:o,fullChartParams:r,textSizePx:l}){const c=g.selectAll("text").data(e,t=>t.pieDatum.id).join("text").classed(yt,!0).attr("font-weight","bold").attr("text-anchor",t=>t.quadrant==1||t.quadrant==4?"start":"end").style("dominant-baseline",t=>t.quadrant==1||t.quadrant==2?"auto":"hanging").style("cursor",t=>r.highlightTarget&&r.highlightTarget!="none"?"pointer":"none").attr("font-size",r.styles.textSize).attr("fill",(t,n)=>T({datum:t.pieDatum.data,colorType:o.labelColorType,fullChartParams:r})).each((t,n,i)=>{V(b(i[n]),{textArr:t.arcLabels,textSizePx:l,quadrant:t.quadrant})});return c.transition().attr("transform",t=>"translate("+t.x+","+t.y+")"),c}function Pt(g,e,o){const r=g.nodes(),l=o,c=r.map((t,n)=>{const i=t.getBBox(),u=[e[n].x,e[n].y];return{node:t,x:u[0],y:u[1],width:i.width,height:i.height}});for(let t=0;t<c.length;t++){const n=c[t];for(let i=t+1;i<c.length;i++){const u=c[i];e[t].textWidth=n.width;const h=n.x+e[t].collisionShiftX,s=n.y+e[t].collisionShiftY,f=u.x+e[i].collisionShiftX,a=u.y+e[i].collisionShiftY;if(!(h+n.width/2<f-u.width/2||h-n.width/2>f+u.width/2||s+n.height/2<a-u.height/2||s-n.height/2>a+u.height/2)){if(e[i].quadrant==2){const p=a>s?-l*2:-l;e[i].collisionShiftY+=p}else if(e[i].quadrant==4){const p=a>s?l:l*2;e[i].collisionShiftY+=p}}}}for(let t=c.length-1;t>=0;t--){const n=c[t];for(let i=t-1;i>=0;i--){const u=c[i];e[t].textWidth=n.width;const h=n.x+e[t].collisionShiftX,s=n.y+e[t].collisionShiftY,f=u.x+e[i].collisionShiftX,a=u.y+e[i].collisionShiftY;if(!(h+n.width/2<f-u.width/2||h-n.width/2>f+u.width/2||s+n.height/2<a-u.height/2||s-n.height/2>a+u.height/2)){if(e[i].quadrant==1){const p=a>s?-l*2:-l;e[i].collisionShiftY+=p}else if(e[i].quadrant==3){const p=a>s?l:l*2;e[i].collisionShiftY+=p}}}}g.data(e).transition().attr("transform",t=>`translate(${t.x+t.collisionShiftX},${t.y+t.collisionShiftY})`)}function bt({lineGSelection:g,data:e,fullParams:o,fullChartParams:r}){const l=e.filter(t=>t.collisionShiftX||t.collisionShiftY),c=g.selectAll("polyline").data(l,t=>t.pieDatum.id).join("polyline").attr("stroke",t=>T({datum:t.pieDatum.data,colorType:o.labelColorType,fullChartParams:r})).attr("stroke-width",1).attr("fill","none").attr("points",t=>[[t.lineStartX,t.lineStartY],[t.lineStartX,t.lineStartY]]);return c.transition().attr("points",t=>{let n=t.x+t.collisionShiftX,i=t.y+t.collisionShiftY;return[[n,i],[t.lineStartX,t.lineStartY]]}),c}function Ct({textSelection:g,lineSelection:e,ids:o,fullChartParams:r}){if(g.interrupt("highlight"),e.interrupt("highlight"),!o.length){g.transition("highlight").duration(200).attr("transform",l=>`translate(${l.x+l.collisionShiftX},${l.y+l.collisionShiftY})`).style("opacity",1),e.transition("highlight").duration(200).style("opacity",1);return}g.each((l,c,t)=>{const n=b(t[c]);o.includes(l.pieDatum.data.id)?n.style("opacity",1).transition("highlight").duration(200).attr("transform",i=>`translate(${i.mouseoverX+i.collisionShiftX},${i.mouseoverY+i.collisionShiftY})`):n.style("opacity",r.styles.unhighlightedOpacity).transition("highlight").duration(200).attr("transform",i=>`translate(${i.x+i.collisionShiftX},${i.y+i.collisionShiftY})`)}),e.each((l,c,t)=>{const n=b(t[c]);o.includes(l.pieDatum.data.id)?n.style("opacity",1).transition("highlight").duration(200):n.style("opacity",r.styles.unhighlightedOpacity).transition("highlight").duration(200)})}function xt(g,e){const o=new P;e.containerSelection.selectAll("g").remove();const r=e.containerSelection.append("g");r.classed(ft,!0);const l=e.containerSelection.append("g");l.classed(mt,!0);const c=new P,t=new P;let n=[];const i=e.seriesContainerPosition$.pipe(y(o),d(s=>s.width<s.height?s.width:s.height),v()),u=e.visibleComputedLayoutData$.pipe(d(s=>Math.max(...s.flat().map(f=>f.value))),v()),h=e.fullParams$.pipe(y(o),d(s=>s.labelCentroid>=E?E:s.labelCentroid));return C({shorterSideWith:i,containerVisibleComputedLayoutData:e.containerVisibleComputedLayoutData$,maxValue:u,fullParams:e.fullParams$,fullChartParams:e.fullChartParams$,textSizePx:e.textSizePx$,lineStartCentroid:h}).pipe(y(o),x(async s=>s)).subscribe(s=>{const f=Math.PI*2/s.containerVisibleComputedLayoutData.length,a=s.containerVisibleComputedLayoutData.map((m,S)=>({id:m.id,data:m,index:S,value:m.value,startAngle:f*S,endAngle:f*(S+1),padAngle:0}));n=dt({pieData:a,labelCentroid:s.fullParams.labelCentroid,arcScaleType:s.fullParams.arcScaleType,maxValue:s.maxValue,axisWidth:s.shorterSideWith,outerRadius:s.fullParams.outerRadius,lineStartCentroid:s.lineStartCentroid,fullParams:s.fullParams}),r.selectAll("polyline").remove();const p=$t({labelGSelection:l,data:n,fullParams:s.fullParams,fullChartParams:s.fullChartParams,textSizePx:s.textSizePx});setTimeout(()=>{Pt(p,n,s.textSizePx);const m=bt({lineGSelection:r,data:n,fullParams:s.fullParams,fullChartParams:s.fullChartParams});t.next(m)},1e3),c.next(p)}),C({textSelection:c,lineSelection:t,highlight:e.seriesHighlight$.pipe(d(s=>s.map(f=>f.id))),fullChartParams:e.fullChartParams$}).pipe(y(o),x(async s=>s)).subscribe(s=>{Ct({textSelection:s.textSelection,lineSelection:s.lineSelection,ids:s.highlight,fullChartParams:s.fullChartParams})}),()=>{o.next(void 0)}}const Rt=R(St)(({selection:g,observer:e,subject:o})=>{const r=new P,{seriesCenterSelection$:l}=X({selection:g,pluginName:A,separateSeries$:e.separateSeries$,seriesLabels$:e.seriesLabels$,seriesContainerPosition$:e.seriesContainerPosition$}),c=[];return l.pipe(y(r)).subscribe(t=>{c.forEach(n=>n()),t.each((n,i,u)=>{const h=b(u[i]),s=e.visibleComputedLayoutData$.pipe(y(r),d(a=>JSON.parse(JSON.stringify(a[i]??a[0])))),f=e.seriesContainerPosition$.pipe(y(r),d(a=>JSON.parse(JSON.stringify(a[i]??a[0]))));c[i]=xt(A,{containerSelection:h,visibleComputedLayoutData$:e.visibleComputedLayoutData$,containerVisibleComputedLayoutData$:s,fullParams$:e.fullParams$,fullChartParams$:e.fullChartParams$,textSizePx$:e.textSizePx$,seriesHighlight$:e.seriesHighlight$,seriesContainerPosition$:f,event$:o.event$})})}),()=>{r.next(void 0)}});export{Tt as P,Yt as R,Rt as a};
