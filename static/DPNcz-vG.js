import{S as P,o as I,t as L,m as R,d as $,l as D,k as E,s as A,be as B,b9 as F,r as U,g as v,bg as V}from"./ZOIXw5Nq.js";import{d as X}from"./GYQj1fsP.js";import{o as Y}from"./DOdCuVOe.js";const M="end",N="middle",O="end",_="auto";function q({selection:l,textClassName:s,fullParams:t,containerSize:r,fullDataFormatter:o,fullChartParams:a}){const c=t.barLabel.padding-t.axisLabel.offset[0],d=-t.barLabel.padding-t.axisLabel.offset[1];let p=-c,i=-d;l.attr("transform",n=>`translate(0, ${r.height})`).selectAll("text").data([t]).join(n=>n.append("text").style("font-weight","bold"),n=>n,n=>n.remove()).attr("text-anchor",O).attr("dominant-baseline",_).attr("font-size",a.styles.textSize).style("fill",B(t.axisLabel.colorType,a)).attr("x",p).attr("y",i).text(n=>o.yAxis.label)}function G({selection:l,fullParams:s,fullChartParams:t,transitionEase:r,rankingScale:o,valueScale:a,categoryData:c}){const d=s.barLabel.position==="none"?[]:c;return l.selectAll("text").data(d,i=>i.id).join(i=>i.append("text").style("font-weight","bold").style("pointer-events","none").attr("x",n=>a(n.value[n.xValueIndex]??0)-s.barLabel.padding).attr("y",n=>o(n.label)),i=>i.transition().duration(t.transitionDuration).ease(F(r)).attr("x",n=>a(n.value[n.xValueIndex]??0)-s.barLabel.padding).attr("y",n=>o(n.label)),i=>i.remove()).attr("text-anchor",M).attr("dominant-baseline",N).attr("font-size",t.styles.textSize).style("fill",i=>U({colorType:s.barLabel.colorType,fullChartParams:t,datum:i})).text(i=>i.label)}function H({defsSelection:l,clipPathData:s}){l.selectAll("clipPath").data(s).join(t=>t.append("clipPath"),t=>t,t=>t.remove()).attr("id",t=>t.id).each((t,r,o)=>{A(o[r]).selectAll("rect").data([t]).join(a=>a.append("rect"),a=>a,a=>a.remove()).attr("x",a=>-a.width).attr("y",0).attr("width",a=>a.width*2).attr("height",a=>a.height)})}const W=(l,{selection:s,computedData$:t,visibleComputedRankingData$:r,rankingScaleList$:o,xScale$:a,fullParams$:c,fullDataFormatter$:d,fullChartParams$:p,transitionEase$:i,containerPosition$:n,containerSize$:f,isCategorySeprate$:C})=>{const x=new P,g=v(l,"box"),h=v(l,"text"),u=I(l,"clipPath-box"),w=X({selection:s,pluginName:l,clipPathID:null,computedData$:t,containerPosition$:n,isCategorySeprate$:C}).pipe(L(x)),j=c.pipe(R(e=>e.barLabel.position),$(),D(e=>V(()=>e==="inside",a,Y(()=>0))));return f.subscribe(e=>{const m=s.selectAll("defs").data([u]).join("defs"),b=[{id:u,width:e.width,height:e.height}];H({defsSelection:m,clipPathData:b})}),E({containerSelection:w,fullParams:c,containerSize:f,fullDataFormatter:d,fullChartParams:p,transitionEase:i,visibleComputedRankingData:r,rankingScaleList:o,valueScale:j}).pipe(L(x),D(async e=>e)).subscribe(e=>{e.containerSelection.each((m,b,k)=>{const y=A(k[b]),S=e.rankingScaleList[b];if(!S)return;const T=y.selectAll(`g.${g}`).data([b]).join("g").attr("class",g).attr("clip-path",`url(#${u})`),z=y.selectAll(`g.${h}`).data([e.fullParams]).join("g").classed(h,!0);G({selection:T,fullParams:e.fullParams,fullChartParams:e.fullChartParams,transitionEase:e.transitionEase,rankingScale:S,categoryData:e.visibleComputedRankingData[b],valueScale:e.valueScale}),q({selection:z,textClassName:h,fullParams:e.fullParams,containerSize:e.containerSize,fullDataFormatter:e.fullDataFormatter,fullChartParams:e.fullChartParams})})}),()=>{x.next(void 0)}};export{W as c};
