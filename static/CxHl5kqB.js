import{C as F,Z as j,S as O,t as l,b0 as X,o as P,p as C,m as g}from"./BDGWi0VX.js";import{g as v,u as Y,v as N,h as b}from"./CQwdZll9.js";import{f as w}from"./DQbUVo-6.js";import{a as A}from"./Fzqo4Hg3.js";const T="Tooltip",R=v(T,"g"),M=v(T,"box");function H(u,a){const p=a.textSizePx*1.5;return u.filter(c=>c!="").map((c,r)=>{const n=r*p;return`<text font-size="${a.textSize}" fill="${a.textColor}" x="0" y="${n}" style="dominant-baseline:text-before-edge">${c}</text>`}).join()}function D({rootSelection:u,pluginName:a,rootWidth:p,rootHeight:c,svgString:r,tooltipStyle:n,event:o}){u.interrupt("fadeout");const m=5,i=r?[r]:[],d=r?[n]:[],s=u.selectAll(`g.${R}`).data(i).join(e=>e.append("g").classed(R,!0).attr("pointer-events","none"),e=>e,e=>e.style("opacity",0).remove()).attr("transform",()=>`translate(${o.offsetX}, ${o.offsetY})`).selectAll(`g.${M}`).data(d).join(e=>e.append("g").classed(v(a,"box"),!0)),S=s.selectAll("rect").data(d).join(e=>e.append("rect").attr("rx",m).attr("ry",m)).attr("fill",e=>e.backgroundColor).attr("stroke",e=>e.strokeColor).attr("opacity",e=>e.backgroundOpacity),f=s.selectAll("g").data(i).join(e=>e.append("g").classed(v(a,"content"),!0).attr("transform",()=>`translate(${n.padding}, ${n.padding})`));i.length&&Y(f,i[0]);const h=f!=null&&f.node()?N(f):{width:0,height:0};S.attr("width",h.width+n.padding*2).attr("height",h.height+n.padding*2);const t=s!=null&&s.node()?N(s):{width:0,height:0},$=p-t.width,x=c-t.height,z=o.offsetX+n.offset[0]>$?$-o.offsetX:n.offset[0],k=o.offsetY+n.offset[1]>x?x-o.offsetY:n.offset[1];s.attr("transform",e=>`translate(${z}, ${k})`),s.attr("transform",e=>`translate(${z}, ${k})`)}const I=F(T,j)(({selection:u,rootSelection:a,name:p,chartType:c,observer:r,subject:n})=>{const o=new O,m=n.event$.pipe(l(o),w(t=>t.eventName==="mouseover"||t.eventName==="mousemove")),i=n.event$.pipe(l(o),w(t=>t.eventName==="mouseout")),d=X(r.fullChartParams$),y=P({fullChartParams:r.fullChartParams$,fullParams:r.fullParams$,textSizePx:d}).pipe(l(o),C(async t=>t),g(t=>({backgroundColor:b(t.fullParams.backgroundColorType,t.fullChartParams),backgroundOpacity:t.fullParams.backgroundOpacity,strokeColor:b(t.fullParams.strokeColorType,t.fullChartParams),offset:t.fullParams.offset,padding:t.fullParams.padding,textSize:t.fullChartParams.styles.textSize,textSizePx:t.textSizePx,textColor:b(t.fullParams.textColorType,t.fullChartParams)}))),s=P({fullParams:r.fullParams$,tooltipStyle:y}).pipe(l(o),C(async t=>t),g(t=>t.fullParams.svgRenderFn?t.fullParams.svgRenderFn:$=>{const x=t.fullParams.textRenderFn($);return H(x,t.tooltipStyle)})),S=P({event:m,contentRenderFn:s}).pipe(l(o),C(async t=>t),g(t=>t.contentRenderFn(t.event))),f=i.pipe(l(o),g(t=>"")),h=A(m,i).pipe(l(o),g(t=>t.event));return P({svgString:A(S,f),event:h,layout:r.layout$,tooltipStyle:y}).pipe(l(o),C(async t=>t)).subscribe(t=>{D({rootSelection:a,pluginName:p,rootWidth:t.layout.rootWidth,rootHeight:t.layout.rootHeight,svgString:t.svgString,tooltipStyle:t.tooltipStyle,event:t.event})}),function(){o.next(void 0)}});export{I as T};
