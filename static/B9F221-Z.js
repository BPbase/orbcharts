import{n as Jt,u as Qt,q as Kt,o as te,c as ee}from"./ESwU5YiS.js";import{E as ae,f as $t,D as ie,a as re,S as V}from"./BJEVRPtG.js";import{c as se,g as ne,a as oe,b as le,d as ue,e as pe,D as ce,f as ge,h as me,i as de,j as fe,k as he,G as _,l as F}from"./CAxiItTp.js";import{S as xe,c as Ae,s as $e,d as De,m as Et,o as bt,t as _t,a as G,h as ye,b as Se,g as Te,A as Pe,D as Le,e as Ft,i as at,j as U,k as y,l as Ee,n as be,p as _e,_ as Fe,q as Re,O as H,r as Ie,u as Ce,v as ke,J as W,w as z,x as A,y as O,z as S,B as P,C as w,H as Vt,E as Dt,Q as ve,F as Ne,Z as jt}from"./BOl0c7Gx.js";import{g as Me,f as mt,c as Oe,L as Z}from"./v__hJFHg.js";import{c as Ge,P as Rt,a as ze,b as we,d as Be,e as Ue,B as X,f as rt,g as st,h as nt,i as He,j as Xe,k as Ve,l as je,m as Ye,n as We,o as Ze,p as qe,q as Je,r as Qe}from"./C8eOlAhV.js";import{B as ot}from"./B3AQ3Xql.js";import{B as lt}from"./B2m-KoxC.js";import{g as Ke,a as dt,b,c as k,d as ta,p as it,e as Yt,f as ea,h as aa,z as ia,m as ra,i as sa,j as It,k as na,l as Ct}from"./CXENxt6o.js";import{B as kt}from"./aXIKIArs.js";import{m as oa,S as j,P as Q}from"./BWQaSUQz.js";const la=({data:o=[],dataFormatter:i,chartParams:e,layout:n})=>{if(!o.length)return[];let s=[];try{s=o.map((g,p)=>{const c={...i.multiGrid[p],type:`multiGrid_${p}`,colorsPredicate:i.multiGrid[p].colorsPredicate,visibleFilter:i.visibleFilter,tooltipContentFormat:i.tooltipContentFormat};return se({data:g,dataFormatter:c,chartParams:e,layout:n})})}catch(g){throw Error(g)}return s},ua=({fullDataFormatter$:o,computedData$:i,layout$:e,fullChartParams$:n,event$:s})=>{const g=new xe;return Ae({fullDataFormatter:o,computedData:i}).pipe($e(async p=>p),De((p,c)=>p.fullDataFormatter.multiGrid.length===c.fullDataFormatter.multiGrid.length&&p.computedData.length===c.computedData.length),Et(p=>(g.next(void 0),p.fullDataFormatter.multiGrid.map((c,u)=>{const l=bt(c).pipe(_t(g),G(1)),d=bt(p.computedData[u]||[]).pipe(_t(g),G(1)),a=ne({fullDataFormatter$:l,layout$:e}).pipe(G(1)),t=oe({computedData$:d,fullDataFormatter$:l,layout$:e}).pipe(G(1)),m=le({gridAxesTransform$:a}).pipe(G(1)),r=ue({fullDataFormatter$:l,layout$:e}).pipe(G(1)),h=d.pipe(Et($=>$.flat())).pipe(G(1)),x=ye({datumList$:h,fullChartParams$:n,event$:s}).pipe(G(1)),f=Se({datumList$:h}).pipe(G(1)),D=Te({datumList$:h}).pipe(G(1)),L=pe({computedData$:d}).pipe(G(1));return{gridAxesTransform$:a,gridGraphicTransform$:t,gridAxesOppositeTransform$:m,gridAxesSize$:r,gridHighlight$:x,SeriesDataMap$:f,GroupDataMap$:D,visibleComputedData$:L}}))))},pa=({subject:o,observer:i})=>{const e=ua({fullDataFormatter$:i.fullDataFormatter$,computedData$:i.computedData$,layout$:i.layout$,fullChartParams$:i.fullChartParams$,event$:o.event$}).pipe(G(1));return{fullParams$:i.fullParams$,fullChartParams$:i.fullChartParams$,fullDataFormatter$:i.fullDataFormatter$,computedData$:i.computedData$,layout$:i.layout$,multiGrid$:e}};class ca extends Pe{constructor(i,e){super({defaultDataFormatter:Le,computedDataFn:la,contextObserverFn:pa},i,e)}}function ga(o,i,e,n,s,g,p,c){var u=[],l=0,d=0,a=!1,t=function(){a&&!u.length&&!l&&i.complete()},m=function(h){return l<n?r(h):u.push(h)},r=function(h){l++;var x=!1;at(e(h,d++)).subscribe(Ft(i,function(f){i.next(f)},function(){x=!0},void 0,function(){if(x)try{l--;for(var f=function(){var D=u.shift();p||r(D)};u.length&&l<n;)f();t()}catch(D){i.error(D)}}))};return o.subscribe(Ft(i,m,function(){a=!0,t()})),function(){}}function yt(o,i,e){return e===void 0&&(e=1/0),U(i)?yt(function(n,s){return y(function(g,p){return i(n,g,s,p)})(at(o(n,s)))},e):(typeof i=="number"&&(e=i),Ee(function(n,s){return ga(n,s,o,e)}))}function ma(o){return o===void 0&&(o=1/0),yt(be,o)}var da=["addListener","removeListener"],fa=["addEventListener","removeEventListener"],ha=["on","off"];function ft(o,i,e,n){if(U(e)&&(n=e,e=void 0),n)return ft(o,i,e).pipe(_e(n));var s=Fe($a(o)?fa.map(function(c){return function(u){return o[c](i,u,e)}}):xa(o)?da.map(vt(o,i)):Aa(o)?ha.map(vt(o,i)):[],2),g=s[0],p=s[1];if(!g&&Re(o))return yt(function(c){return ft(c,i,e)})(at(o));if(!g)throw new TypeError("Invalid event target");return new H(function(c){var u=function(){for(var l=[],d=0;d<arguments.length;d++)l[d]=arguments[d];return c.next(1<l.length?l:l[0])};return g(u),function(){return p(u)}})}function vt(o,i){return function(e){return function(n){return o[e](i,n)}}}function xa(o){return U(o.addListener)&&U(o.removeListener)}function Aa(o){return U(o.on)&&U(o.off)}function $a(o){return U(o.addEventListener)&&U(o.removeEventListener)}function ht(){for(var o=[],i=0;i<arguments.length;i++)o[i]=arguments[i];var e=Ie(o),n=Ce(o,1/0),s=o;return s.length?s.length===1?at(s[0]):ma(n)(ke(s,e)):ae}const et="Dots",Da=b(et,"g"),ya=b(et,"circle");function Sa({selection:o,data:i,fullParams:e,fullChartParams:n,graphicOppositeScale:s}){const g=u=>{const l=u.size();return n.transitionDuration/l};let p=0;return o.selectAll("g").data(i,u=>u.id).join(u=>(p=g(u),u.append("g").classed(Da,!0)),u=>u,u=>u.remove()).attr("transform",u=>`translate(${u.axisX}, ${u.axisY})`).each((u,l,d)=>{w(d[l]).selectAll("circle").data([u]).join(a=>a.append("circle").style("cursor","pointer").style("vector-effect","non-scaling-stroke").classed(ya,!0).attr("opacity",0).transition().delay((t,m)=>l*p).attr("opacity",1),a=>a.transition().duration(50).attr("opacity",1),a=>a.remove()).attr("r",e.radius).attr("fill",(a,t)=>dt({datum:a,colorType:e.fillColorType,fullChartParams:n})).attr("stroke",(a,t)=>dt({datum:a,colorType:e.strokeColorType,fullChartParams:n})).attr("stroke-width",e.strokeWidth).attr("transform",`scale(${s[0]}, ${s[1]})`)})}function Ta({selection:o,ids:i,onlyShowHighlighted:e,fullChartParams:n}){if(o.interrupt("highlight"),!i.length){o.transition("highlight").duration(200).style("opacity",e===!0?0:1);return}o.each((s,g,p)=>{i.includes(s.id)?w(p[g]).style("opacity",1).transition("highlight").duration(200):w(p[g]).style("opacity",e===!0?0:n.styles.unhighlightedOpacity).transition("highlight").duration(200)})}function Pa({defsSelection:o,clipPathData:i}){o.selectAll("clipPath").data(i).join(e=>e.append("clipPath"),e=>e,e=>e.remove()).attr("id",e=>e.id).each((e,n,s)=>{w(s[n]).selectAll("rect").data([e]).join("rect").attr("x",0).attr("y",0).attr("width",g=>g.width).attr("height",g=>g.height)})}const q=W(et,ce)(({selection:o,name:i,subject:e,observer:n})=>{const s=new z,g=Ke(et,"clipPath-box"),p=o.append("g").attr("clip-path",`url(#${g})`),c=p.append("defs"),u=p.append("g"),l=new z;n.gridAxesTransform$.pipe(A(s),y(r=>r.value),O()).subscribe(r=>{p.style("transform",r)}),n.gridGraphicTransform$.pipe(A(s),S(async r=>r.value),O()).subscribe(r=>{u.transition().duration(50).style("transform",r)});const d=n.gridGraphicTransform$.pipe(A(s),y(r=>[1/r.scale[0],1/r.scale[1]]));n.gridAxesSize$.pipe(A(s),S(async r=>r)).subscribe(r=>{const h=[{id:g,width:r.width,height:r.height}];Pa({defsSelection:c,clipPathData:h})});const a=n.fullChartParams$.pipe(A(s),y(r=>r.highlightTarget),O());P({computedData:n.computedData$,visibleComputedData:n.visibleComputedData$,SeriesDataMap:n.SeriesDataMap$,GroupDataMap:n.GroupDataMap$,graphicOppositeScale:d,fullChartParams:n.fullChartParams$,fullParams:n.fullParams$,highlightTarget:a}).pipe(A(s),S(async r=>r)).subscribe(r=>{const h=Sa({selection:u,data:r.visibleComputedData.flat(),fullParams:r.fullParams,fullChartParams:r.fullChartParams,graphicOppositeScale:r.graphicOppositeScale});h.on("mouseover",(x,f)=>{x.stopPropagation(),e.event$.next({type:"grid",eventName:"mouseover",pluginName:i,highlightTarget:r.highlightTarget,datum:f,series:r.SeriesDataMap.get(f.seriesLabel),seriesIndex:f.seriesIndex,seriesLabel:f.seriesLabel,groups:r.GroupDataMap.get(f.groupLabel),groupIndex:f.groupIndex,groupLabel:f.groupLabel,event:x,data:r.computedData})}).on("mousemove",(x,f)=>{x.stopPropagation(),e.event$.next({type:"grid",eventName:"mousemove",pluginName:i,highlightTarget:r.highlightTarget,data:r.computedData,datum:f,series:r.SeriesDataMap.get(f.seriesLabel),seriesIndex:f.seriesIndex,seriesLabel:f.seriesLabel,groups:r.GroupDataMap.get(f.groupLabel),groupIndex:f.groupIndex,groupLabel:f.groupLabel,event:x})}).on("mouseout",(x,f)=>{x.stopPropagation(),e.event$.next({type:"grid",eventName:"mouseout",pluginName:i,highlightTarget:r.highlightTarget,datum:f,series:r.SeriesDataMap.get(f.seriesLabel),seriesIndex:f.seriesIndex,seriesLabel:f.seriesLabel,groups:r.GroupDataMap.get(f.groupLabel),groupIndex:f.groupIndex,groupLabel:f.groupLabel,event:x,data:r.computedData})}).on("click",(x,f)=>{x.stopPropagation(),e.event$.next({type:"grid",eventName:"click",pluginName:i,highlightTarget:r.highlightTarget,datum:f,series:r.SeriesDataMap.get(f.seriesLabel),seriesIndex:f.seriesIndex,seriesLabel:f.seriesLabel,groups:r.GroupDataMap.get(f.groupLabel),groupIndex:f.groupIndex,groupLabel:f.groupLabel,event:x,data:r.computedData})}),l.next(h)});const t=n.gridHighlight$.subscribe(),m=n.fullParams$.pipe(A(s),y(r=>r.onlyShowHighlighted),O());return n.fullChartParams$.pipe(A(s),S(r=>P({graphicSelection:l,highlight:n.gridHighlight$,onlyShowHighlighted:m,fullChartParams:n.fullChartParams$}).pipe(A(s),S(async h=>h)))).subscribe(r=>{Ta({selection:r.graphicSelection,ids:r.highlight,onlyShowHighlighted:r.onlyShowHighlighted,fullChartParams:r.fullChartParams})}),()=>{t.unsubscribe(),s.next(void 0)}}),St="GroupAxis",Nt=b(St,"xAxis"),Mt=b(St,"groupingLabel"),ut=6;function La({selection:o,params:i,tickTextAlign:e,axisLabelAlign:n,gridAxesSize:s,fullDataFormatter:g,chartParams:p,groupScale:c,contentTransform:u}){const l=o.selectAll(`g.${Nt}`).data([i]).join("g").classed(Nt,!0);o.selectAll(`g.${Mt}`).data([i]).join("g").classed(Mt,!0).each((t,m,r)=>{w(r[m]).selectAll("text").data([t]).join(h=>h.append("text").style("font-weight","bold"),h=>h,h=>h.remove()).attr("text-anchor",n.textAnchor).attr("dominant-baseline",n.dominantBaseline).style("font-size",`${p.styles.textSize}px`).style("fill",k(i.labelColorType,p)).style("transform",u).text(h=>g.groupAxis.label)}).attr("transform",t=>`translate(${s.width+t.tickPadding+i.labelOffset[0]}, ${-t.tickPadding-ut-i.labelOffset[1]})`);const d=ta(c).scale(c).tickSize(i.tickFullLine==!0?-s.height:ut).tickSizeOuter(0).tickFormat(t=>it(t,i.tickFormat)).tickPadding(i.tickPadding),a=l.transition().duration(100).call(d);return a.selectAll("line").style("fill","none").style("stroke",i.tickLineVisible==!0?k(i.tickColorType,p):"none").style("stroke-dasharray",i.tickFullLineDasharray).attr("pointer-events","none"),a.selectAll("path").style("fill","none").style("stroke",i.axisLineVisible==!0?k(i.axisLineColorType,p):"none").style("shape-rendering","crispEdges"),l.selectAll("text").style("font-family","sans-serif").style("font-size",`${p.styles.textSize}px`).style("color",k(i.tickTextColorType,p)).attr("text-anchor",e.textAnchor).attr("dominant-baseline",e.dominantBaseline).attr("transform-origin",`0 -${i.tickPadding+ut}`).style("transform",u),l}const R=W(St,ge)(({selection:o,name:i,observer:e,subject:n})=>{const s=new z,g=o.append("g");e.gridAxesTransform$.pipe(A(s),y(d=>d.value),O()).subscribe(d=>{g.style("transform",d).attr("opacity",0).transition().attr("opacity",1)});const p=P({fullParams:e.fullParams$,gridAxesOppositeTransform:e.gridAxesOppositeTransform$}).pipe(A(s),S(async d=>{const a=d.gridAxesOppositeTransform.rotate+d.fullParams.tickTextRotate;return`translate(${d.gridAxesOppositeTransform.translate[0]}px, ${d.gridAxesOppositeTransform.translate[1]}px) rotate(${a}deg) rotateX(${d.gridAxesOppositeTransform.rotateX}deg) rotateY(${d.gridAxesOppositeTransform.rotateY}deg)`}),O()),c=new H(d=>{P({fullDataFormatter:e.fullDataFormatter$,gridAxesSize:e.gridAxesSize$,computedData:e.computedData$}).pipe(A(s),S(async a=>a)).subscribe(a=>{const m=a.computedData[0]?a.computedData[0].length-1:0,r=a.fullDataFormatter.groupAxis.scaleDomain[0]==="auto"?0-a.fullDataFormatter.groupAxis.scalePadding:a.fullDataFormatter.groupAxis.scaleDomain[0]-a.fullDataFormatter.groupAxis.scalePadding,h=a.fullDataFormatter.groupAxis.scaleDomain[1]==="auto"?m+a.fullDataFormatter.groupAxis.scalePadding:a.fullDataFormatter.groupAxis.scaleDomain[1]+a.fullDataFormatter.groupAxis.scalePadding,x=a.computedData[0]?a.computedData[0].length:0;let f=a.fullDataFormatter.grid.seriesType==="row"?(a.computedData[0]??[]).map(v=>v.groupLabel):a.computedData.map(v=>v[0].groupLabel);const D=new Array(x).fill(0).map((v,E)=>f[E]!=null?f[E]:String(E)).filter((v,E)=>E>=r&&E<=h),L=a.fullDataFormatter.groupAxis.scalePadding,$=Vt({axisLabels:D,axisWidth:a.gridAxesSize.width,padding:L});d.next($)})}),u=e.fullDataFormatter$.pipe(A(s),y(d=>{let a="middle",t="hanging";return d.groupAxis.position==="bottom"?(a="middle",t="hanging"):d.groupAxis.position==="top"?(a="middle",t="auto"):d.groupAxis.position==="left"?(a="end",t="middle"):d.groupAxis.position==="right"&&(a="start",t="middle"),{textAnchor:a,dominantBaseline:t}})),l=e.fullDataFormatter$.pipe(A(s),y(d=>{let a="start",t="hanging";return d.groupAxis.position==="bottom"?t="hanging":d.groupAxis.position==="top"?t="auto":d.groupAxis.position==="left"?a="end":d.groupAxis.position==="right"&&(a="start"),d.valueAxis.position==="left"?a="start":d.valueAxis.position==="right"?a="end":d.valueAxis.position==="bottom"?t="auto":d.valueAxis.position==="top"&&(t="hanging"),{textAnchor:a,dominantBaseline:t}}));return P({params:e.fullParams$,tickTextAlign:u,axisLabelAlign:l,gridAxesSize:e.gridAxesSize$,fullDataFormatter:e.fullDataFormatter$,chartParams:e.fullChartParams$,groupScale:c,contentTransform:p}).pipe(A(s),S(async d=>d)).subscribe(d=>{La({selection:g,params:d.params,tickTextAlign:d.tickTextAlign,axisLabelAlign:d.axisLabelAlign,gridAxesSize:d.gridAxesSize,fullDataFormatter:d.fullDataFormatter,chartParams:d.chartParams,groupScale:d.groupScale,contentTransform:d.contentTransform})}),()=>{s.next(void 0)}}),Tt="ValueAxis",Ot=b(Tt,"g"),Gt=b(Tt,"text"),zt=6;function Ea({selection:o,fullParams:i,tickTextAlign:e,axisLabelAlign:n,gridAxesSize:s,fullDataFormatter:g,fullChartParams:p,valueScale:c,contentTransform:u,minAndMax:l}){const d=o.selectAll(`g.${Ot}`).data([i]).join("g").classed(Ot,!0);o.selectAll(`g.${Gt}`).data([i]).join("g").classed(Gt,!0).each((h,x,f)=>{w(f[x]).selectAll("text").data([h]).join(D=>D.append("text").style("font-weight","bold"),D=>D,D=>D.remove()).attr("text-anchor",n.textAnchor).attr("dominant-baseline",n.dominantBaseline).style("font-size",`${p.styles.textSize}px`).style("fill",k(i.labelColorType,p)).style("transform",u).text(D=>g.valueAxis.label)}).attr("transform",h=>`translate(${-h.tickPadding+i.labelOffset[0]}, ${s.height+h.tickPadding+i.labelOffset[1]})`);const a=l[1]-l[0],t=Yt(c).scale(c).ticks(a>i.ticks?i.ticks:l[0]===0&&l[1]===0?1:Math.ceil(a)).tickFormat(h=>it(h,i.tickFormat)).tickSize(i.tickFullLine==!0?-s.width:zt).tickPadding(i.tickPadding),m=d.transition().duration(100).call(t);return m.selectAll("line").style("fill","none").style("stroke",i.tickLineVisible==!0?k(i.tickColorType,p):"none").style("stroke-dasharray",i.tickFullLineDasharray).attr("pointer-events","none"),m.selectAll("path").style("fill","none").style("stroke",i.axisLineVisible==!0?k(i.axisLineColorType,p):"none").style("shape-rendering","crispEdges"),d.selectAll("text").style("font-family","sans-serif").style("font-size",`${p.styles.textSize}px`).style("color",k(i.tickTextColorType,p)).attr("text-anchor",e.textAnchor).attr("dominant-baseline",e.dominantBaseline).attr("transform-origin",`-${i.tickPadding+zt} 0`).style("transform",u),d}const M=W(Tt,me)(({selection:o,name:i,observer:e,subject:n})=>{const s=new z,g=o.append("g");e.gridAxesTransform$.pipe(A(s),y(a=>a.value),O()).subscribe(a=>{g.style("transform",a).attr("opacity",0).transition().attr("opacity",1)});const p=P({fullParams:e.fullParams$,gridAxesOppositeTransform:e.gridAxesOppositeTransform$}).pipe(A(s),S(async a=>{const t=a.gridAxesOppositeTransform.rotate+a.fullParams.tickTextRotate;return`translate(${a.gridAxesOppositeTransform.translate[0]}px, ${a.gridAxesOppositeTransform.translate[1]}px) rotate(${t}deg) rotateX(${a.gridAxesOppositeTransform.rotateX}deg) rotateY(${a.gridAxesOppositeTransform.rotateY}deg)`}),O()),c=new H(a=>{P({fullDataFormatter:e.fullDataFormatter$,gridAxesSize:e.gridAxesSize$,computedData:e.computedData$}).pipe(A(s),S(async t=>t)).subscribe(t=>{const r=t.computedData[0]?t.computedData[0].length-1:0,h=t.fullDataFormatter.groupAxis.scaleDomain[0]==="auto"?0-t.fullDataFormatter.groupAxis.scalePadding:t.fullDataFormatter.groupAxis.scaleDomain[0]-t.fullDataFormatter.groupAxis.scalePadding,x=t.fullDataFormatter.groupAxis.scaleDomain[1]==="auto"?r+t.fullDataFormatter.groupAxis.scalePadding:t.fullDataFormatter.groupAxis.scaleDomain[1]+t.fullDataFormatter.groupAxis.scalePadding,f=t.computedData.map((L,$)=>L.filter((v,E)=>E>=h&&E<=x)),D=ea(f.flat());a.next(D)})}),u=new H(a=>{P({fullDataFormatter:e.fullDataFormatter$,gridAxesSize:e.gridAxesSize$,minAndMax:c}).pipe(A(s),S(async t=>t)).subscribe(t=>{const m=Dt({maxValue:t.minAndMax[1],minValue:t.minAndMax[0],axisWidth:t.gridAxesSize.height,scaleDomain:t.fullDataFormatter.valueAxis.scaleDomain,scaleRange:t.fullDataFormatter.valueAxis.scaleRange});a.next(m)})}),l=e.fullDataFormatter$.pipe(A(s),y(a=>{let t="start",m="hanging";return a.valueAxis.position==="left"?(t="end",m="middle"):a.valueAxis.position==="right"?(t="start",m="middle"):a.valueAxis.position==="bottom"?(t="middle",m="hanging"):a.valueAxis.position==="top"&&(t="middle",m="auto"),{textAnchor:t,dominantBaseline:m}})),d=e.fullDataFormatter$.pipe(A(s),y(a=>{let t="start",m="hanging";return a.groupAxis.position==="bottom"?m="auto":a.groupAxis.position==="top"?m="hanging":a.groupAxis.position==="left"?t="start":a.groupAxis.position==="right"&&(t="end"),a.valueAxis.position==="left"?t="end":a.valueAxis.position==="right"?t="start":a.valueAxis.position==="bottom"?m="hanging":a.valueAxis.position==="top"&&(m="auto"),{textAnchor:t,dominantBaseline:m}}));return P({fullParams:e.fullParams$,tickTextAlign:l,axisLabelAlign:d,computedData:e.computedData$,gridAxesSize:e.gridAxesSize$,fullDataFormatter:e.fullDataFormatter$,fullChartParams:e.fullChartParams$,valueScale:u,contentTransform:p,minAndMax:c}).pipe(A(s),S(async a=>a)).subscribe(a=>{Ea({selection:g,fullParams:a.fullParams,tickTextAlign:a.tickTextAlign,axisLabelAlign:a.axisLabelAlign,gridAxesSize:a.gridAxesSize,fullDataFormatter:a.fullDataFormatter,fullChartParams:a.fullChartParams,valueScale:a.valueScale,contentTransform:a.contentTransform,minAndMax:a.minAndMax})}),()=>{s.next(void 0)}}),Pt="ValueStackAxis",wt=b(Pt,"g"),Bt=b(Pt,"text"),Ut=6;function ba({selection:o,fullParams:i,tickTextAlign:e,axisLabelAlign:n,gridAxesSize:s,fullDataFormatter:g,fullChartParams:p,valueScale:c,contentTransform:u,minAndMax:l}){const d=o.selectAll(`g.${wt}`).data([i]).join("g").classed(wt,!0);o.selectAll(`g.${Bt}`).data([i]).join("g").classed(Bt,!0).each((h,x,f)=>{w(f[x]).selectAll("text").data([h]).join(D=>D.append("text").style("font-weight","bold"),D=>D,D=>D.remove()).attr("text-anchor",n.textAnchor).attr("dominant-baseline",n.dominantBaseline).style("font-size",`${p.styles.textSize}px`).style("fill",k(i.labelColorType,p)).style("transform",u).text(D=>g.valueAxis.label)}).attr("transform",h=>`translate(${-h.tickPadding+i.labelOffset[0]}, ${s.height+h.tickPadding+i.labelOffset[1]})`);const a=l[1]-l[0],t=Yt(c).scale(c).ticks(a>i.ticks?i.ticks:l[0]===0&&l[1]===0?1:Math.ceil(a)).tickFormat(h=>it(h,i.tickFormat)).tickSize(i.tickFullLine==!0?-s.width:Ut).tickPadding(i.tickPadding),m=d.transition().duration(100).call(t);return m.selectAll("line").style("fill","none").style("stroke",i.tickLineVisible==!0?k(i.tickColorType,p):"none").style("stroke-dasharray",i.tickFullLineDasharray).attr("pointer-events","none"),m.selectAll("path").style("fill","none").style("stroke",i.axisLineVisible==!0?k(i.axisLineColorType,p):"none").style("shape-rendering","crispEdges"),d.selectAll("text").style("font-family","sans-serif").style("font-size",`${p.styles.textSize}px`).style("color",k(i.tickTextColorType,p)).attr("text-anchor",e.textAnchor).attr("dominant-baseline",e.dominantBaseline).attr("transform-origin",`-${i.tickPadding+Ut} 0`).style("transform",u),d}const pt=W(Pt,de)(({selection:o,name:i,observer:e,subject:n})=>{const s=new z,g=o.append("g");e.gridAxesTransform$.pipe(A(s),y(a=>a.value),O()).subscribe(a=>{g.style("transform",a).attr("opacity",0).transition().attr("opacity",1)});const p=P({fullParams:e.fullParams$,gridAxesOppositeTransform:e.gridAxesOppositeTransform$}).pipe(A(s),S(async a=>{const t=a.gridAxesOppositeTransform.rotate+a.fullParams.tickTextRotate;return`translate(${a.gridAxesOppositeTransform.translate[0]}px, ${a.gridAxesOppositeTransform.translate[1]}px) rotate(${t}deg) rotateX(${a.gridAxesOppositeTransform.rotateX}deg) rotateY(${a.gridAxesOppositeTransform.rotateY}deg)`}),O()),c=new H(a=>{P({fullDataFormatter:e.fullDataFormatter$,gridAxesSize:e.gridAxesSize$,computedData:e.computedData$}).pipe(A(s),S(async t=>t)).subscribe(t=>{const r=t.computedData[0]?t.computedData[0].length-1:0,h=t.fullDataFormatter.groupAxis.scaleDomain[0]==="auto"?0-t.fullDataFormatter.groupAxis.scalePadding:t.fullDataFormatter.groupAxis.scaleDomain[0]-t.fullDataFormatter.groupAxis.scalePadding,x=t.fullDataFormatter.groupAxis.scaleDomain[1]==="auto"?r+t.fullDataFormatter.groupAxis.scalePadding:t.fullDataFormatter.groupAxis.scaleDomain[1]+t.fullDataFormatter.groupAxis.scalePadding,f=t.computedData.map(($,v)=>$.filter((E,N)=>N>=h&&N<=x)),D=new Array(f[0]?f[0].length:0).fill(null).map(($,v)=>f.reduce((E,N)=>{if(N&&N[v]){const B=N[v].value==null||N[v].visible==!1?0:N[v].value;return E+B}return E},0)),L=aa(D);a.next(L)})}),u=new H(a=>{P({fullDataFormatter:e.fullDataFormatter$,gridAxesSize:e.gridAxesSize$,minAndMax:c}).pipe(A(s),S(async t=>t)).subscribe(t=>{const m=Dt({maxValue:t.minAndMax[1],minValue:t.minAndMax[0],axisWidth:t.gridAxesSize.height,scaleDomain:t.fullDataFormatter.valueAxis.scaleDomain,scaleRange:t.fullDataFormatter.valueAxis.scaleRange});a.next(m)})}),l=e.fullDataFormatter$.pipe(A(s),y(a=>{let t="start",m="hanging";return a.valueAxis.position==="left"?(t="end",m="middle"):a.valueAxis.position==="right"?(t="start",m="middle"):a.valueAxis.position==="bottom"?(t="middle",m="hanging"):a.valueAxis.position==="top"&&(t="middle",m="auto"),{textAnchor:t,dominantBaseline:m}})),d=e.fullDataFormatter$.pipe(A(s),y(a=>{let t="start",m="hanging";return a.groupAxis.position==="bottom"?m="auto":a.groupAxis.position==="top"?m="hanging":a.groupAxis.position==="left"?t="start":a.groupAxis.position==="right"&&(t="end"),a.valueAxis.position==="left"?t="end":a.valueAxis.position==="right"?t="start":a.valueAxis.position==="bottom"?m="hanging":a.valueAxis.position==="top"&&(m="auto"),{textAnchor:t,dominantBaseline:m}}));return P({fullParams:e.fullParams$,tickTextAlign:l,axisLabelAlign:d,computedData:e.computedData$,gridAxesSize:e.gridAxesSize$,fullDataFormatter:e.fullDataFormatter$,fullChartParams:e.fullChartParams$,valueScale:u,contentTransform:p,minAndMax:c}).pipe(A(s),S(async a=>a)).subscribe(a=>{ba({selection:g,fullParams:a.fullParams,tickTextAlign:a.tickTextAlign,axisLabelAlign:a.axisLabelAlign,gridAxesSize:a.gridAxesSize,fullDataFormatter:a.fullDataFormatter,fullChartParams:a.fullChartParams,valueScale:a.valueScale,contentTransform:a.contentTransform,minAndMax:a.minAndMax})}),()=>{s.next(void 0)}}),Wt="ScalingArea",_a=b(Wt,"rect"),I=W(Wt,fe)(({selection:o,rootSelection:i,name:e,observer:n,subject:s})=>{const g=new z,p=i.insert("rect","g").classed(_a,!0).attr("opacity",0);let c={k:1,x:0,y:0};n.layout$.pipe(A(g)).subscribe(l=>{p.attr("width",l.width).attr("height",l.height).attr("x",l.left).attr("y",l.top)});const u=n.computedData$.pipe(y(l=>l[0]?l[0].length-1:0),O());return P({initGroupAxis:n.fullDataFormatter$.pipe(y(l=>l.groupAxis),$t()),fullDataFormatter:n.fullDataFormatter$,groupMaxIndex:u,layout:n.layout$,axisSize:n.gridAxesSize$}).pipe(A(g),S(async l=>l)).subscribe(l=>{const a=l.groupMaxIndex,t=l.initGroupAxis.scaleDomain[0]==="auto"?0-l.initGroupAxis.scalePadding:l.initGroupAxis.scaleDomain[0]-l.initGroupAxis.scalePadding,m=l.initGroupAxis.scaleDomain[1]==="auto"?a+l.initGroupAxis.scalePadding:l.initGroupAxis.scaleDomain[1]+l.initGroupAxis.scalePadding,r=l.fullDataFormatter.valueAxis.position==="left"||l.fullDataFormatter.valueAxis.position==="top"?[0,1]:[1,0],x=Dt({maxValue:l.groupMaxIndex,minValue:0,axisWidth:l.axisSize.width,scaleDomain:[t,m],scaleRange:r}).copy(),f=ia().on("zoom",function(L){const $=L.transform,v=N=>{const B=Math.round(N);return Math.min(a,Math.max(0,B))},E=l.fullDataFormatter.groupAxis.position==="bottom"||l.fullDataFormatter.groupAxis.position==="top"?$.rescaleX(x).domain().map(v):$.rescaleY(x).domain().map(v);E[0]<=0&&E[1]>=a?$.k<c.k&&($.k=c.k,$.x=c.x,$.y=c.y):E[1]-E[0]<=1&&$.k>c.k&&($.k=c.k,$.x=c.x,$.y=c.y),c.k=$.k,c.x=$.x,c.y=$.y,s.dataFormatter$.next({...l.fullDataFormatter,groupAxis:{...l.fullDataFormatter.groupAxis,scaleDomain:E}})});i.call(f)}),()=>{g.next(void 0),p.remove()}});function Fa(o,i){let e=new H(()=>{});return o.each(function(){const n=ft(this,i);e=ht(e,n)}),e}const xt="GroupArea",At=b(xt,"label-box");function Ra({groupLabel:o,axisX:i,axisHeight:e,fullParams:n}){return n.showLine&&o?[{id:o,x1:i,x2:i,y1:0,y2:e}]:[]}function Ia({selection:o,pluginName:i,lineData:e,fullParams:n,fullChartParams:s}){const g=b(i,"auxline"),p=o.selectAll(`line.${g}`).data(e),c=p.enter().append("line").classed(g,!0).style("stroke",l=>k(n.lineColorType,s)).style("stroke-width",1).style("stroke-dasharray",n.lineDashArray??"none").style("pointer-events","none"),u=p.merge(c);return p.exit().remove(),c.attr("x1",l=>l.x1).attr("y1",l=>l.y1).attr("x2",l=>l.x2).attr("y2",l=>l.y2),p.transition().duration(50).attr("x1",l=>l.x1).attr("y1",l=>l.y1).attr("x2",l=>l.x2).attr("y2",l=>l.y2),u}function Ca(o){o.selectAll("line").data([]).exit().remove()}function ka({groupLabel:o,axisX:i,fullParams:e}){return e.showLabel&&o?[{id:o,x:i,y:-e.labelPadding,text:it(o,e.labelTextFormat)}]:[]}function va({selection:o,labelData:i,fullParams:e,fullChartParams:n,gridAxesOppositeTransformValue:s}){const g=n.styles.textSize+4,p=o.selectAll(`g.${At}`).data(i),c=p.enter().append("g").classed(At,!0).style("cursor","pointer"),u=c.merge(p);return c.attr("transform",(l,d)=>`translate(${l.x}, ${l.y})`),p.transition().duration(50).attr("transform",(l,d)=>`translate(${l.x}, ${l.y})`),p.exit().remove(),u.each((l,d,a)=>{const t=ra(l.text,n.styles.textSize)+12,m=-t/2,r=w(a[d]).selectAll("rect").data([l]),h=r.enter().append("rect").attr("height",`${g}px`).attr("fill",D=>k(e.labelColorType,n)).attr("x",m).attr("y",-2).attr("rx",5).attr("ry",5).style("cursor","pointer");r.merge(h).attr("width",D=>`${t}px`).style("transform",s),r.exit().remove();const x=w(a[d]).selectAll("text").data([l]),f=x.enter().append("text").style("dominant-baseline","hanging").style("cursor","pointer");x.merge(f).text(D=>D.text).style("transform",s).attr("fill",D=>k(e.labelTextColorType,n)).attr("font-size",n.styles.textSize).attr("x",m+6),x.exit().remove()}),u}function Na(o){o.selectAll(`g.${At}`).data([]).exit().remove()}const Ma=W(xt,he)(({selection:o,rootSelection:i,name:e,subject:n,observer:s})=>{const g=new z,p=i.insert("rect","g").classed(b(xt,"rect"),!0).attr("opacity",0),c=o.append("g");s.layout$.pipe(A(g)).subscribe(t=>{p.attr("width",t.rootWidth).attr("height",t.rootHeight)}),s.gridAxesTransform$.pipe(A(g),y(t=>t.value),O()).subscribe(t=>{c.style("transform",t)});const u=new H(t=>{P({fullDataFormatter:s.fullDataFormatter$,gridAxesSize:s.gridAxesSize$,computedData:s.computedData$}).pipe(A(g),S(async m=>m)).subscribe(m=>{const h=m.computedData[0]?m.computedData[0].length-1:0,x=m.fullDataFormatter.groupAxis.scaleDomain[0]==="auto"?0-m.fullDataFormatter.groupAxis.scalePadding:m.fullDataFormatter.groupAxis.scaleDomain[0]-m.fullDataFormatter.groupAxis.scalePadding,f=m.fullDataFormatter.groupAxis.scaleDomain[1]==="auto"?h+m.fullDataFormatter.groupAxis.scalePadding:m.fullDataFormatter.groupAxis.scaleDomain[1]+m.fullDataFormatter.groupAxis.scalePadding,D=m.computedData[0]?m.computedData[0].length:0;let L=m.fullDataFormatter.grid.seriesType==="row"?(m.computedData[0]??[]).map(N=>N.groupLabel):m.computedData.map(N=>N[0].groupLabel);const $=new Array(D).fill(0).map((N,B)=>L[B]!=null?L[B]:String(B)).filter((N,B)=>B>=x&&B<=f),v=m.fullDataFormatter.groupAxis.scalePadding,E=Vt({axisLabels:$,axisWidth:m.gridAxesSize.width,padding:v});t.next(E)})}),l=Me({fullDataFormatter$:s.fullDataFormatter$,gridAxesSize$:s.gridAxesSize$,computedData$:s.computedData$,fullChartParams$:s.fullChartParams$}),d=s.fullChartParams$.pipe(A(g),y(t=>t.highlightTarget),O());return P({computedData:s.computedData$,gridAxesSize:s.gridAxesSize$,fullParams:s.fullParams$,fullChartParams:s.fullChartParams$,highlightTarget:d,SeriesDataMap:s.SeriesDataMap$,GroupDataMap:s.GroupDataMap$,gridGroupPositionFn:l,groupScale:u}).pipe(A(g),S(async t=>t)).subscribe(t=>{i.on("mouseover",(m,r)=>{const{groupIndex:h,groupLabel:x}=t.gridGroupPositionFn(m);n.event$.next({type:"grid",pluginName:e,eventName:"mouseover",highlightTarget:t.highlightTarget,datum:null,series:[],seriesIndex:-1,seriesLabel:"",groups:t.GroupDataMap.get(x)??[],groupIndex:h,groupLabel:x,event:m,data:t.computedData})}).on("mousemove",(m,r)=>{const{groupIndex:h,groupLabel:x}=t.gridGroupPositionFn(m);n.event$.next({type:"grid",pluginName:e,eventName:"mousemove",highlightTarget:t.highlightTarget,datum:null,series:[],seriesIndex:-1,seriesLabel:"",groups:t.GroupDataMap.get(x)??[],groupIndex:h,groupLabel:x,event:m,data:t.computedData})}).on("mouseout",(m,r)=>{const{groupIndex:h,groupLabel:x}=t.gridGroupPositionFn(m);n.event$.next({type:"grid",pluginName:e,eventName:"mouseout",highlightTarget:t.highlightTarget,datum:null,series:[],seriesIndex:-1,seriesLabel:"",groups:t.GroupDataMap.get(x)??[],groupIndex:h,groupLabel:x,event:m,data:t.computedData})}).on("click",(m,r)=>{m.stopPropagation();const{groupIndex:h,groupLabel:x}=t.gridGroupPositionFn(m);n.event$.next({type:"grid",pluginName:e,eventName:"click",highlightTarget:t.highlightTarget,datum:null,series:[],seriesIndex:-1,seriesLabel:"",groups:t.GroupDataMap.get(x)??[],groupIndex:h,groupLabel:x,event:m,data:t.computedData})})}),P({event:n.event$.pipe(mt(t=>t.eventName==="mouseover"||t.eventName==="mousemove")),computedData:s.computedData$,groupScale:u,gridAxesSize:s.gridAxesSize$,fullParams:s.fullParams$,fullChartParams:s.fullChartParams$,highlightTarget:d,gridAxesOppositeTransform:s.gridAxesOppositeTransform$,GroupDataMap:s.GroupDataMap$,gridGroupPositionFn:l}).pipe(A(g),S(async t=>t)).subscribe(t=>{const m=t.groupScale(t.event.groupLabel)??0,r=Ra({groupLabel:t.event.groupLabel,axisX:m,axisHeight:t.gridAxesSize.height,fullParams:t.fullParams});Ia({selection:c,pluginName:e,lineData:r,fullParams:t.fullParams,fullChartParams:t.fullChartParams});const h=ka({groupLabel:t.event.groupLabel,axisX:m,fullParams:t.fullParams});va({selection:c,labelData:h,fullParams:t.fullParams,fullChartParams:t.fullChartParams,gridAxesOppositeTransformValue:t.gridAxesOppositeTransform.value}).on("mouseover",(f,D)=>{const{groupIndex:L,groupLabel:$}=t.gridGroupPositionFn(f);n.event$.next({type:"grid",pluginName:e,eventName:"mouseover",highlightTarget:t.highlightTarget,datum:null,series:[],seriesIndex:-1,seriesLabel:"",groups:t.event.groups,groupIndex:L,groupLabel:$,event:f,data:t.computedData})}).on("mousemove",(f,D)=>{const{groupIndex:L,groupLabel:$}=t.gridGroupPositionFn(f);n.event$.next({type:"grid",pluginName:e,eventName:"mousemove",highlightTarget:t.highlightTarget,datum:null,series:[],seriesIndex:-1,seriesLabel:"",groups:t.event.groups,groupIndex:L,groupLabel:$,event:f,data:t.computedData})}).on("mouseout",(f,D)=>{const{groupIndex:L,groupLabel:$}=t.gridGroupPositionFn(f);n.event$.next({type:"grid",pluginName:e,eventName:"mouseout",highlightTarget:t.highlightTarget,datum:null,series:[],seriesIndex:-1,seriesLabel:"",groups:t.event.groups,groupIndex:L,groupLabel:$,event:f,data:t.computedData})}).on("click",(f,D)=>{const{groupIndex:L,groupLabel:$}=t.gridGroupPositionFn(f);n.event$.next({type:"grid",pluginName:e,eventName:"click",highlightTarget:t.highlightTarget,datum:null,series:[],seriesIndex:-1,seriesLabel:"",groups:t.event.groups,groupIndex:L,groupLabel:$,event:f,data:t.computedData})})}),Fa(p,"mouseout").pipe(A(g)).subscribe(t=>{console.log("rootMouseout"),Ca(c),Na(c)}),()=>{g.next(void 0),p.remove()}}),Oa={bars:{barWidth:0,barPadding:1,barGroupPadding:40,barRadius:!1},lines:{lineCurve:"curveLinear",lineWidth:2}},J="BarsAndLines",Ga=b(J,"bars"),za=b(J,"lines"),wa=ve(J,Oa)(({selection:o,name:i,subject:e,observer:n})=>{const s=new z,g=o.append("g").attr("class",Ga),p=o.append("g").attr("class",za);let c=()=>{},u=()=>{};const l=n.computedData$.pipe(y(r=>r[0]||[])),d=n.computedData$.pipe(y(r=>r[1]||[])),a=n.fullParams$.pipe(y(r=>r.bars)),t=n.fullParams$.pipe(y(r=>r.lines)),m=n.fullDataFormatter$.pipe(y(r=>r.multiGrid[1]));return n.multiGrid$.subscribe(r=>{r[0]?c=Ge(J,{selection:g,computedData$:l,visibleComputedData$:r[0].visibleComputedData$,SeriesDataMap$:r[0].SeriesDataMap$,GroupDataMap$:r[0].GroupDataMap$,fullParams$:a,fullChartParams$:n.fullChartParams$,gridAxesTransform$:r[0].gridAxesTransform$,gridGraphicTransform$:r[0].gridGraphicTransform$,gridAxesSize$:r[0].gridAxesSize$,gridHighlight$:r[0].gridHighlight$,event$:e.event$}):c(),r[1]?u=Oe(J,{selection:p,computedData$:d,SeriesDataMap$:r[1].SeriesDataMap$,GroupDataMap$:r[1].GroupDataMap$,fullParams$:t,fullDataFormatter$:m,fullChartParams$:n.fullChartParams$,gridAxesTransform$:r[1].gridAxesTransform$,gridGraphicTransform$:r[1].gridGraphicTransform$,gridAxesSize$:r[1].gridAxesSize$,gridHighlight$:r[1].gridHighlight$,event$:e.event$}):u()}),()=>{s.next(void 0),c(),u()}}),Ba={backgroundColorType:"background",strokeColorType:"primary",backgroundOpacity:.8,textColorType:"primary",offset:[20,5],padding:10,textRenderFn:o=>{if(o.highlightTarget==="datum"&&o.datum)return[`${o.datum.label}: ${o.datum.value}`];if(o.highlightTarget==="series"){const i=o.seriesLabel,e=o.series.map(n=>n.value).join(",");return[i,e]}else if(o.highlightTarget==="group"){const i=o.groupLabel,e=o.groups.map(n=>n.value).join(",");return[i,e]}return[]},svgRenderFn:null},Lt="Tooltip",Ht=b(Lt,"g"),Ua=b(Lt,"box");function Ha(o,i){const e=i.textSize*1.5;return o.filter(n=>n!="").map((n,s)=>{const g=s*e;return`<text font-size="${i.textSize}" fill="${i.textColor}" x="0" y="${g}" style="dominant-baseline:text-before-edge">${n}</text>`}).join()}function Xa({rootSelection:o,pluginName:i,rootWidth:e,rootHeight:n,svgString:s,tooltipStyle:g,event:p}){o.interrupt("fadeout");const c=5,u=s?[s]:[],l=s?[g]:[],a=o.selectAll(`g.${Ht}`).data(u).join($=>$.append("g").classed(Ht,!0).attr("pointer-events","none"),$=>$,$=>$.style("opacity",0).remove()).attr("transform",()=>`translate(${p.offsetX}, ${p.offsetY})`).selectAll(`g.${Ua}`).data(l).join($=>$.append("g").classed(b(i,"box"),!0)),t=a.selectAll("rect").data(l).join($=>$.append("rect").attr("rx",c).attr("ry",c)).attr("fill",$=>$.backgroundColor).attr("stroke",$=>$.strokeColor).attr("opacity",$=>$.backgroundOpacity),m=a.selectAll("g").data(u).join($=>$.append("g").classed(b(i,"content"),!0).attr("transform",()=>`translate(${g.padding}, ${g.padding})`));u.length&&sa(m,u[0]);const r=m!=null&&m.node()?It(m):{width:0,height:0};t.attr("width",r.width+g.padding*2).attr("height",r.height+g.padding*2);const h=a!=null&&a.node()?It(a):{width:0,height:0},x=e-h.width,f=n-h.height,D=p.offsetX+g.offset[0]>x?x-p.offsetX:g.offset[0],L=p.offsetY+g.offset[1]>f?f-p.offsetY:g.offset[1];a.attr("transform",$=>`translate(${D}, ${L})`),a.attr("transform",$=>`translate(${D}, ${L})`)}const T=Ne(Lt,Ba)(({selection:o,rootSelection:i,name:e,chartType:n,observer:s,subject:g})=>{const p=new z,c=g.event$.pipe(A(p),mt(r=>r.eventName==="mouseover"||r.eventName==="mousemove")),u=g.event$.pipe(A(p),mt(r=>r.eventName==="mouseout")),l=P({fullChartParams:s.fullChartParams$,fullParams:s.fullParams$}).pipe(A(p),S(async r=>r),y(r=>({backgroundColor:k(r.fullParams.backgroundColorType,r.fullChartParams),backgroundOpacity:r.fullParams.backgroundOpacity,strokeColor:k(r.fullParams.strokeColorType,r.fullChartParams),offset:r.fullParams.offset,padding:r.fullParams.padding,textSize:r.fullChartParams.styles.textSize,textColor:k(r.fullParams.textColorType,r.fullChartParams)}))),d=P({fullParams:s.fullParams$,tooltipStyle:l}).pipe(A(p),S(async r=>r),y(r=>r.fullParams.svgRenderFn?r.fullParams.svgRenderFn:h=>{const x=r.fullParams.textRenderFn(h);return Ha(x,r.tooltipStyle)})),a=P({event:c,contentRenderFn:d}).pipe(A(p),S(async r=>r),y(r=>r.contentRenderFn(r.event))),t=u.pipe(A(p),y(r=>"")),m=ht(c,u).pipe(A(p),y(r=>r.event));return P({svgString:ht(a,t),event:m,layout:s.layout$,tooltipStyle:l}).pipe(A(p),S(async r=>r)).subscribe(r=>{Xa({rootSelection:i,pluginName:e,rootWidth:r.layout.rootWidth,rootHeight:r.layout.rootHeight,svgString:r.svgString,tooltipStyle:r.tooltipStyle,event:r.event})}),function(){p.next(void 0)}}),Zt="PieEventTexts",Xt=b(Zt,"text");function ct(o,i){const e=o.selectAll(`text.${Xt}`).data(i),n=e.enter().append("text").classed(Xt,!0),s=e.merge(n);return s.each((g,p,c)=>{const u=w(c[p]).text(g.text);Object.keys(g.attr).forEach(l=>{u.attr(l,g.attr[l])}),Object.keys(g.style).forEach(l=>{u.style(l,g.style[l])})}),e.exit().remove(),s}function gt({eventData:o,eventName:i,t:e,eventFn:n,textAttrs:s,textStyles:g}){return n(o,i,e).map((c,u)=>({text:c,attr:s[u],style:g[u]}))}const Va=jt(Zt,ie)(({selection:o,name:i,observer:e,subject:n})=>{const s=new z,g=o.append("g");let p;e.layout$.pipe($t()).subscribe(u=>{o.attr("transform",`translate(${u.width/2}, ${u.height/2})`),e.layout$.pipe(A(s)).subscribe(l=>{o.transition().attr("transform",`translate(${l.width/2}, ${l.height/2})`)})});const c=e.fullChartParams$.pipe(A(s),y(u=>u.highlightTarget),O());return P({computedData:e.computedData$,fullParams:e.fullParams$,fullChartParams:e.fullChartParams$,highlightTarget:c}).pipe(A(s),S(async u=>u)).subscribe(u=>{g.transition().duration(u.fullChartParams.transitionDuration).ease(na(u.fullChartParams.transitionEase)).tween("move",(l,d)=>a=>{const t=gt({eventData:{type:"series",pluginName:i,eventName:"transitionMove",event:l,highlightTarget:u.highlightTarget,data:u.computedData,series:[],seriesIndex:-1,seriesLabel:"",datum:null},eventName:"transitionMove",t:a,eventFn:u.fullParams.eventFn,textAttrs:u.fullParams.textAttrs,textStyles:u.fullParams.textStyles});ct(g,t)}).on("end",(l,d)=>{const a=gt({eventData:{type:"series",pluginName:i,eventName:"transitionEnd",event:l,highlightTarget:u.highlightTarget,data:u.computedData,series:[],seriesIndex:-1,seriesLabel:"",datum:null},eventName:"transitionMove",t:1,eventFn:u.fullParams.eventFn,textAttrs:u.fullParams.textAttrs,textStyles:u.fullParams.textStyles});ct(g,a),p&&p.unsubscribe(),p=n.event$.subscribe(t=>{const m=gt({eventData:t,eventName:t.eventName,t:1,eventFn:u.fullParams.eventFn,textAttrs:u.fullParams.textAttrs,textStyles:u.fullParams.textStyles});ct(g,m)})})}),()=>{s.next(void 0)}}),qt="PieLabels",ja=b(qt,"text");function Ya(o,i,e,n){return o.map((s,g)=>{const[p,c]=i.centroid(s),[u,l]=e.centroid(s);return{pieDatum:s,arcIndex:g,arcLabel:s.data.label,x:p*n,y:c*n,mouseoverX:u*n,mouseoverY:l*n}}).filter(s=>s.pieDatum.data.visible)}function Wa(o,i,e,n){let s=o.selectAll("text").data(i,u=>u.pieDatum.id),g=s.enter().append("text").classed(ja,!0),p=s.exit();g.append("text");const c=s.merge(g);return c.attr("font-weight","bold").attr("text-anchor","middle").style("dominant-baseline","middle").style("cursor",u=>n.highlightTarget&&n.highlightTarget!="none"?"pointer":"none").text(u=>e.labelFn(u.pieDatum.data)).attr("font-size",n.styles.textSize).attr("fill",(u,l)=>dt({datum:u.pieDatum.data,colorType:e.labelColorType,fullChartParams:n})).transition().attr("transform",u=>"translate("+u.x+","+u.y+")"),p.remove(),c}function Za({labelSelection:o,ids:i,fullChartParams:e}){if(o.interrupt("highlight"),!i.length){o.transition().duration(200).attr("transform",n=>"translate("+n.x+","+n.y+")").style("opacity",1);return}o.each((n,s,g)=>{const p=w(g[s]);i.includes(n.pieDatum.id)?p.style("opacity",1).transition().duration(200).attr("transform",c=>"translate("+c.mouseoverX+","+c.mouseoverY+")"):p.style("opacity",e.styles.unhighlightedOpacity).transition().duration(200).attr("transform",c=>"translate("+c.x+","+c.y+")")})}const K=jt(qt,re)(({selection:o,observer:i,subject:e})=>{const n=new z,s=o.append("g");let g=new z,p=[];return i.layout$.pipe($t()).subscribe(c=>{o.attr("transform",`translate(${c.width/2}, ${c.height/2})`),i.layout$.pipe(A(n)).subscribe(u=>{o.transition().attr("transform",`translate(${u.width/2}, ${u.height/2})`)})}),P({layout:i.layout$,computedData:i.computedData$,fullParams:i.fullParams$,fullChartParams:i.fullChartParams$}).pipe(A(n),S(async c=>c)).subscribe(c=>{const u=c.layout.width<c.layout.height?c.layout.width:c.layout.height,l=Ct({axisWidth:u,innerRadius:0,outerRadius:c.fullParams.outerRadius,padAngle:0,cornerRadius:0}),d=Ct({axisWidth:u,innerRadius:0,outerRadius:c.fullParams.outerMouseoverRadius,padAngle:0,cornerRadius:0}),a=oa({computedDataSeries:c.computedData,startAngle:c.fullParams.startAngle,endAngle:c.fullParams.endAngle});p=Ya(a,l,d,c.fullParams.labelCentroid);const t=Wa(s,p,c.fullParams,c.fullChartParams);g.next(t)}),P({labelSelection:g,highlight:i.seriesHighlight$,fullChartParams:i.fullChartParams$}).pipe(A(n),S(async c=>c)).subscribe(c=>{Za({labelSelection:c.labelSelection,ids:c.highlight,fullChartParams:c.fullChartParams})}),()=>{n.next(void 0)}}),Y=[15,38,25,17,26,72,64,29],C=[[55,80,50,11,150],[35,40,15,65,120]],qa=[[[1205,850,930,1111,1500],[735,900,880,1035,1120]],[[55,80,50,11,150],[35,40,15,65,120]]],tt={series:{Bubbles:{PRESET_SERIES_BASIC:{chart:V,plugins:[kt,j,T],preset:Rt,data:Y},PRESET_BUBBLES_SCALING_BY_RADIUS:{chart:V,plugins:[kt,j,T],preset:ze,data:Y}},Pie:{PRESET_SERIES_BASIC:{chart:V,plugins:[Q,K,j,T],preset:Rt,data:Y},PRESET_PIE_WITH_INNER_LABELS:{chart:V,plugins:[Q,K,j,T],preset:we,data:Y},PRESET_PIE_DONUT:{chart:V,plugins:[Q,K,Va,j,T],preset:Be,data:Y},PRESET_PIE_HALF_DONUT:{chart:V,plugins:[Q,K,j,T],preset:Ue,data:Y}}},grid:{Bars:{PRESET_GRID_BASIC:{chart:_,plugins:[X,R,M,I,F,T],preset:rt,data:C},PRESET_GRID_ROTATE_AXIS_LABEL:{chart:_,plugins:[X,R,M,I,F,T],preset:st,data:C},PRESET_GRID_HORIZONTAL:{chart:_,plugins:[X,R,M,I,F,T],preset:nt,data:C},PRESET_BARS_ROUND:{chart:_,plugins:[X,R,M,I,F,T],preset:He,data:C},PRESET_BARS_HORIZONTAL_AND_ROUND:{chart:_,plugins:[X,R,M,I,F,T],preset:Xe,data:C},PRESET_BARS_THIN:{chart:_,plugins:[X,R,M,I,F,T],preset:Ve,data:C},PRESET_BARS_HORIZONTAL_AND_THIN:{chart:_,plugins:[X,R,M,I,F,T],preset:je,data:C}},BarStack:{PRESET_GRID_BASIC:{chart:_,plugins:[ot,R,pt,I,F,T],preset:rt,data:C},PRESET_GRID_ROTATE_AXIS_LABEL:{chart:_,plugins:[ot,R,pt,I,F,T],preset:st,data:C},PRESET_GRID_HORIZONTAL:{chart:_,plugins:[ot,R,pt,I,F,T],preset:nt,data:C}},BarsTriangle:{PRESET_GRID_BASIC:{chart:_,plugins:[lt,R,M,I,F,T],preset:rt,data:C},PRESET_GRID_ROTATE_AXIS_LABEL:{chart:_,plugins:[lt,R,M,I,F,T],preset:st,data:C},PRESET_GRID_HORIZONTAL:{chart:_,plugins:[lt,R,M,I,F,T],preset:nt,data:C}},Lines:{PRESET_LINES_BASIC:{chart:_,plugins:[Z,R,M,q,I,F,T],preset:Ye,data:C},PRESET_LINES_ROTATE_AXIS_LABEL:{chart:_,plugins:[Z,R,M,q,I,F,T],preset:We,data:C},PRESET_LINES_HORIZONTAL:{chart:_,plugins:[Z,R,M,q,I,F,T],preset:Ze,data:C},PRESET_LINES_CURVE:{chart:_,plugins:[Z,R,M,q,I,F,T],preset:qe,data:C},PRESET_LINES_HIGHLIGHT_GROUP_DOTS:{chart:_,plugins:[Z,R,M,q,Ma,I,F,T],preset:Je,data:C}}},multiGrid:{BarsAndLines:{PRESET_MULTI_GRID_BASIC:{chart:ca,plugins:[wa,T],preset:Qe,data:qa}}}},Ja={id:"chart",style:{width:"100%",height:"100vh"}},pi=Jt({__name:"[presetName]",setup(o){const e=Qt().params,n=tt[e.chartType]&&tt[e.chartType][e.pluginName]&&tt[e.chartType][e.pluginName][e.presetName]?tt[e.chartType][e.pluginName][e.presetName]:null;return Kt(()=>{if(!n)return;const s=document.querySelector("#chart"),g=n.plugins.map(c=>new c);console.log("detail.preset",n.preset);const p=new n.chart(s,{preset:n.preset});p.plugins$.next(g),p.data$.next(n.data)}),(s,g)=>(te(),ee("div",Ja))}});export{pi as default};
