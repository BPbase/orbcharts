import{a as E,k as S,d as w,t as v,l as T,m as k,b as q,s as W,bd as L,bo as I,bp as F,be as Z,g as V,bg as H,bc as U,bq as J,aT as K,bk as Q}from"./QpO8sbuk.js";import{t as _}from"./D2f-F6u9.js";const B=6;function N(b,h){return b.map((i,A)=>{const u=U(i,h),s=typeof u=="string"?u.split(`
`):[u];return{text:u,textArr:s}})}function ee({selection:b,groupingLabelClassName:h,fullParams:i,axisLabelAlign:A,gridAxesSize:u,fullDataFormatter:s,chartParams:m,textReverseTransform:R}){const c=i.tickPadding+i.labelOffset[0],g=i.tickPadding+i.labelOffset[1];let r=0,n=0;s.groupAxis.position==="bottom"?(n=g,s.valueAxis.position==="left"?r=c:s.valueAxis.position==="right"&&(r=-c)):s.groupAxis.position==="top"?(n=-g,s.valueAxis.position==="left"?r=c:s.valueAxis.position==="right"&&(r=-c)):s.groupAxis.position==="left"?(r=-c,s.valueAxis.position==="bottom"?n=-g:s.valueAxis.position==="top"&&(n=g)):s.groupAxis.position==="right"&&(r=c,s.valueAxis.position==="bottom"?n=-g:s.valueAxis.position==="top"&&(n=g)),b.selectAll(`g.${h}`).data([i]).join("g").classed(h,!0).each((o,y,f)=>{W(f[y]).selectAll("text").data([o]).join(l=>l.append("text").style("font-weight","bold"),l=>l,l=>l.remove()).attr("text-anchor",A.textAnchor).attr("dominant-baseline",A.dominantBaseline).attr("font-size",m.styles.textSize).style("fill",L(i.labelColorType,m)).style("transform",R).attr("x",r).attr("y",n).text(l=>s.groupAxis.label)}).attr("transform",o=>`translate(${u.width}, 0)`)}function te({selection:b,xAxisClassName:h,fullParams:i,tickTextAlign:A,gridAxesSize:u,fullDataFormatter:s,chartParams:m,groupScale:R,groupScaleDomain:c,groupLabelData:g,textReverseTransformWithRotate:r,textSizePx:n}){const o=b.selectAll(`g.${h}`).data([i]).join("g").classed(h,!0),y=Math.floor(c[1])-Math.ceil(c[0])+1;let f=0,l=0;s.groupAxis.position==="left"?(f=0,l=-i.tickPadding):s.groupAxis.position==="right"?(f=0,l=i.tickPadding):s.groupAxis.position==="bottom"?(i.tickFullLine==!0?f=-i.tickPadding:f=-i.tickPadding-B,l=0):s.groupAxis.position==="top"&&(i.tickFullLine==!0?f=i.tickPadding:f=i.tickPadding-B,l=-0);const M=I(R).scale(R).ticks(i.ticks==="all"||i.ticks>y?y:i.ticks).tickSize(i.tickFullLine==!0?-u.height:B).tickSizeOuter(0).tickFormat(z=>{var C;return((C=g[z])==null?void 0:C.text)??""}).tickPadding(f),$=o.transition().duration(100).ease(F).call(M).on("end",(z,C)=>{o.selectAll(".tick text").each((P,j,t)=>{var p;const a=((p=g[P])==null?void 0:p.textArr)??[];Z(W(t[j]),{textArr:a,textSizePx:n,groupAxisPosition:s.groupAxis.position,isContainerRotated:!0})})});return $.selectAll("line").style("fill","none").style("stroke",i.tickLineVisible==!0?L(i.tickColorType,m):"none").style("stroke-dasharray",i.tickFullLineDasharray).style("vector-effect","non-scaling-stroke").attr("pointer-events","none"),$.selectAll("path").style("fill","none").style("stroke",i.axisLineVisible==!0?L(i.axisLineColorType,m):"none").style("shape-rendering","crispEdges"),o.selectAll("text").attr("font-size",m.styles.textSize).attr("fill",L(i.tickTextColorType,m)).attr("text-anchor",A.textAnchor).attr("dominant-baseline",A.dominantBaseline).attr("x",l).style("transform",r).attr("dy",0),o}const le=(b,{selection:h,computedData$:i,fullParams$:A,fullDataFormatter$:u,fullChartParams$:s,gridAxesTransform$:m,gridAxesReverseTransform$:R,gridAxesSize$:c,gridContainerPosition$:g,isSeriesSeprate$:r,textSizePx$:n})=>{const o=new E,y=V(b,"container"),f=V(b,"xAxisG"),l=V(b,"xAxis"),M=V(b,"groupingLabel"),$=S({computedData:i.pipe(w((e,x)=>e.length===x.length)),isSeriesSeprate:r}).pipe(v(o),T(async e=>e),k(e=>e.isSeriesSeprate?e.computedData:[e.computedData[0]]),k((e,x)=>h.selectAll(`g.${y}`).data(e,d=>d[0]?d[0].seriesIndex:x).join("g").classed(y,!0))),D=$.pipe(v(o),k((e,x)=>e.selectAll(`g.${f}`).data([f]).join("g").classed(f,!0)));S({containerSelection:$,gridContainerPosition:g}).pipe(v(o),T(async e=>e)).subscribe(e=>{e.containerSelection.attr("transform",(x,d)=>{const Y=e.gridContainerPosition[d]??e.gridContainerPosition[0],O=Y.translate,G=Y.scale;return`translate(${O[0]}, ${O[1]}) scale(${G[0]}, ${G[1]})`})}),S({axisSelection:D,gridAxesTransform:m}).pipe(v(o),T(async e=>e)).subscribe(e=>{e.axisSelection.style("transform",e.gridAxesTransform.value)});const z=S({gridAxesReverseTransform:R,gridContainerPosition:g}).pipe(v(o),T(async e=>e),k(e=>{const x=`rotateX(${e.gridAxesReverseTransform.rotateX}deg) rotateY(${e.gridAxesReverseTransform.rotateY}deg)`,d=`rotate(${e.gridAxesReverseTransform.rotate}deg)`,Y=`scale(${1/e.gridContainerPosition[0].scale[0]}, ${1/e.gridContainerPosition[0].scale[1]})`;return`${x} ${d} ${Y}`}),w()),C=S({textReverseTransform:z,fullParams:A}).pipe(v(o),T(async e=>e),k(e=>`${e.textReverseTransform} rotate(${e.fullParams.tickTextRotate}deg)`)),P=S({fullDataFormatter:u,gridAxesSize:c,computedData:i}).pipe(v(o),T(async e=>e),k(e=>{const x=e.computedData[0]?e.computedData[0].length-1:0,d=e.fullDataFormatter.groupAxis.scaleDomain[0]-e.fullDataFormatter.groupAxis.scalePadding,Y=e.fullDataFormatter.groupAxis.scaleDomain[1]==="max"?x+e.fullDataFormatter.groupAxis.scalePadding:e.fullDataFormatter.groupAxis.scaleDomain[1]+e.fullDataFormatter.groupAxis.scalePadding;return[d,Y]}),q(1)),j=S({groupScaleDomain:P,gridAxesSize:c}).pipe(v(o),T(async e=>e),k(e=>H().domain(e.groupScaleDomain).range([0,e.gridAxesSize.width]))),t=i.pipe(k(e=>(e[0]??[]).map(x=>x.groupLabel))),a=S({fullDataFormatter:u,fullParams:A}).pipe(v(o),T(async e=>e),k(e=>{let x="middle",d="hanging";return e.fullDataFormatter.groupAxis.position==="bottom"?(x=e.fullParams.tickTextRotate?"end":"middle",d="hanging"):e.fullDataFormatter.groupAxis.position==="top"?(x=e.fullParams.tickTextRotate?"start":"middle",d="auto"):e.fullDataFormatter.groupAxis.position==="left"?(x="end",d="middle"):e.fullDataFormatter.groupAxis.position==="right"&&(x="start",d="middle"),{textAnchor:x,dominantBaseline:d}})),p=u.pipe(v(o),k(e=>{let x="start",d="hanging";return e.groupAxis.position==="bottom"?d="hanging":e.groupAxis.position==="top"?d="auto":e.groupAxis.position==="left"?x="end":e.groupAxis.position==="right"&&(x="start"),e.valueAxis.position==="left"?x="start":e.valueAxis.position==="right"?x="end":e.valueAxis.position==="bottom"?d="auto":e.valueAxis.position==="top"&&(d="hanging"),{textAnchor:x,dominantBaseline:d}})),X=S({groupLabels:t,fullParams:A}).pipe(v(o),T(async e=>e),k(e=>N(e.groupLabels,e.fullParams.tickFormat)));return S({axisSelection:D,fullParams:A,tickTextAlign:a,axisLabelAlign:p,gridAxesSize:c,fullDataFormatter:u,chartParams:s,groupScale:j,groupScaleDomain:P,groupLabelData:X,textReverseTransform:z,textReverseTransformWithRotate:C,textSizePx:n}).pipe(v(o),T(async e=>e)).subscribe(e=>{te({selection:e.axisSelection,xAxisClassName:l,fullParams:e.fullParams,tickTextAlign:e.tickTextAlign,gridAxesSize:e.gridAxesSize,fullDataFormatter:e.fullDataFormatter,chartParams:e.chartParams,groupScale:e.groupScale,groupScaleDomain:e.groupScaleDomain,groupLabelData:e.groupLabelData,textReverseTransformWithRotate:e.textReverseTransformWithRotate,textSizePx:e.textSizePx}),ee({selection:e.axisSelection,groupingLabelClassName:M,fullParams:e.fullParams,axisLabelAlign:e.axisLabelAlign,gridAxesSize:e.gridAxesSize,fullDataFormatter:e.fullDataFormatter,chartParams:e.chartParams,textReverseTransform:e.textReverseTransform})}),()=>{o.next(void 0)}},ie=6;function se({selection:b,textClassName:h,fullParams:i,axisLabelAlign:A,gridAxesSize:u,fullDataFormatter:s,fullChartParams:m,textReverseTransform:R}){const c=i.tickPadding-i.labelOffset[0],g=i.tickPadding+i.labelOffset[1];let r=0,n=0;s.groupAxis.position==="bottom"?(n=-g,s.valueAxis.position==="left"?r=-c:s.valueAxis.position==="right"&&(r=c)):s.groupAxis.position==="top"?(n=g,s.valueAxis.position==="left"?r=-c:s.valueAxis.position==="right"&&(r=c)):s.groupAxis.position==="left"?(r=c,s.valueAxis.position==="bottom"?n=g:s.valueAxis.position==="top"&&(n=-g)):s.groupAxis.position==="right"&&(r=-c,s.valueAxis.position==="bottom"?n=g:s.valueAxis.position==="top"&&(n=-g)),b.selectAll(`g.${h}`).data([i]).join("g").classed(h,!0).each((o,y,f)=>{W(f[y]).selectAll("text").data([o]).join(l=>l.append("text").style("font-weight","bold"),l=>l,l=>l.remove()).attr("text-anchor",A.textAnchor).attr("dominant-baseline",A.dominantBaseline).attr("font-size",m.styles.textSize).style("fill",L(i.labelColorType,m)).style("transform",R).attr("x",r).attr("y",n).text(l=>s.valueAxis.label)}).attr("transform",o=>`translate(0, ${u.height})`)}function oe({selection:b,yAxisClassName:h,fullParams:i,tickTextAlign:A,gridAxesSize:u,fullDataFormatter:s,fullChartParams:m,valueScale:R,textReverseTransformWithRotate:c,filteredMinMaxValue:g}){const r=b.selectAll(`g.${h}`).data([i]).join("g").classed(h,!0);let n=0,o=0;s.valueAxis.position==="left"?(n=i.tickPadding,o=0):s.valueAxis.position==="right"?(n=-i.tickPadding,o=0):s.valueAxis.position==="bottom"?(n=0,o=i.tickPadding):s.valueAxis.position==="top"&&(n=0,o=-i.tickPadding);const y=J(R).scale(R).ticks(i.ticks).tickFormat(M=>U(M,i.tickFormat)).tickSize(i.tickFullLine==!0?-u.width:ie).tickPadding(n),f=r.transition().duration(100).ease(F).call(y);f.selectAll("line").style("fill","none").style("stroke",i.tickLineVisible==!0?L(i.tickColorType,m):"none").style("stroke-dasharray",i.tickFullLineDasharray).style("vector-effect","non-scaling-stroke").attr("pointer-events","none"),f.selectAll("path").style("fill","none").style("stroke",i.axisLineVisible==!0?L(i.axisLineColorType,m):"none").style("shape-rendering","crispEdges");const l=r.selectAll("text").attr("font-size",m.styles.textSize).style("color",L(i.tickTextColorType,m)).attr("text-anchor",A.textAnchor).attr("dominant-baseline",A.dominantBaseline).attr("y",o).attr("dy",0);return l.style("transform",c),(s.valueAxis.position==="bottom"||s.valueAxis.position==="top")&&l.attr("dy",0),r}const ae=(b,{selection:h,computedData$:i,filteredMinMaxValue$:A,fullParams$:u,fullDataFormatter$:s,fullChartParams$:m,gridAxesSize$:R,gridAxesTransform$:c,gridAxesReverseTransform$:g,gridContainerPosition$:r,isSeriesSeprate$:n})=>{const o=new E,y=V(b,"yAxisG"),f=V(b,"yAxis"),l=V(b,"text"),$=_({selection:h,pluginName:b,computedData$:i,gridContainerPosition$:r,isSeriesSeprate$:n}).pipe(v(o),k((t,a)=>t.selectAll(`g.${y}`).data([y]).join("g").classed(y,!0)));S({axisSelection:$,gridAxesTransform:c}).pipe(v(o),T(async t=>t)).subscribe(t=>{t.axisSelection.style("transform",t.gridAxesTransform.value)});const D=S({gridAxesReverseTransform:g,gridContainerPosition:r}).pipe(v(o),T(async t=>t),k(t=>{const a=`rotateX(${t.gridAxesReverseTransform.rotateX}deg) rotateY(${t.gridAxesReverseTransform.rotateY}deg)`,p=`rotate(${t.gridAxesReverseTransform.rotate}deg)`,X=`scale(${1/t.gridContainerPosition[0].scale[0]}, ${1/t.gridContainerPosition[0].scale[1]})`;return`${a} ${p} ${X}`}),w()),z=S({textReverseTransform:D,fullParams:u}).pipe(v(o),T(async t=>t),k(t=>`${t.textReverseTransform} rotate(${t.fullParams.tickTextRotate}deg)`)),C=new K(t=>{S({fullDataFormatter:s,gridAxesSize:R,filteredMinMaxValue:A}).pipe(v(o),T(async a=>a)).subscribe(a=>{let p=a.filteredMinMaxValue[1],X=a.filteredMinMaxValue[0];p===X&&p===0&&(p=1);const e=Q({maxValue:p,minValue:X,axisWidth:a.gridAxesSize.height,scaleDomain:a.fullDataFormatter.valueAxis.scaleDomain,scaleRange:a.fullDataFormatter.valueAxis.scaleRange});t.next(e)})}),P=S({fullDataFormatter:s,fullParams:u}).pipe(v(o),T(async t=>t),k(t=>{let a="start",p="hanging";return t.fullDataFormatter.valueAxis.position==="left"?(a="end",p="middle"):t.fullDataFormatter.valueAxis.position==="right"?(a="start",p="middle"):t.fullDataFormatter.valueAxis.position==="bottom"?(a=t.fullParams.tickTextRotate?"end":"middle",p="hanging"):t.fullDataFormatter.valueAxis.position==="top"&&(a=t.fullParams.tickTextRotate?"start":"middle",p="auto"),{textAnchor:a,dominantBaseline:p}})),j=s.pipe(v(o),k(t=>{let a="start",p="hanging";return t.groupAxis.position==="bottom"?p="auto":t.groupAxis.position==="top"?p="hanging":t.groupAxis.position==="left"?a="start":t.groupAxis.position==="right"&&(a="end"),t.valueAxis.position==="left"?a="end":t.valueAxis.position==="right"?a="start":t.valueAxis.position==="bottom"?p="hanging":t.valueAxis.position==="top"&&(p="auto"),{textAnchor:a,dominantBaseline:p}}));return S({axisSelection:$,fullParams:u,tickTextAlign:P,axisLabelAlign:j,computedData:i,gridAxesSize:R,fullDataFormatter:s,fullChartParams:m,valueScale:C,textReverseTransform:D,textReverseTransformWithRotate:z,filteredMinMaxValue:A}).pipe(v(o),T(async t=>t)).subscribe(t=>{oe({selection:t.axisSelection,yAxisClassName:f,fullParams:t.fullParams,tickTextAlign:t.tickTextAlign,gridAxesSize:t.gridAxesSize,fullDataFormatter:t.fullDataFormatter,fullChartParams:t.fullChartParams,valueScale:t.valueScale,textReverseTransformWithRotate:t.textReverseTransformWithRotate,filteredMinMaxValue:t.filteredMinMaxValue}),se({selection:t.axisSelection,textClassName:l,fullParams:t.fullParams,axisLabelAlign:t.axisLabelAlign,gridAxesSize:t.gridAxesSize,fullDataFormatter:t.fullDataFormatter,fullChartParams:t.fullChartParams,textReverseTransform:t.textReverseTransform})}),()=>{o.next(void 0)}};export{le as a,ae as c};
