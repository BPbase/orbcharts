import{n as te,f as ae,x as v,O as E,C as A,y as x,B as I,X as re,l as F,z as w,E as C,Q as se}from"./DXLUV_DG.js";import{p as ie}from"./DOvFTFAM.js";import{g as ne,b as U,l as oe,q as pe,r as le}from"./CSQ6-baw.js";function ue(i,o){return te(function(r,l){var n=0;r.subscribe(ae(l,function(s){return i.call(o,s,n++)&&l.next(s)}))})}function ce({fullDataFormatter$:i,gridAxesSize$:o,computedData$:r,fullChartParams$:l}){const n=new v,s=new E(D=>{A({dataFormatter:i,computedData:r}).pipe(x(n),I(async t=>t)).subscribe(t=>{const f=t.computedData[0]?t.computedData[0].length-1:0,P=t.dataFormatter.groupAxis.scaleDomain[0]==="auto"?0-t.dataFormatter.groupAxis.scalePadding:t.dataFormatter.groupAxis.scaleDomain[0]-t.dataFormatter.groupAxis.scalePadding,S=t.dataFormatter.groupAxis.scaleDomain[1]==="auto"?f+t.dataFormatter.groupAxis.scalePadding:t.dataFormatter.groupAxis.scaleDomain[1]+t.dataFormatter.groupAxis.scalePadding,u=(t.dataFormatter.grid.seriesType==="row"?(t.computedData[0]??[]).map(b=>b.groupLabel):t.computedData.map(b=>b[0].groupLabel)).filter((b,$)=>$>=P&&$<=S);D.next(u)})});return new E(D=>{A({dataFormatter:i,axisSize:o,fullChartParams:l,scaleRangeGroupLabels:s}).pipe(x(n),I(async t=>t)).subscribe(t=>{const m=t.dataFormatter.valueAxis.position==="right"||t.dataFormatter.valueAxis.position==="bottom",f=re({axisLabels:t.scaleRangeGroupLabels,axisWidth:t.axisSize.width,reverse:m}),P=h=>t.dataFormatter.groupAxis.position==="bottom"||t.dataFormatter.groupAxis.position==="top"?h.offsetX-t.fullChartParams.padding.left:h.offsetY-t.fullChartParams.padding.top,S=h=>{const u=P(h),b=f(u);return{groupIndex:b,groupLabel:t.scaleRangeGroupLabels[b]??""}};return D.next(S),function(){n.next(void 0)}})})}const X="Lines",ge=U(X,"g"),he=U(X,"path");function be(i="curveLinear"){return pe().x(o=>o.axisX).y(o=>o.axisY).curve(le[i])}function me(i){let o=[[]],r=0;for(let l in i){if(i[l].visible==!1||i[l].value===void 0||i[l].value===null){o[r].length&&(r++,o[r]=[]);continue}o[r].push(i[l])}return o}function de({selection:i,segmentData:o,linePath:r,params:l}){return i.selectAll("path").data(o,(s,D)=>s.length?`${s[0].id}_${s[s.length-1].id}`:D).join(s=>s.append("path").classed(he,!0).attr("fill","none").attr("pointer-events","visibleStroke").style("vector-effect","non-scaling-stroke").style("cursor","pointer"),s=>s,s=>s.remove()).attr("stroke-width",l.lineWidth).attr("stroke",(s,D)=>s[0]&&s[0].color).attr("d",s=>r(s))}function xe({selection:i,seriesLabel:o,fullChartParams:r}){if(i.interrupt("highlight"),!o){i.transition("highlight").duration(200).style("opacity",1);return}i.each((l,n,s)=>{l===o?C(s[n]).style("opacity",1):C(s[n]).style("opacity",r.styles.unhighlightedOpacity)})}function De({defsSelection:i,clipPathData:o,transitionDuration:r,transitionEase:l}){i.selectAll("clipPath").data(o).join(n=>n.append("clipPath"),n=>n,n=>n.remove()).attr("id",n=>n.id).each((n,s,D)=>{C(D[s]).selectAll("rect").data([n]).join(t=>{const m=t.append("rect");return m.transition().duration(r).ease(oe(l)).tween("tween",(f,P,S)=>h=>{const u=f.width*h;m.attr("x",0).attr("y",0).attr("width",b=>u).attr("height",b=>b.height)}),m},t=>t.attr("x",0).attr("y",0).attr("width",m=>m.width).attr("height",m=>m.height),t=>t.remove())})}const Le=(i,{selection:o,computedData$:r,SeriesDataMap$:l,GroupDataMap$:n,fullParams$:s,fullDataFormatter$:D,fullChartParams$:t,gridAxesTransform$:m,gridGraphicTransform$:f,gridAxesSize$:P,gridHighlight$:S,event$:h})=>{const u=new v,b=ne(i,"clipPath-box"),$=o.append("g").attr("clip-path",`url(#${b})`),W=$.append("defs"),B=$.append("g"),O=new v;m.pipe(x(u),F(e=>e.value),w()).subscribe(e=>{$.style("transform",e)}),f.pipe(x(u),F(e=>e.value),w()).subscribe(e=>{B.transition().duration(50).style("transform",e)});const Q=new E(e=>{const p=s.pipe(x(u)).subscribe(d=>{if(!d)return;const L=be(d.lineCurve);e.next(L)});return()=>{p.unsubscribe()}}),R=new E(e=>{r.pipe(x(u),I(async p=>p)).subscribe(p=>{const d=p[0]&&p[0][0]?p.map(L=>L[0].seriesLabel):[];e.next(d)})}),V=t.pipe(F(e=>e.transitionDuration),w()),Y=t.pipe(F(e=>e.transitionEase),w());A({seriesLabels:R,axisSize:P,transitionDuration:V,transitionEase:Y}).pipe(x(u),I(async e=>e)).subscribe(e=>{const d=[{id:b,width:e.axisSize.width,height:e.axisSize.height}].concat(e.seriesLabels.map(L=>({id:`orbcharts__clipPath_${L}`,width:e.axisSize.width,height:e.axisSize.height})));De({defsSelection:W,clipPathData:d,transitionDuration:e.transitionDuration,transitionEase:e.transitionEase})});const q=r.pipe(F(e=>{const p=new Map;return e.flat().forEach(d=>p.set(d.id,d)),p})),H=ce({fullDataFormatter$:D,gridAxesSize$:P,computedData$:r,fullChartParams$:t}),J=t.pipe(x(u),F(e=>e.highlightTarget),w());A({seriesLabels:R,computedData:r,SeriesDataMap:l,GroupDataMap:n,linePath:Q,params:s,highlightTarget:J,gridGroupPositionFn:H}).pipe(x(u),I(async e=>e)).subscribe(e=>{const p=B.selectAll("g").data(e.seriesLabels,(T,_)=>T),d=p.enter().append("g").classed(ge,!0);p.exit().remove();const L=p.merge(d).attr("clip-path",(T,_)=>`url(#orbcharts__clipPath_${T})`);L.each((T,_,Z)=>{const ee=me(e.computedData[_]??[]);de({selection:C(Z[_]),linePath:e.linePath,segmentData:ee,params:e.params}).on("mouseover",(c,g)=>{c.stopPropagation();const y=g[0]?g[0].seriesLabel:"",{groupIndex:N,groupLabel:M}=e.gridGroupPositionFn(c),a=e.GroupDataMap.get(M).find(G=>G.seriesLabel===y)??g[0];h.next({type:"grid",eventName:"mouseover",pluginName:i,highlightTarget:e.highlightTarget,datum:a,series:e.SeriesDataMap.get(a.seriesLabel),seriesIndex:a.seriesIndex,seriesLabel:a.seriesLabel,groups:e.GroupDataMap.get(a.groupLabel),groupIndex:a.groupIndex,groupLabel:a.groupLabel,event:c,data:e.computedData})}).on("mousemove",(c,g)=>{c.stopPropagation();const y=g[0]?g[0].seriesLabel:"",{groupIndex:N,groupLabel:M}=e.gridGroupPositionFn(c),a=e.GroupDataMap.get(M).find(G=>G.seriesLabel===y)??g[0];h.next({type:"grid",eventName:"mousemove",pluginName:i,highlightTarget:e.highlightTarget,datum:a,series:e.SeriesDataMap.get(a.seriesLabel),seriesIndex:a.seriesIndex,seriesLabel:a.seriesLabel,groups:e.GroupDataMap.get(a.groupLabel),groupIndex:a.groupIndex,groupLabel:a.groupLabel,event:c,data:e.computedData})}).on("mouseout",(c,g)=>{c.stopPropagation();const y=g[0]?g[0].seriesLabel:"",{groupIndex:N,groupLabel:M}=e.gridGroupPositionFn(c),a=e.GroupDataMap.get(M).find(G=>G.seriesLabel===y)??g[0];h.next({type:"grid",eventName:"mouseout",pluginName:i,highlightTarget:e.highlightTarget,datum:a,series:e.SeriesDataMap.get(a.seriesLabel),seriesIndex:a.seriesIndex,seriesLabel:a.seriesLabel,groups:e.GroupDataMap.get(a.groupLabel),groupIndex:a.groupIndex,groupLabel:a.groupLabel,event:c,data:e.computedData})}).on("click",(c,g)=>{c.stopPropagation();const y=g[0]?g[0].seriesLabel:"",{groupIndex:N,groupLabel:M}=e.gridGroupPositionFn(c),a=e.GroupDataMap.get(M).find(G=>G.seriesLabel===y)??g[0];h.next({type:"grid",eventName:"click",pluginName:i,highlightTarget:e.highlightTarget,datum:a,series:e.SeriesDataMap.get(a.seriesLabel),seriesIndex:a.seriesIndex,seriesLabel:a.seriesLabel,groups:e.GroupDataMap.get(a.groupLabel),groupIndex:a.groupIndex,groupLabel:a.groupLabel,event:c,data:e.computedData})})}),O.next(L)});const K=S.subscribe();return t.pipe(x(u),ue(e=>e.highlightTarget==="series"),I(e=>A({graphicSelection:O,highlight:S,DataMap:q,fullChartParams:t}).pipe(x(u),I(async p=>p)))).subscribe(e=>{const p=e.DataMap.get(e.highlight[0]);xe({selection:e.graphicSelection,seriesLabel:p&&p.seriesLabel?p.seriesLabel:null,fullChartParams:e.fullChartParams})}),()=>{u.next(void 0),K.unsubscribe()}},j="Lines",Me=se(j,ie)(({selection:i,name:o,observer:r,subject:l})=>{const n=new v,s=Le(j,{selection:i,computedData$:r.computedData$,SeriesDataMap$:r.SeriesDataMap$,GroupDataMap$:r.GroupDataMap$,fullParams$:r.fullParams$,fullDataFormatter$:r.fullDataFormatter$,fullChartParams$:r.fullChartParams$,gridAxesTransform$:r.gridAxesTransform$,gridGraphicTransform$:r.gridGraphicTransform$,gridAxesSize$:r.gridAxesSize$,gridHighlight$:r.gridHighlight$,event$:l.event$});return()=>{n.next(void 0),s()}});export{Me as L,Le as c,ue as f,ce as g};
