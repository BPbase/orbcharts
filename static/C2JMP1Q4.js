import{x,y as p,l as u,z as h,O as H,C as O,B as L,E as M,Q as re}from"./DXLUV_DG.js";import{m as ae}from"./DOvFTFAM.js";import{g as ie,l as se,b as z,o as oe}from"./CSQ6-baw.js";const Y="Bars",j=z(Y,"g"),$=z(Y,"rect"),V=.3;function ne({axisWidth:a,groupAmount:o,barAmountOfGroup:n,barPadding:s=0,barGroupPadding:P=0}){const g=(a/(o-1)-P)/n-s;return g>1?g:1}function _e(a,o,n){const s=a/2,P=a*o.length+n.barPadding*o.length;return oe().domain(o).range([-P/2+s,P/2-s])}function le(a,o){return a<=1?0:o/(a-1)*V}function Pe(a,o){return a<=1?o:o*(1-V)}function ce({selection:a,data:o,zeroY:n,groupLabels:s,barScale:P,params:_,chartParams:g,barWidth:I,transformedBarRadius:N,delayGroup:b,transitionItem:A}){const R=I/2;return a.selectAll(`g.${j}`).data(o,(d,D)=>s[D]).join(d=>d.append("g").classed(j,!0).attr("cursor","pointer"),d=>d,d=>d.remove()).attr("transform",(d,D)=>`translate(${d[0]?d[0].axisX:0}, 0)`).each((d,D,f)=>{M(f[D]).selectAll("rect").data(d,l=>l.id).join(l=>l.append("rect").classed($,!0).attr("height",B=>0),l=>l,l=>l.remove()).attr("fill",l=>l.color).attr("y",l=>l.axisY<n?l.axisY:n).attr("x",l=>P(l.seriesLabel)).attr("width",I).attr("transform",`translate(${-R}, 0)`).attr("rx",N[0]).attr("ry",N[1]).transition().duration(A).ease(se(g.transitionEase)).delay((l,B)=>l.groupIndex*b).attr("height",l=>Math.abs(l.axisYFromZero))}).selectAll(`rect.${$}`)}function pe({defsSelection:a,clipPathData:o}){a.selectAll("clipPath").data(o).join(n=>n.append("clipPath"),n=>n,n=>n.remove()).attr("id",n=>n.id).each((n,s,P)=>{M(P[s]).selectAll("rect").data([n]).join(_=>_.append("rect"),_=>_,_=>_.remove()).attr("x",0).attr("y",0).attr("width",_=>_.width).attr("height",_=>_.height)})}function de({selection:a,ids:o,fullChartParams:n}){if(a.interrupt("highlight"),!o.length){a.transition("highlight").duration(200).style("opacity",1);return}a.each((s,P,_)=>{o.includes(s.id)?M(_[P]).style("opacity",1):M(_[P]).style("opacity",n.styles.unhighlightedOpacity)})}const ge=(a,{selection:o,computedData$:n,visibleComputedData$:s,SeriesDataMap$:P,GroupDataMap$:_,fullParams$:g,fullChartParams$:I,gridAxesTransform$:N,gridGraphicTransform$:b,gridAxesSize$:A,gridHighlight$:R,event$:S})=>{const c=new x,d=ie(a,"clipPath-box"),D=o.append("g").attr("clip-path",`url(#${d})`),f=D.append("defs"),l=D.append("g"),B=new x;N.pipe(p(c),u(e=>e.value),h()).subscribe(e=>{D.style("transform",e)}),b.pipe(p(c),u(e=>e.value),h()).subscribe(e=>{l.transition().duration(50).style("transform",e)});const X=s.pipe(u(e=>e[0]&&e[0][0]?e[0][0].axisY-e[0][0].axisYFromZero:0),h()),y=new H(e=>{O({computedData:n,visibleComputedData:s,params:g,gridAxesSize:A}).pipe(L(async t=>t)).subscribe(t=>{const i=t.params.barWidth?t.params.barWidth:ne({axisWidth:t.gridAxesSize.width,groupAmount:t.computedData[0]?t.computedData[0].length:0,barAmountOfGroup:t.visibleComputedData.length,barPadding:t.params.barPadding,barGroupPadding:t.params.barGroupPadding});e.next(i)})}).pipe(p(c),h()),k=O({gridGraphicTransform:b,barWidth:y,params:g}).pipe(p(c),L(async e=>e),u(e=>{const t=e.barWidth/2,i=e.params.barRadius===!0?t:e.params.barRadius===!1?0:typeof e.params.barRadius=="number"?e.params.barRadius:0,r=i==0?0:i/e.gridGraphicTransform.scale[0],E=i==0?0:i/e.gridGraphicTransform.scale[1];return[r,E]})),Z=s.pipe(p(c),u(e=>{const t=new Set;return e.forEach(i=>{i.forEach(r=>{t.add(r.seriesLabel)})}),Array.from(t)})),C=s.pipe(p(c),u(e=>{const t=new Set;return e.forEach(i=>{i.forEach(r=>{t.add(r.groupLabel)})}),Array.from(t)})),Q=new H(e=>{O({seriesLabels:Z,barWidth:y,params:g}).pipe(p(c),L(async t=>t)).subscribe(t=>{const i=_e(t.barWidth,t.seriesLabels,t.params);e.next(i)})}),W=I.pipe(p(c),u(e=>e.transitionDuration),h()),q=new H(e=>{O({groupLabels:C,transitionDuration:W}).pipe(L(async t=>t)).subscribe(t=>{const i=le(t.groupLabels.length,t.transitionDuration);e.next(i)})}).pipe(p(c),h()),J=new H(e=>{O({groupLabels:C,transitionDuration:W}).pipe(L(async t=>t)).subscribe(t=>{const i=Pe(t.groupLabels.length,t.transitionDuration);e.next(i)})}).pipe(p(c),h()),K=s.pipe(p(c),u(e=>{const t=e.length,i=e.reduce((E,m)=>Math.max(E,m.length),0),r=new Array(i).fill(null).map(()=>new Array(t).fill(null));for(let E=0;E<t;E++)for(let m=0;m<i;m++)r[m][E]=e[E][m];return r}));A.pipe(p(c)).subscribe(e=>{const t=[{id:d,width:e.width,height:e.height}];pe({defsSelection:f,clipPathData:t})});const ee=I.pipe(p(c),u(e=>e.highlightTarget),h());O({computedData:n,barData$:K,zeroY:X,groupLabels:C,barScale:Q,params:g,chartParams:I,highlightTarget:ee,barWidth:y,transformedBarRadius:k,delayGroup:q,transitionItem:J,SeriesDataMap:P,GroupDataMap:_}).pipe(p(c),L(async e=>e)).subscribe(e=>{const t=ce({selection:l,data:e.barData$,zeroY:e.zeroY,groupLabels:e.groupLabels,barScale:e.barScale,params:e.params,chartParams:e.chartParams,barWidth:e.barWidth,transformedBarRadius:e.transformedBarRadius,delayGroup:e.delayGroup,transitionItem:e.transitionItem});t.on("mouseover",(i,r)=>{i.stopPropagation(),S.next({type:"grid",eventName:"mouseover",pluginName:a,highlightTarget:e.highlightTarget,datum:r,series:e.SeriesDataMap.get(r.seriesLabel),seriesIndex:r.seriesIndex,seriesLabel:r.seriesLabel,groups:e.GroupDataMap.get(r.groupLabel),groupIndex:r.groupIndex,groupLabel:r.groupLabel,event:i,data:e.computedData})}).on("mousemove",(i,r)=>{i.stopPropagation(),S.next({type:"grid",eventName:"mousemove",pluginName:a,highlightTarget:e.highlightTarget,datum:r,series:e.SeriesDataMap.get(r.seriesLabel),seriesIndex:r.seriesIndex,seriesLabel:r.seriesLabel,groups:e.GroupDataMap.get(r.groupLabel),groupIndex:r.groupIndex,groupLabel:r.groupLabel,event:i,data:e.computedData})}).on("mouseout",(i,r)=>{i.stopPropagation(),S.next({type:"grid",eventName:"mouseout",pluginName:a,highlightTarget:e.highlightTarget,datum:r,series:e.SeriesDataMap.get(r.seriesLabel),seriesIndex:r.seriesIndex,seriesLabel:r.seriesLabel,groups:e.GroupDataMap.get(r.groupLabel),groupIndex:r.groupIndex,groupLabel:r.groupLabel,event:i,data:e.computedData})}).on("click",(i,r)=>{i.stopPropagation(),S.next({type:"grid",eventName:"click",pluginName:a,highlightTarget:e.highlightTarget,datum:r,series:e.SeriesDataMap.get(r.seriesLabel),seriesIndex:r.seriesIndex,seriesLabel:r.seriesLabel,groups:e.GroupDataMap.get(r.groupLabel),groupIndex:r.groupIndex,groupLabel:r.groupLabel,event:i,data:e.computedData})}),B.next(t)});const te=R.subscribe();return O({barSelection:B,highlight:R,fullChartParams:I}).pipe(p(c),L(async e=>e)).subscribe(e=>{de({selection:e.barSelection,ids:e.highlight,fullChartParams:e.fullChartParams})}),()=>{c.next(void 0),te.unsubscribe()}},w="Bars",dt=re(w,ae)(({selection:a,name:o,subject:n,observer:s})=>{const P=new x,_=ge(w,{selection:a,computedData$:s.computedData$,visibleComputedData$:s.visibleComputedData$,SeriesDataMap$:s.SeriesDataMap$,GroupDataMap$:s.GroupDataMap$,fullParams$:s.fullParams$,fullChartParams$:s.fullChartParams$,gridAxesTransform$:s.gridAxesTransform$,gridGraphicTransform$:s.gridGraphicTransform$,gridAxesSize$:s.gridAxesSize$,gridHighlight$:s.gridHighlight$,event$:n.event$});return()=>{P.next(void 0),_()}}),Te={id:"CP_BOTTOM_AND_LEFT_PADDING_WITH_SERIES_HIGHLIGHT",description:"間距下面及左邊留空",data:{padding:{top:60,right:60,bottom:120,left:120},highlightTarget:"series"}},Ie={id:"CP_BOTTOM_AND_LEFT_PADDING",description:"間距下面及左邊留空",data:{padding:{top:60,right:60,bottom:120,left:120}}},ue={id:"CP_BOTTOM_LONG_PADDING",description:"間距下面加長留空",data:{padding:{top:60,right:60,bottom:140,left:60}}},De={id:"CP_BOTTOM_LONG_PADDING_WITH_SERIES_HIGHLIGHT",description:"間距下面加長留空及highlight系列",data:{padding:{top:60,right:60,bottom:140,left:60},highlightTarget:"series"}},Ee={id:"CP_BOTTOM_PADDING_WITH_GROUP_HIGHLIGHT",description:"間距下面留空及highlight群組",data:{padding:{top:60,right:60,bottom:120,left:60},highlightTarget:"group"}},he={id:"CP_BOTTOM_PADDING_WITH_GROUP_HIGHLIGHT",description:"間距下面留空及highlight系列",data:{padding:{top:60,right:60,bottom:120,left:60},highlightTarget:"series"}},Oe={id:"CP_BOTTOM_PADDING",description:"間距下面留空",data:{padding:{top:60,right:60,bottom:120,left:60}}},Le={id:"CP_LEFT_PADDING",description:"間距右邊留空",data:{padding:{top:60,right:60,bottom:60,left:120}}},me={id:"CP_TOP_AND_NO_BOTTOM_PADDING",description:"間距上面留空下面不留空",data:{padding:{top:140,right:120,bottom:0,left:60}}},Se={id:"CP_RIGHT_PADDING",description:"間距右邊留空",data:{padding:{top:60,right:120,bottom:60,left:60}}},Ge=Object.freeze(Object.defineProperty({__proto__:null,CP_BOTTOM_AND_LEFT_PADDING:Ie,CP_BOTTOM_AND_LEFT_PADDING_WITH_SERIES_HIGHLIGHT:Te,CP_BOTTOM_LONG_PADDING:ue,CP_BOTTOM_LONG_PADDING_WITH_SERIES_HIGHLIGHT:De,CP_BOTTOM_PADDING:Oe,CP_BOTTOM_PADDING_WITH_GROUP_HIGHLIGHT:Ee,CP_BOTTOM_PADDING_WITH_SERIES_HIGHLIGHT:he,CP_LEFT_PADDING:Le,CP_RIGHT_PADDING:Se,CP_TOP_AND_NO_BOTTOM_PADDING:me},Symbol.toStringTag,{value:"Module"})),Ne={},be=Object.freeze(Object.defineProperty({__proto__:null,temp:Ne},Symbol.toStringTag,{value:"Module"})),Ae={id:"PP_BUBBLES_SCALING_BY_RADIUS",chartType:"series",pluginName:"Bubbles",description:"以半徑尺寸為比例的泡泡圖",data:{bubbleScaleType:"radius"}},Re={id:"PP_PIE_DONUT",chartType:"series",pluginName:"Pie",description:"甜甜圈圖",data:{innerRadius:.5}},Be={id:"PP_PIE_HALF_DONUT",chartType:"series",pluginName:"Pie",description:"半圓甜甜圈圖",data:{innerRadius:.5,startAngle:-Math.PI/2,endAngle:Math.PI/2}},He={id:"PP_PIE_LABELS_HALF_ANGLE",chartType:"series",pluginName:"PieLabels",description:"半圓甜甜圈資料標籤",data:{startAngle:-Math.PI/2,endAngle:Math.PI/2}},Me={id:"PP_PIE_LABELS_INNER",chartType:"series",pluginName:"PieLabels",description:"圖內資料標籤",data:{labelCentroid:1.3,labelColorType:"primary"}},fe={id:"PP_SERIES_LEGEND_BOTTOM",chartType:"series",pluginName:"SeriesLegend",description:"圓型圖例列點",data:{listRectRadius:7}},ye=Object.freeze(Object.defineProperty({__proto__:null,PP_BUBBLES_SCALING_BY_RADIUS:Ae,PP_PIE_DONUT:Re,PP_PIE_HALF_DONUT:Be,PP_PIE_LABELS_HALF_ANGLE:He,PP_PIE_LABELS_INNER:Me,PP_SERIES_LEGEND_ROUND:fe},Symbol.toStringTag,{value:"Module"})),Ce={id:"DF_BOTTOM_VALUE_AXIS",chartType:"grid",description:"底部橫向資料圖軸",data:{valueAxis:{position:"bottom"},groupAxis:{position:"left"}}},Ue=Object.freeze(Object.defineProperty({__proto__:null,DF_BOTTOM_VALUE_AXIS:Ce},Symbol.toStringTag,{value:"Module"})),xe={id:"PP_BARS_ROUND",chartType:"grid",pluginName:"Bars",description:"圓角長條圖",data:{barWidth:0,barPadding:1,barGroupPadding:10,barRadius:!0}},Fe={id:"PP_BARS_THIN",chartType:"grid",pluginName:"Bars",description:"圓角長條圖",data:{barWidth:20,barPadding:1,barGroupPadding:10}},We={id:"PP_DOTS_ONLY_SHOW_HIGHLIGHTED",chartType:"grid",pluginName:"Dots",description:"顯示highlight圓點",data:{onlyShowHighlighted:!1}},je={id:"PP_DOTS_SOLID",chartType:"grid",pluginName:"Dots",description:"實心圓點",data:{radius:3,fillColorType:"series",onlyShowHighlighted:!1}},$e={id:"PP_GRID_LEGEND_BOTTOM_WITH_LINE_LIST",chartType:"grid",pluginName:"GridLegend",description:"底部圖例及線條列點",data:{position:"bottom",justify:"center",padding:14,listRectHeight:2}},we={id:"PP_GRID_LEGEND_BOTTOM",chartType:"grid",pluginName:"GridLegend",description:"底部圖例",data:{position:"bottom",justify:"center",padding:14}},ve={id:"PP_GROUP_AXIS_ROTATE_LABEL",chartType:"grid",pluginName:"GroupAxis",description:"群組圖軸標籤文字傾斜",data:{tickTextRotate:40}},ze={id:"PP_LINES_CURVE",chartType:"grid",pluginName:"Lines",description:"圓弧折線圖",data:{lineCurve:"curveMonotoneX",lineWidth:3}},Ye=Object.freeze(Object.defineProperty({__proto__:null,PP_BARS_ROUND:xe,PP_BARS_THIN:Fe,PP_DOTS_ONLY_SHOW_HIGHLIGHTED:We,PP_DOTS_SOLID:je,PP_GRID_LEGEND_BOTTOM:we,PP_GRID_LEGEND_BOTTOM_WITH_LINE_LIST:$e,PP_GROUP_AXIS_ROTATE_LABEL:ve,PP_LINES_CURVE:ze},Symbol.toStringTag,{value:"Module"})),Ve={},Xe=Object.freeze(Object.defineProperty({__proto__:null,temp:Ve},Symbol.toStringTag,{value:"Module"})),ke={id:"PP_MULTI_GRID_LEGEND_BOTTOM_WITH_RECT_AND_LINE_LIST",chartType:"multiGrid",pluginName:"MultiGridLegend",description:"底部圖例及線條列點",data:{position:"bottom",justify:"center",padding:14,gridList:[{},{listRectHeight:2}]}},Ze={id:"PP_GRID_LEGEND_BOTTOM",chartType:"multiGrid",pluginName:"MultiGridLegend",description:"底部圖例",data:{position:"bottom",justify:"center",padding:14}},Qe=Object.freeze(Object.defineProperty({__proto__:null,PP_GRID_LEGEND_BOTTOM:Ze,PP_MULTI_GRID_LEGEND_BOTTOM_WITH_RECT_AND_LINE_LIST:ke},Symbol.toStringTag,{value:"Module"})),qe={},Je=Object.freeze(Object.defineProperty({__proto__:null,temp:qe},Symbol.toStringTag,{value:"Module"})),Ke={},et=Object.freeze(Object.defineProperty({__proto__:null,temp:Ke},Symbol.toStringTag,{value:"Module"})),tt={},rt=Object.freeze(Object.defineProperty({__proto__:null,temp:tt},Symbol.toStringTag,{value:"Module"})),at={},it=Object.freeze(Object.defineProperty({__proto__:null,temp:at},Symbol.toStringTag,{value:"Module"})),st={},ot=Object.freeze(Object.defineProperty({__proto__:null,temp:st},Symbol.toStringTag,{value:"Module"})),nt={},_t=Object.freeze(Object.defineProperty({__proto__:null,temp:nt},Symbol.toStringTag,{value:"Module"})),v={series:be,grid:Ue,multiGrid:Xe,multiValue:Je,relationship:rt,tree:ot},U={series:ye,grid:Ye,multiGrid:Qe,multiValue:et,relationship:it,tree:_t},F=(a,o)=>{const n=o.chartParamsId?Ge[o.chartParamsId].data:void 0,s=v[a][o.dataFormatterId]?v[a][o.dataFormatterId].data:void 0,P=o.allPluginParamsIds?o.allPluginParamsIds.reduce((_,g)=>{if(U[a][g]){const I=U[a][g].pluginName;_[I]=U[a][g].data}return _},{}):void 0;return{chartParams:n,dataFormatter:s,allPluginParams:P}},G=a=>F("series",a),T=a=>F("grid",a),lt=a=>F("multiGrid",a),gt=G({allPluginParamsIds:[],description:"基本Series參數"}),Tt=G({allPluginParamsIds:["PP_BUBBLES_SCALING_BY_RADIUS","PP_SERIES_LEGEND_ROUND"],description:"以半徑尺寸為比例的泡泡圖"}),It=G({allPluginParamsIds:["PP_PIE_LABELS_INNER","PP_SERIES_LEGEND_ROUND"],description:"圓餅圖及內部資料標籤"}),ut=G({allPluginParamsIds:["PP_PIE_DONUT","PP_SERIES_LEGEND_ROUND"],description:"甜甜圈圖"}),Dt=G({chartParamsId:"CP_TOP_AND_NO_BOTTOM_PADDING",allPluginParamsIds:["PP_PIE_HALF_DONUT","PP_PIE_LABELS_HALF_ANGLE","PP_SERIES_LEGEND_ROUND"],description:"半圓甜甜圈圖"}),Et=T({chartParamsId:"CP_BOTTOM_PADDING",allPluginParamsIds:["PP_GRID_LEGEND_BOTTOM"],description:"基本Grid參數"}),ht=T({chartParamsId:"CP_BOTTOM_LONG_PADDING",allPluginParamsIds:["PP_GROUP_AXIS_ROTATE_LABEL","PP_GRID_LEGEND_BOTTOM"],description:"傾斜標籤"}),Ot=T({chartParamsId:"CP_BOTTOM_AND_LEFT_PADDING",dataFormatterId:"DF_BOTTOM_VALUE_AXIS",allPluginParamsIds:["PP_GRID_LEGEND_BOTTOM"],description:"橫向圓角長條圖"}),Lt=T({chartParamsId:"CP_BOTTOM_PADDING",allPluginParamsIds:["PP_BARS_ROUND","PP_GRID_LEGEND_BOTTOM"],description:"圓角長條圖"}),mt=T({chartParamsId:"CP_BOTTOM_AND_LEFT_PADDING",dataFormatterId:"DF_BOTTOM_VALUE_AXIS",allPluginParamsIds:["PP_BARS_ROUND","PP_GRID_LEGEND_BOTTOM"],description:"橫向圓角長條圖"}),St=T({chartParamsId:"CP_BOTTOM_PADDING",allPluginParamsIds:["PP_BARS_THIN","PP_GRID_LEGEND_BOTTOM"],description:"細長條圖"}),Gt=T({chartParamsId:"CP_BOTTOM_AND_LEFT_PADDING",dataFormatterId:"DF_BOTTOM_VALUE_AXIS",allPluginParamsIds:["PP_BARS_ROUND","PP_GRID_LEGEND_BOTTOM"],description:"橫向圓角長條圖"}),Nt=T({chartParamsId:"CP_BOTTOM_PADDING_WITH_SERIES_HIGHLIGHT",allPluginParamsIds:["PP_GRID_LEGEND_BOTTOM_WITH_LINE_LIST"],description:"基本Grid參數"}),bt=T({chartParamsId:"CP_BOTTOM_LONG_PADDING_WITH_SERIES_HIGHLIGHT",allPluginParamsIds:["PP_GROUP_AXIS_ROTATE_LABEL","PP_GRID_LEGEND_BOTTOM_WITH_LINE_LIST"],description:"傾斜標籤"}),At=T({chartParamsId:"CP_BOTTOM_AND_LEFT_PADDING_WITH_SERIES_HIGHLIGHT",dataFormatterId:"DF_BOTTOM_VALUE_AXIS",allPluginParamsIds:["PP_GRID_LEGEND_BOTTOM_WITH_LINE_LIST"],description:"橫向圓角長條圖"}),Rt=T({chartParamsId:"CP_BOTTOM_PADDING_WITH_SERIES_HIGHLIGHT",allPluginParamsIds:["PP_LINES_CURVE","PP_GRID_LEGEND_BOTTOM_WITH_LINE_LIST"],description:"弧線折線圖"}),Bt=T({chartParamsId:"CP_BOTTOM_PADDING_WITH_GROUP_HIGHLIGHT",allPluginParamsIds:["PP_DOTS_ONLY_SHOW_HIGHLIGHTED","PP_GRID_LEGEND_BOTTOM_WITH_LINE_LIST"],description:"折線圖及Highlight Group圓點"}),Ht=lt({chartParamsId:"CP_BOTTOM_PADDING",allPluginParamsIds:["PP_MULTI_GRID_LEGEND_BOTTOM_WITH_RECT_AND_LINE_LIST"],description:"基本MultiGrid參數"});export{dt as B,gt as P,Tt as a,It as b,ge as c,ut as d,Dt as e,Et as f,ht as g,Ot as h,Lt as i,mt as j,St as k,Gt as l,Nt as m,bt as n,At as o,Rt as p,Bt as q,Ht as r};
