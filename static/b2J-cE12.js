import{ae as At,af as tt,ag as lt,ah as ut,ai as $t,aj as N,l as Ft,ak as Gt,q as Pt,o as kt,al as Ct,z as O,A as R,v as k,r as rt,am as at,C as it,W as Nt,an as ct,G as ft,ao as Tt,d as W,g as K,f as z,s as X,S as Lt,O as mt,t as gt,ap as Ot}from"./DTMfjTug.js";import{s as U,g as Q}from"./D2FdcmjD.js";function q(t,e){return t==null||e==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function Rt(t,e){return t==null||e==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function xt(t){let e,r,n;t.length!==2?(e=q,r=(s,u)=>q(t(s),u),n=(s,u)=>t(s)-u):(e=t===q||t===Rt?t:jt,r=t,n=t);function i(s,u,l=0,m=s.length){if(l<m){if(e(u,u)!==0)return m;do{const c=l+m>>>1;r(s[c],u)<0?l=c+1:m=c}while(l<m)}return l}function a(s,u,l=0,m=s.length){if(l<m){if(e(u,u)!==0)return m;do{const c=l+m>>>1;r(s[c],u)<=0?l=c+1:m=c}while(l<m)}return l}function o(s,u,l=0,m=s.length){const c=i(s,u,l,m-1);return c>l&&n(s[c-1],u)>-n(s[c],u)?c-1:c}return{left:i,center:o,right:a}}function jt(){return 0}function Vt(t){return t===null?NaN:+t}const zt=xt(q),Xt=zt.right;xt(Vt).center;const Yt=Math.sqrt(50),Et=Math.sqrt(10),Wt=Math.sqrt(2);function _(t,e,r){const n=(e-t)/Math.max(0,r),i=Math.floor(Math.log10(n)),a=n/Math.pow(10,i),o=a>=Yt?10:a>=Et?5:a>=Wt?2:1;let s,u,l;return i<0?(l=Math.pow(10,-i)/o,s=Math.round(t*l),u=Math.round(e*l),s/l<t&&++s,u/l>e&&--u,l=-l):(l=Math.pow(10,i)*o,s=Math.round(t/l),u=Math.round(e/l),s*l<t&&++s,u*l>e&&--u),u<s&&.5<=r&&r<2?_(t,e,r*2):[s,u,l]}function Ut(t,e,r){if(e=+e,t=+t,r=+r,!(r>0))return[];if(t===e)return[t];const n=e<t,[i,a,o]=n?_(e,t,r):_(t,e,r);if(!(a>=i))return[];const s=a-i+1,u=new Array(s);if(n)if(o<0)for(let l=0;l<s;++l)u[l]=(a-l)/-o;else for(let l=0;l<s;++l)u[l]=(a-l)*o;else if(o<0)for(let l=0;l<s;++l)u[l]=(i+l)/-o;else for(let l=0;l<s;++l)u[l]=(i+l)*o;return u}function et(t,e,r){return e=+e,t=+t,r=+r,_(t,e,r)[2]}function It(t,e,r){e=+e,t=+t,r=+r;const n=e<t,i=n?et(e,t,r):et(t,e,r);return(n?-1:1)*(i<0?1/-i:i)}function qt(t,e){e||(e=[]);var r=t?Math.min(e.length,t.length):0,n=e.slice(),i;return function(a){for(i=0;i<r;++i)n[i]=t[i]*(1-a)+e[i]*a;return n}}function _t(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function Bt(t,e){var r=e?e.length:0,n=t?Math.min(r,t.length):0,i=new Array(n),a=new Array(r),o;for(o=0;o<n;++o)i[o]=ot(t[o],e[o]);for(;o<r;++o)a[o]=e[o];return function(s){for(o=0;o<n;++o)a[o]=i[o](s);return a}}function Ht(t,e){var r=new Date;return t=+t,e=+e,function(n){return r.setTime(t*(1-n)+e*n),r}}function Jt(t,e){var r={},n={},i;(t===null||typeof t!="object")&&(t={}),(e===null||typeof e!="object")&&(e={});for(i in e)i in t?r[i]=ot(t[i],e[i]):n[i]=e[i];return function(a){for(i in r)n[i]=r[i](a);return n}}function ot(t,e){var r=typeof e,n;return e==null||r==="boolean"?At(e):(r==="number"?tt:r==="string"?(n=lt(e))?(e=n,ut):$t:e instanceof lt?ut:e instanceof Date?Ht:_t(e)?qt:Array.isArray(e)?Bt:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?Jt:tt)(t,e)}function Zt(t,e){return t=+t,e=+e,function(r){return Math.round(t*(1-r)+e*r)}}function Kt(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function B(t,e){if((r=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var r,n=t.slice(0,r);return[n.length>1?n[0]+n.slice(2):n,+t.slice(r+1)]}function L(t){return t=B(Math.abs(t)),t?t[1]:NaN}function Qt(t,e){return function(r,n){for(var i=r.length,a=[],o=0,s=t[0],u=0;i>0&&s>0&&(u+s+1>n&&(s=Math.max(1,n-u)),a.push(r.substring(i-=s,i+s)),!((u+=s+1)>n));)s=t[o=(o+1)%t.length];return a.reverse().join(e)}}function te(t){return function(e){return e.replace(/[0-9]/g,function(r){return t[+r]})}}var ee=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function H(t){if(!(e=ee.exec(t)))throw new Error("invalid format: "+t);var e;return new st({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}H.prototype=st.prototype;function st(t){this.fill=t.fill===void 0?" ":t.fill+"",this.align=t.align===void 0?">":t.align+"",this.sign=t.sign===void 0?"-":t.sign+"",this.symbol=t.symbol===void 0?"":t.symbol+"",this.zero=!!t.zero,this.width=t.width===void 0?void 0:+t.width,this.comma=!!t.comma,this.precision=t.precision===void 0?void 0:+t.precision,this.trim=!!t.trim,this.type=t.type===void 0?"":t.type+""}st.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function ne(t){t:for(var e=t.length,r=1,n=-1,i;r<e;++r)switch(t[r]){case".":n=i=r;break;case"0":n===0&&(n=r),i=r;break;default:if(!+t[r])break t;n>0&&(n=0);break}return n>0?t.slice(0,n)+t.slice(i+1):t}var vt;function re(t,e){var r=B(t,e);if(!r)return t+"";var n=r[0],i=r[1],a=i-(vt=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,o=n.length;return a===o?n:a>o?n+new Array(a-o+1).join("0"):a>0?n.slice(0,a)+"."+n.slice(a):"0."+new Array(1-a).join("0")+B(t,Math.max(0,e+a-1))[0]}function dt(t,e){var r=B(t,e);if(!r)return t+"";var n=r[0],i=r[1];return i<0?"0."+new Array(-i).join("0")+n:n.length>i+1?n.slice(0,i+1)+"."+n.slice(i+1):n+new Array(i-n.length+2).join("0")}const pt={"%":(t,e)=>(t*100).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:Kt,e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>dt(t*100,e),r:dt,s:re,X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function ht(t){return t}var bt=Array.prototype.map,yt=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function ae(t){var e=t.grouping===void 0||t.thousands===void 0?ht:Qt(bt.call(t.grouping,Number),t.thousands+""),r=t.currency===void 0?"":t.currency[0]+"",n=t.currency===void 0?"":t.currency[1]+"",i=t.decimal===void 0?".":t.decimal+"",a=t.numerals===void 0?ht:te(bt.call(t.numerals,String)),o=t.percent===void 0?"%":t.percent+"",s=t.minus===void 0?"−":t.minus+"",u=t.nan===void 0?"NaN":t.nan+"";function l(c){c=H(c);var f=c.fill,p=c.align,g=c.sign,h=c.symbol,b=c.zero,v=c.width,D=c.comma,y=c.precision,w=c.trim,M=c.type;M==="n"?(D=!0,M="g"):pt[M]||(y===void 0&&(y=12),w=!0,M="g"),(b||f==="0"&&p==="=")&&(b=!0,f="0",p="=");var F=h==="$"?r:h==="#"&&/[boxX]/.test(M)?"0"+M.toLowerCase():"",G=h==="$"?n:/[%p]/.test(M)?o:"",j=pt[M],Y=/[defgprs%]/.test(M);y=y===void 0?6:/[gprs]/.test(M)?Math.max(1,Math.min(21,y)):Math.max(0,Math.min(20,y));function V(d){var S=F,x=G,A,Z,C;if(M==="c")x=j(d)+x,d="";else{d=+d;var P=d<0||1/d<0;if(d=isNaN(d)?u:j(Math.abs(d),y),w&&(d=ne(d)),P&&+d==0&&g!=="+"&&(P=!1),S=(P?g==="("?g:s:g==="-"||g==="("?"":g)+S,x=(M==="s"?yt[8+vt/3]:"")+x+(P&&g==="("?")":""),Y){for(A=-1,Z=d.length;++A<Z;)if(C=d.charCodeAt(A),48>C||C>57){x=(C===46?i+d.slice(A+1):d.slice(A))+x,d=d.slice(0,A);break}}}D&&!b&&(d=e(d,1/0));var E=S.length+d.length+x.length,$=E<v?new Array(v-E+1).join(f):"";switch(D&&b&&(d=e($+d,$.length?v-x.length:1/0),$=""),p){case"<":d=S+d+x+$;break;case"=":d=S+$+d+x;break;case"^":d=$.slice(0,E=$.length>>1)+S+d+x+$.slice(E);break;default:d=$+S+d+x;break}return a(d)}return V.toString=function(){return c+""},V}function m(c,f){var p=l((c=H(c),c.type="f",c)),g=Math.max(-8,Math.min(8,Math.floor(L(f)/3)))*3,h=Math.pow(10,-g),b=yt[8+g/3];return function(v){return p(h*v)+b}}return{format:l,formatPrefix:m}}var I,Dt,wt;ie({thousands:",",grouping:[3],currency:["$",""]});function ie(t){return I=ae(t),Dt=I.format,wt=I.formatPrefix,I}function oe(t){return Math.max(0,-L(Math.abs(t)))}function se(t,e){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(L(e)/3)))*3-L(Math.abs(t)))}function le(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,L(e)-L(t))+1}function ue(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t);break}return this}function ce(t){return function(){return t}}function fe(t){return+t}var Mt=[0,1];function T(t){return t}function nt(t,e){return(e-=t=+t)?function(r){return(r-t)/e}:ce(isNaN(e)?NaN:.5)}function me(t,e){var r;return t>e&&(r=t,t=e,e=r),function(n){return Math.max(t,Math.min(e,n))}}function ge(t,e,r){var n=t[0],i=t[1],a=e[0],o=e[1];return i<n?(n=nt(i,n),a=r(o,a)):(n=nt(n,i),a=r(a,o)),function(s){return a(n(s))}}function de(t,e,r){var n=Math.min(t.length,e.length)-1,i=new Array(n),a=new Array(n),o=-1;for(t[n]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++o<n;)i[o]=nt(t[o],t[o+1]),a[o]=r(e[o],e[o+1]);return function(s){var u=Xt(t,s,1,n)-1;return a[u](i[u](s))}}function pe(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function he(){var t=Mt,e=Mt,r=ot,n,i,a,o=T,s,u,l;function m(){var f=Math.min(t.length,e.length);return o!==T&&(o=me(t[0],t[f-1])),s=f>2?de:ge,u=l=null,c}function c(f){return f==null||isNaN(f=+f)?a:(u||(u=s(t.map(n),e,r)))(n(o(f)))}return c.invert=function(f){return o(i((l||(l=s(e,t.map(n),tt)))(f)))},c.domain=function(f){return arguments.length?(t=Array.from(f,fe),m()):t.slice()},c.range=function(f){return arguments.length?(e=Array.from(f),m()):e.slice()},c.rangeRound=function(f){return e=Array.from(f),r=Zt,m()},c.clamp=function(f){return arguments.length?(o=f?!0:T,m()):o!==T},c.interpolate=function(f){return arguments.length?(r=f,m()):r},c.unknown=function(f){return arguments.length?(a=f,c):a},function(f,p){return n=f,i=p,m()}}function be(){return he()(T,T)}function ye(t,e,r,n){var i=It(t,e,r),a;switch(n=H(n??",f"),n.type){case"s":{var o=Math.max(Math.abs(t),Math.abs(e));return n.precision==null&&!isNaN(a=se(i,o))&&(n.precision=a),wt(n,o)}case"":case"e":case"g":case"p":case"r":{n.precision==null&&!isNaN(a=le(i,Math.max(Math.abs(t),Math.abs(e))))&&(n.precision=a-(n.type==="e"));break}case"f":case"%":{n.precision==null&&!isNaN(a=oe(i))&&(n.precision=a-(n.type==="%")*2);break}}return Dt(n)}function Me(t){var e=t.domain;return t.ticks=function(r){var n=e();return Ut(n[0],n[n.length-1],r??10)},t.tickFormat=function(r,n){var i=e();return ye(i[0],i[i.length-1],r??10,n)},t.nice=function(r){r==null&&(r=10);var n=e(),i=0,a=n.length-1,o=n[i],s=n[a],u,l,m=10;for(s<o&&(l=o,o=s,s=l,l=i,i=a,a=l);m-- >0;){if(l=et(o,s,r),l===u)return n[i]=o,n[a]=s,e(n);if(l>0)o=Math.floor(o/l)*l,s=Math.ceil(s/l)*l;else if(l<0)o=Math.ceil(o*l)/l,s=Math.floor(s*l)/l;else break;u=l}return t},t}function St(){var t=be();return t.copy=function(){return pe(t,St())},ue.apply(t,arguments),Me(t)}const J=({maxValue:t=1,minValue:e=0,axisWidth:r,scaleDomain:n=N.scaleDomain,scaleRange:i=N.scaleRange})=>{const a=n[0]??N.scaleDomain[0],o=n[1]??N.scaleDomain[1],s=i[0]??N.scaleRange[0],u=i[1]??N.scaleRange[1],l=a==="auto"?e:a,m=o==="auto"?t:o,c=t-(t-l)/(1-s),f=m/u;return St().domain([c,f]).range([0,r])};function xe(t,e){if(!t.length)return[];try{const r=t.reduce((o,s)=>s.length>o?s.length:o,0),i=t.map((o,s)=>{if(o.length===r)return o;const u=Object.assign([],o);for(let l=u.length;l<r;l++)u[l]=null;return u}).map((o,s)=>o.map((u,l)=>u==null?{id:"",label:"",data:{},value:null}:typeof u=="number"?{id:"",label:"",data:{},value:u}:{id:u.id??"",label:u.label??"",data:u.data??{},value:u.value}));return Ct(e.seriesDirection,i)}catch{return[]}}const we=t=>{const{data:e=[],dataFormatter:r,chartParams:n}=t;if(!e.length)return[];let i;try{const a=xe(e,r.grid),o=Ft({transposedDataGrid:a,dataFormatterGrid:r.grid,chartType:"grid"}),s=Gt({transposedDataGrid:a,dataFormatterGrid:r.grid,chartType:"grid"});let u=0;i=a.map((l,m)=>l.map((c,f)=>{const p=Pt("grid",0,m,f),g=s[f],h={id:c.id?c.id:p,index:u,label:c.label?c.label:p,description:c.description??"",data:c.data,value:c.value,gridIndex:0,seriesIndex:m,seriesLabel:o[m],groupIndex:f,groupLabel:g,color:kt(m,n),visible:!0};return h.visible=r.visibleFilter(h,t),u++,h}))}catch(a){throw Error(a)}return i},Se=({computedData$:t,fullDataFormatter$:e,layout$:r})=>{function n(a,o,s){const u=o.grid.groupAxis.position==="top"||o.grid.groupAxis.position==="bottom"?s.width:s.height,l=a[0]?a[0].length-1:0;return J({maxValue:l,minValue:0,axisWidth:u,scaleDomain:[0,l],scaleRange:[0,1]})}function i(a,o,s){const u=o.grid.valueAxis.position==="left"||o.grid.valueAxis.position==="right"?s.height:s.width,l=a.flat(),[m,c]=Tt(l);return J({maxValue:c,minValue:m,axisWidth:u,scaleDomain:[m,c],scaleRange:[0,1]})}return O({computedData:t,fullDataFormatter:e,layout:r}).pipe(R(async a=>a),k(a=>{const o=n(a.computedData,a.fullDataFormatter,a.layout),s=i(a.computedData,a.fullDataFormatter,a.layout),u=s(0);return a.computedData.map((l,m)=>l.map((c,f)=>{const p=o(f),g=s(c.value??0);return{...c,axisX:p,axisY:g,axisYFromZero:g-u}}))}))},Ae=({fullDataFormatter$:t,layout$:e})=>{const r=new rt;function n({xAxis:i,yAxis:a,width:o,height:s}){if(!i||!a)return{translate:[0,0],scale:[1,1],rotate:0,rotateX:0,rotateY:0,value:""};let u=0,l=0,m=0,c=0,f=0;return i.position==="bottom"?a.position==="left"?(c=180,l=s):a.position==="right"?(c=180,f=180,u=o,l=s):(c=180,l=s):i.position==="top"?a.position==="left"||(a.position==="right"?(f=180,u=o):(c=180,l=s)):i.position==="left"?a.position==="bottom"?(m=-90,l=s):a.position==="top"?(m=-90,f=180):(c=180,l=s):i.position==="right"&&(a.position==="bottom"?(m=-90,c=180,l=s,u=o):a.position==="top"?(m=-90,c=180,f=180,u=o):(c=180,l=s)),{translate:[u,l],scale:[1,1],rotate:m,rotateX:c,rotateY:f,value:`translate(${u}px, ${l}px) rotate(${m}deg) rotateX(${c}deg) rotateY(${f}deg)`}}return new at(i=>(O({fullDataFormatter:t,layout:e}).pipe(it(r),R(async a=>a)).subscribe(a=>{const o=n({xAxis:a.fullDataFormatter.grid.groupAxis,yAxis:a.fullDataFormatter.grid.valueAxis,width:a.layout.width,height:a.layout.height});i.next(o)}),function(){r.next(void 0)}))},$e=({gridAxesTransform$:t})=>t.pipe(k(e=>{const r=[0,0],n=[1/e.scale[0],1/e.scale[1]],i=e.rotate*-1,a=e.rotateX*-1,o=e.rotateY*-1;return{translate:r,scale:n,rotate:i,rotateX:a,rotateY:o,value:`translate(${r[0]}px, ${r[1]}px) rotate(${i}deg) rotateX(${a}deg) rotateY(${o}deg)`}})),Fe=({computedData$:t,fullDataFormatter$:e,layout$:r})=>{const n=new rt;function i({data:a,groupAxis:o,valueAxis:s,width:u,height:l}){let m=0,c=0,f=0,p=0;const g=o.position==="top"||o.position==="bottom"?u:l,h=0,b=a[0]?a[0].length-1:0,v=o.scaleDomain[0]==="auto"?h-o.scalePadding:o.scaleDomain[0]-o.scalePadding,D=o.scaleDomain[1]==="auto"?b+o.scalePadding:o.scaleDomain[1]+o.scalePadding,y=J({maxValue:b,minValue:h,axisWidth:g,scaleDomain:[v,D],scaleRange:[0,1]}),w=y(h),M=y(b);h==b?(m=0,f=1):(m=w,f=(M-w)/g);const F=a.map((A,Z)=>A.filter((C,P)=>P>=v&&P<=D&&C.visible==!0)),G=ct(F),j=s.position==="left"||s.position==="right"?l:u,Y=J({maxValue:G[1],minValue:G[0],axisWidth:j,scaleDomain:s.scaleDomain,scaleRange:s.scaleRange}),V=ct(a),d=Y(V[0]),S=Y(V[1]);return c=d,p=(S-d)/j,{translate:[m,c],scale:[f,p],rotate:0,rotateX:0,rotateY:0,value:`translate(${m}px, ${c}px) scale(${f}, ${p})`}}return new at(a=>(O({computedData:t,fullDataFormatter:e,layout:r}).pipe(it(n),R(async o=>o)).subscribe(o=>{const s=i({data:o.computedData,groupAxis:o.fullDataFormatter.grid.groupAxis,valueAxis:o.fullDataFormatter.grid.valueAxis,width:o.layout.width,height:o.layout.height});a.next(s)}),function(){n.next(void 0)}))},Ge=({gridContainerPosition$:t,gridAxesTransform$:e,gridGraphicTransform$:r})=>O({gridContainerPosition:t,gridAxesTransform:e,gridGraphicTransform:r}).pipe(R(async n=>n),k(n=>n.gridAxesTransform.rotate==0||n.gridAxesTransform.rotate==180?n.gridContainerPosition.map((i,a)=>[1/n.gridGraphicTransform.scale[0]/n.gridContainerPosition[a].scale[0],1/n.gridGraphicTransform.scale[1]/n.gridContainerPosition[a].scale[1]]):n.gridContainerPosition.map((i,a)=>[1/n.gridGraphicTransform.scale[0]/n.gridContainerPosition[a].scale[1],1/n.gridGraphicTransform.scale[1]/n.gridContainerPosition[a].scale[0]]))),Pe=({fullDataFormatter$:t,layout$:e})=>{const r=new rt;function n({xAxisPosition:i,yAxisPosition:a,width:o,height:s}){if((i==="bottom"||i==="top")&&(a==="left"||a==="right"))return{width:o,height:s};if((i==="left"||i==="right")&&(a==="bottom"||a==="top"))return{width:s,height:o}}return new at(i=>{O({fullDataFormatter:t,layout:e}).pipe(it(r),R(async a=>a)).subscribe(a=>{const o=n({xAxisPosition:a.fullDataFormatter.grid.groupAxis.position,yAxisPosition:a.fullDataFormatter.grid.valueAxis.position,width:a.layout.width,height:a.layout.height});return i.next(o),function(){r.next(void 0)}})})},ke=({computedData$:t})=>t.pipe(k(e=>e.filter(r=>r.length).map(r=>r[0].seriesLabel)),Nt((e,r)=>JSON.stringify(e).length===JSON.stringify(r).length)),Ce=({computedData$:t})=>t.pipe(k(e=>e.map(n=>n.filter(i=>i.visible==!0)).filter(n=>n.length))),Ne=({computedLayoutData$:t})=>t.pipe(k(e=>e.map(n=>n.filter(i=>i.visible==!0)).filter(n=>n.length))),Te=({computedData$:t,fullDataFormatter$:e,layout$:r})=>O({computedData:t,fullDataFormatter:e,layout:r}).pipe(R(async i=>i),k(i=>i.fullDataFormatter.grid.separateSeries?ft(i.layout,i.fullDataFormatter.container,i.computedData.length):ft(i.layout,i.fullDataFormatter.container,1))),Le=({selection:t,pluginName:e,clipPathID:r,seriesLabels$:n,gridContainerPosition$:i,gridAxesTransform$:a,gridGraphicTransform$:o})=>{const s=Q(e,"series"),u=Q(e,"axes"),l=Q(e,"graphic"),m=n.pipe(W((g,h)=>t.selectAll(`g.${s}`).data(g,b=>b).join(b=>b.append("g").classed(s,!0).each((v,D,y)=>{K(y[D]).selectAll(`g.${u}`).data([D]).join(w=>w.append("g").classed(u,!0).attr("clip-path",`url(#${r})`).each((M,F,G)=>{K(G[F]).selectAll("defs").data([F]).join("defs"),K(G[F]).selectAll("g").data([F]).join("g").classed(l,!0)}),w=>w,w=>w.remove())}),b=>b,b=>b.remove())),U(1));z({seriesSelection:m,gridContainerPosition:i}).pipe(X(async g=>g)).subscribe(g=>{g.seriesSelection.transition().attr("transform",(h,b)=>{const v=g.gridContainerPosition[b]??g.gridContainerPosition[0],D=v.translate,y=v.scale;return`translate(${D[0]}, ${D[1]}) scale(${y[0]}, ${y[1]})`})});const c=z({seriesSelection:m,gridAxesTransform:a}).pipe(X(async g=>g),W(g=>g.seriesSelection.select(`g.${u}`).style("transform",g.gridAxesTransform.value)),U(1)),f=c.pipe(W(g=>g.select("defs")),U(1)),p=z({axesSelection:c,gridGraphicTransform:o}).pipe(X(async g=>g),W(g=>{const h=g.axesSelection.select(`g.${l}`);return h.transition().duration(50).style("transform",g.gridGraphicTransform.value),h}),U(1));return{seriesSelection$:m,axesSelection$:c,defsSelection$:f,graphicGSelection$:p}},Oe=({fullDataFormatter$:t,gridAxesSize$:e,computedData$:r,fullChartParams$:n})=>{const i=new Lt,a=new mt(o=>{z({dataFormatter:t,computedData:r}).pipe(gt(i),X(async s=>s)).subscribe(s=>{const l=s.computedData[0]?s.computedData[0].length-1:0,m=s.dataFormatter.grid.groupAxis.scaleDomain[0]==="auto"?0-s.dataFormatter.grid.groupAxis.scalePadding:s.dataFormatter.grid.groupAxis.scaleDomain[0]-s.dataFormatter.grid.groupAxis.scalePadding,c=s.dataFormatter.grid.groupAxis.scaleDomain[1]==="auto"?l+s.dataFormatter.grid.groupAxis.scalePadding:s.dataFormatter.grid.groupAxis.scaleDomain[1]+s.dataFormatter.grid.groupAxis.scalePadding,p=(s.dataFormatter.grid.seriesDirection==="row"?(s.computedData[0]??[]).map(g=>g.groupLabel):s.computedData.map(g=>g[0].groupLabel)).filter((g,h)=>h>=m&&h<=c);o.next(p)})});return new mt(o=>{z({dataFormatter:t,axisSize:e,fullChartParams:n,scaleRangeGroupLabels:a}).pipe(gt(i),X(async s=>s)).subscribe(s=>{const u=s.dataFormatter.grid.valueAxis.position==="right"||s.dataFormatter.grid.valueAxis.position==="bottom",l=Ot({axisLabels:s.scaleRangeGroupLabels,axisWidth:s.axisSize.width,reverse:u}),m=f=>s.dataFormatter.grid.groupAxis.position==="bottom"||s.dataFormatter.grid.groupAxis.position==="top"?f.offsetX-s.fullChartParams.padding.left:f.offsetY-s.fullChartParams.padding.top,c=f=>{const p=m(f),g=l(p);return{groupIndex:g,groupLabel:s.scaleRangeGroupLabels[g]??""}};return o.next(c),function(){i.next(void 0)}})})};export{Ae as a,$e as b,xe as c,Fe as d,Ge as e,Pe as f,Oe as g,Ce as h,Se as i,Ne as j,Le as k,Te as l,we as m,ke as s};
