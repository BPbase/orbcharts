import{S as G,o as h,h as w,t as d,p as v,m as S,i as _,ax as I,s as W,_ as O,aC as U}from"./Cs0Bj4Sj.js";import{h as D,n as q,i as E,g as z,o as N,q as H}from"./T4xlXSKD.js";const J=6;function K({selection:b,groupingLabelClassName:k,fullParams:t,axisLabelAlign:A,gridAxesSize:m,fullDataFormatter:s,chartParams:f,textReverseTransform:R}){const g=t.tickPadding+t.labelOffset[0],c=t.tickPadding+t.labelOffset[1];let p=0,n=0;s.grid.groupAxis.position==="bottom"?(n=c,s.grid.valueAxis.position==="left"?p=g:s.grid.valueAxis.position==="right"&&(p=-g)):s.grid.groupAxis.position==="top"?(n=-c,s.grid.valueAxis.position==="left"?p=g:s.grid.valueAxis.position==="right"&&(p=-g)):s.grid.groupAxis.position==="left"?(p=-g,s.grid.valueAxis.position==="bottom"?n=-c:s.grid.valueAxis.position==="top"&&(n=c)):s.grid.groupAxis.position==="right"&&(p=g,s.grid.valueAxis.position==="bottom"?n=-c:s.grid.valueAxis.position==="top"&&(n=c)),b.selectAll(`g.${k}`).data([t]).join("g").classed(k,!0).each((l,u,y)=>{W(y[u]).selectAll("text").data([l]).join(x=>x.append("text").style("font-weight","bold"),x=>x,x=>x.remove()).attr("text-anchor",A.textAnchor).attr("dominant-baseline",A.dominantBaseline).attr("font-size",f.styles.textSize).style("fill",D(t.labelColorType,f)).style("transform",R).attr("x",p).attr("y",n).text(x=>s.grid.groupAxis.label)}).attr("transform",l=>`translate(${m.width}, 0)`)}function Q({selection:b,xAxisClassName:k,fullParams:t,tickTextAlign:A,gridAxesSize:m,fullDataFormatter:s,chartParams:f,groupScale:R,groupScaleDomain:g,groupLabels:c,textReverseTransformWithRotate:p,textSizePx:n}){const l=b.selectAll(`g.${k}`).data([t]).join("g").classed(k,!0),u=Math.floor(g[1])-Math.ceil(g[0])+1;let y=0,x=0;s.grid.groupAxis.position==="left"?(y=0,x=-t.tickPadding):s.grid.groupAxis.position==="right"?(y=0,x=t.tickPadding):s.grid.groupAxis.position==="bottom"?(y=t.tickPadding,x=0):s.grid.groupAxis.position==="top"&&(y=-t.tickPadding,x=-0);const C=q(R).scale(R).ticks(t.ticks==="all"||t.ticks>u?u:t.ticks).tickSize(t.tickFullLine==!0?m.height:-J).tickSizeOuter(0).tickFormat(M=>{const P=c[M]??"";return E(P,t.tickFormat)}).tickPadding(y),$=l.transition().duration(100).call(C).on("end",(M,P)=>{$.selectAll(".tick text").each((j,X,Y)=>{const o=(c[j]??"").split(`
`),e=W(Y[X]).text(null),r=Number(e.attr("x"));let a=Number(e.attr("y"));s.grid.groupAxis.position==="top"&&(a-=(o.length-1)*n),e.selectAll("tspan").data(o).join("tspan").attr("x",r).attr("y",(T,L)=>a+L*n).text(T=>T)})});return $.selectAll("line").style("fill","none").style("stroke",t.tickLineVisible==!0?D(t.tickColorType,f):"none").style("stroke-dasharray",t.tickFullLineDasharray).attr("pointer-events","none"),$.selectAll("path").style("fill","none").style("stroke",t.axisLineVisible==!0?D(t.axisLineColorType,f):"none").style("shape-rendering","crispEdges"),l.selectAll("text").attr("font-size",f.styles.textSize).style("color",D(t.tickTextColorType,f)).attr("text-anchor",A.textAnchor).attr("dominant-baseline",A.dominantBaseline).attr("x",x).style("transform",p).attr("dy",0),l}const re=(b,{selection:k,computedData$:t,fullParams$:A,fullDataFormatter$:m,fullChartParams$:s,gridAxesTransform$:f,gridAxesReverseTransform$:R,gridAxesSize$:g,gridContainerPosition$:c,isSeriesSeprate$:p,textSizePx$:n})=>{const l=new G,u=z(b,"container"),y=z(b,"xAxisG"),x=z(b,"xAxis"),C=z(b,"groupingLabel"),$=h({computedData:t.pipe(w((e,r)=>e.length===r.length)),isSeriesSeprate:p}).pipe(d(l),v(async e=>e),S(e=>e.isSeriesSeprate?e.computedData:[e.computedData[0]]),S((e,r)=>k.selectAll(`g.${u}`).data(e,a=>a[0]?a[0].seriesIndex:r).join("g").classed(u,!0))),V=$.pipe(d(l),S((e,r)=>e.selectAll(`g.${y}`).data([y]).join("g").classed(y,!0)));h({containerSelection:$,gridContainerPosition:c}).pipe(d(l),v(async e=>e)).subscribe(e=>{e.containerSelection.attr("transform",(r,a)=>{const T=e.gridContainerPosition[a]??e.gridContainerPosition[0],L=T.translate,B=T.scale;return`translate(${L[0]}, ${L[1]}) scale(${B[0]}, ${B[1]})`})}),h({axisSelection:V,gridAxesTransform:f}).pipe(d(l),v(async e=>e)).subscribe(e=>{e.axisSelection.style("transform",e.gridAxesTransform.value)});const M=h({gridAxesReverseTransform:R,gridContainerPosition:c}).pipe(d(l),v(async e=>e),S(e=>{const r=`rotateX(${e.gridAxesReverseTransform.rotateX}deg) rotateY(${e.gridAxesReverseTransform.rotateY}deg)`,a=`rotate(${e.gridAxesReverseTransform.rotate}deg)`,T=`scale(${1/e.gridContainerPosition[0].scale[0]}, ${1/e.gridContainerPosition[0].scale[1]})`;return`${r} ${a} ${T}`}),w()),P=h({textReverseTransform:M,fullParams:A}).pipe(d(l),v(async e=>e),S(e=>`${e.textReverseTransform} rotate(${e.fullParams.tickTextRotate}deg)`)),j=h({fullDataFormatter:m,gridAxesSize:g,computedData:t}).pipe(d(l),v(async e=>e),S(e=>{const r=e.computedData[0]?e.computedData[0].length-1:0,a=e.fullDataFormatter.grid.groupAxis.scaleDomain[0]-e.fullDataFormatter.grid.groupAxis.scalePadding,T=e.fullDataFormatter.grid.groupAxis.scaleDomain[1]==="max"?r+e.fullDataFormatter.grid.groupAxis.scalePadding:e.fullDataFormatter.grid.groupAxis.scaleDomain[1]+e.fullDataFormatter.grid.groupAxis.scalePadding;return[a,T]}),_(1)),X=h({groupScaleDomain:j,gridAxesSize:g}).pipe(d(l),v(async e=>e),S(e=>I().domain(e.groupScaleDomain).range([0,e.gridAxesSize.width]))),Y=t.pipe(S(e=>(e[0]??[]).map(r=>r.groupLabel))),i=h({fullDataFormatter:m,fullParams:A}).pipe(d(l),v(async e=>e),S(e=>{let r="middle",a="hanging";return e.fullDataFormatter.grid.groupAxis.position==="bottom"?(r=e.fullParams.tickTextRotate?"end":"middle",a="hanging"):e.fullDataFormatter.grid.groupAxis.position==="top"?(r=e.fullParams.tickTextRotate?"start":"middle",a="auto"):e.fullDataFormatter.grid.groupAxis.position==="left"?(r="end",a="middle"):e.fullDataFormatter.grid.groupAxis.position==="right"&&(r="start",a="middle"),{textAnchor:r,dominantBaseline:a}})),o=m.pipe(d(l),S(e=>{let r="start",a="hanging";return e.grid.groupAxis.position==="bottom"?a="hanging":e.grid.groupAxis.position==="top"?a="auto":e.grid.groupAxis.position==="left"?r="end":e.grid.groupAxis.position==="right"&&(r="start"),e.grid.valueAxis.position==="left"?r="start":e.grid.valueAxis.position==="right"?r="end":e.grid.valueAxis.position==="bottom"?a="auto":e.grid.valueAxis.position==="top"&&(a="hanging"),{textAnchor:r,dominantBaseline:a}}));return h({axisSelection:V,fullParams:A,tickTextAlign:i,axisLabelAlign:o,gridAxesSize:g,fullDataFormatter:m,chartParams:s,groupScale:X,groupScaleDomain:j,groupLabels:Y,textReverseTransform:M,textReverseTransformWithRotate:P,textSizePx:n}).pipe(d(l),v(async e=>e)).subscribe(e=>{Q({selection:e.axisSelection,xAxisClassName:x,fullParams:e.fullParams,tickTextAlign:e.tickTextAlign,gridAxesSize:e.gridAxesSize,fullDataFormatter:e.fullDataFormatter,chartParams:e.chartParams,groupScale:e.groupScale,groupScaleDomain:e.groupScaleDomain,groupLabels:e.groupLabels,textReverseTransformWithRotate:e.textReverseTransformWithRotate,textSizePx:e.textSizePx}),K({selection:e.axisSelection,groupingLabelClassName:C,fullParams:e.fullParams,axisLabelAlign:e.axisLabelAlign,gridAxesSize:e.gridAxesSize,fullDataFormatter:e.fullDataFormatter,chartParams:e.chartParams,textReverseTransform:e.textReverseTransform})}),()=>{l.next(void 0)}},Z=6;function ee({selection:b,textClassName:k,fullParams:t,axisLabelAlign:A,gridAxesSize:m,fullDataFormatter:s,fullChartParams:f,textReverseTransform:R}){const g=t.tickPadding-t.labelOffset[0],c=t.tickPadding+t.labelOffset[1];let p=0,n=0;s.grid.groupAxis.position==="bottom"?(n=-c,s.grid.valueAxis.position==="left"?p=-g:s.grid.valueAxis.position==="right"&&(p=g)):s.grid.groupAxis.position==="top"?(n=c,s.grid.valueAxis.position==="left"?p=-g:s.grid.valueAxis.position==="right"&&(p=g)):s.grid.groupAxis.position==="left"?(p=g,s.grid.valueAxis.position==="bottom"?n=c:s.grid.valueAxis.position==="top"&&(n=-c)):s.grid.groupAxis.position==="right"&&(p=-g,s.grid.valueAxis.position==="bottom"?n=c:s.grid.valueAxis.position==="top"&&(n=-c)),b.selectAll(`g.${k}`).data([t]).join("g").classed(k,!0).each((l,u,y)=>{W(y[u]).selectAll("text").data([l]).join(x=>x.append("text").style("font-weight","bold"),x=>x,x=>x.remove()).attr("text-anchor",A.textAnchor).attr("dominant-baseline",A.dominantBaseline).attr("font-size",f.styles.textSize).style("fill",D(t.labelColorType,f)).style("transform",R).attr("x",p).attr("y",n).text(x=>s.grid.valueAxis.label)}).attr("transform",l=>`translate(0, ${m.height})`)}function ie({selection:b,yAxisClassName:k,fullParams:t,tickTextAlign:A,gridAxesSize:m,fullDataFormatter:s,fullChartParams:f,valueScale:R,textReverseTransformWithRotate:g,minAndMax:c}){const p=b.selectAll(`g.${k}`).data([t]).join("g").classed(k,!0),n=c[1]-c[0];let l=0,u=0;s.grid.valueAxis.position==="left"?(l=t.tickPadding,u=0):s.grid.valueAxis.position==="right"?(l=-t.tickPadding,u=0):s.grid.valueAxis.position==="bottom"?(l=0,u=t.tickPadding):s.grid.valueAxis.position==="top"&&(l=0,u=-t.tickPadding);const y=N(R).scale(R).ticks(n>t.ticks?t.ticks:c[0]===0&&c[1]===0?1:Math.ceil(n)).tickFormat($=>E($,t.tickFormat)).tickSize(t.tickFullLine==!0?-m.width:Z).tickPadding(l),x=p.transition().duration(100).call(y);x.selectAll("line").style("fill","none").style("stroke",t.tickLineVisible==!0?D(t.tickColorType,f):"none").style("stroke-dasharray",t.tickFullLineDasharray).attr("pointer-events","none"),x.selectAll("path").style("fill","none").style("stroke",t.axisLineVisible==!0?D(t.axisLineColorType,f):"none").style("shape-rendering","crispEdges");const C=p.selectAll("text").attr("font-size",f.styles.textSize).style("color",D(t.tickTextColorType,f)).attr("text-anchor",A.textAnchor).attr("dominant-baseline",A.dominantBaseline).attr("y",u);return C.style("transform",g),(s.grid.valueAxis.position==="bottom"||s.grid.valueAxis.position==="top")&&C.attr("dy",0),p}const le=(b,{selection:k,computedData$:t,fullParams$:A,fullDataFormatter$:m,fullChartParams$:s,gridAxesTransform$:f,gridAxesReverseTransform$:R,gridAxesSize$:g,gridContainerPosition$:c,isSeriesSeprate$:p})=>{const n=new G,l=z(b,"container"),u=z(b,"yAxisG"),y=z(b,"yAxis"),x=z(b,"text"),C=h({computedData:t.pipe(w((i,o)=>i.length===o.length)),isSeriesSeprate:p}).pipe(d(n),v(async i=>i),S(i=>i.isSeriesSeprate?i.computedData:[i.computedData[0]]),S((i,o)=>k.selectAll(`g.${l}`).data(i,e=>e[0]?e[0].seriesIndex:o).join("g").classed(l,!0))),$=C.pipe(d(n),S((i,o)=>i.selectAll(`g.${u}`).data([u]).join("g").classed(u,!0)));h({containerSelection:C,gridContainerPosition:c}).pipe(d(n),v(async i=>i)).subscribe(i=>{i.containerSelection.attr("transform",(o,e)=>{const r=i.gridContainerPosition[e]??i.gridContainerPosition[0],a=r.translate,T=r.scale;return`translate(${a[0]}, ${a[1]}) scale(${T[0]}, ${T[1]})`})}),h({axisSelection:$,gridAxesTransform:f}).pipe(d(n),v(async i=>i)).subscribe(i=>{i.axisSelection.style("transform",i.gridAxesTransform.value)});const V=h({gridAxesReverseTransform:R,gridContainerPosition:c}).pipe(d(n),v(async i=>i),S(i=>{const o=`rotateX(${i.gridAxesReverseTransform.rotateX}deg) rotateY(${i.gridAxesReverseTransform.rotateY}deg)`,e=`rotate(${i.gridAxesReverseTransform.rotate}deg)`,r=`scale(${1/i.gridContainerPosition[0].scale[0]}, ${1/i.gridContainerPosition[0].scale[1]})`;return`${o} ${e} ${r}`}),w()),M=h({textReverseTransform:V,fullParams:A}).pipe(d(n),v(async i=>i),S(i=>`${i.textReverseTransform} rotate(${i.fullParams.tickTextRotate}deg)`)),P=new O(i=>{h({fullDataFormatter:m,gridAxesSize:g,computedData:t}).pipe(d(n),v(async o=>o)).subscribe(o=>{const e=o.computedData[0]?o.computedData[0].length-1:0,r=o.fullDataFormatter.grid.groupAxis.scaleDomain[0]-o.fullDataFormatter.grid.groupAxis.scalePadding,a=o.fullDataFormatter.grid.groupAxis.scaleDomain[1]==="max"?e+o.fullDataFormatter.grid.groupAxis.scalePadding:o.fullDataFormatter.grid.groupAxis.scaleDomain[1]+o.fullDataFormatter.grid.groupAxis.scalePadding,T=o.computedData.map((B,te)=>B.filter((se,F)=>F>=r&&F<=a)),L=H(T.flat());L[0]===L[1]&&(L[0]=L[1]-1),i.next(L)})}),j=new O(i=>{h({fullDataFormatter:m,gridAxesSize:g,minAndMax:P}).pipe(d(n),v(async o=>o)).subscribe(o=>{const e=U({maxValue:o.minAndMax[1],minValue:o.minAndMax[0],axisWidth:o.gridAxesSize.height,scaleDomain:o.fullDataFormatter.grid.valueAxis.scaleDomain,scaleRange:o.fullDataFormatter.grid.valueAxis.scaleRange});i.next(e)})}),X=h({fullDataFormatter:m,fullParams:A}).pipe(d(n),v(async i=>i),S(i=>{let o="start",e="hanging";return i.fullDataFormatter.grid.valueAxis.position==="left"?(o="end",e="middle"):i.fullDataFormatter.grid.valueAxis.position==="right"?(o="start",e="middle"):i.fullDataFormatter.grid.valueAxis.position==="bottom"?(o=i.fullParams.tickTextRotate?"end":"middle",e="hanging"):i.fullDataFormatter.grid.valueAxis.position==="top"&&(o=i.fullParams.tickTextRotate?"start":"middle",e="auto"),{textAnchor:o,dominantBaseline:e}})),Y=m.pipe(d(n),S(i=>{let o="start",e="hanging";return i.grid.groupAxis.position==="bottom"?e="auto":i.grid.groupAxis.position==="top"?e="hanging":i.grid.groupAxis.position==="left"?o="start":i.grid.groupAxis.position==="right"&&(o="end"),i.grid.valueAxis.position==="left"?o="end":i.grid.valueAxis.position==="right"?o="start":i.grid.valueAxis.position==="bottom"?e="hanging":i.grid.valueAxis.position==="top"&&(e="auto"),{textAnchor:o,dominantBaseline:e}}));return h({axisSelection:$,fullParams:A,tickTextAlign:X,axisLabelAlign:Y,computedData:t,gridAxesSize:g,fullDataFormatter:m,fullChartParams:s,valueScale:j,textReverseTransform:V,textReverseTransformWithRotate:M,minAndMax:P}).pipe(d(n),v(async i=>i)).subscribe(i=>{ie({selection:i.axisSelection,yAxisClassName:y,fullParams:i.fullParams,tickTextAlign:i.tickTextAlign,gridAxesSize:i.gridAxesSize,fullDataFormatter:i.fullDataFormatter,fullChartParams:i.fullChartParams,valueScale:i.valueScale,textReverseTransformWithRotate:i.textReverseTransformWithRotate,minAndMax:i.minAndMax}),ee({selection:i.axisSelection,textClassName:x,fullParams:i.fullParams,axisLabelAlign:i.axisLabelAlign,gridAxesSize:i.gridAxesSize,fullDataFormatter:i.fullDataFormatter,fullChartParams:i.fullChartParams,textReverseTransform:i.textReverseTransform})}),()=>{n.next(void 0)}};export{re as a,le as c};
