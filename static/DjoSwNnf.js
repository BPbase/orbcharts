import{S as N,o as Q,m as f,d as A,k as P,t as m,l as y,s as M,b9 as R,ar as V,bn as Z,bb as ee,g as te}from"./ZOIXw5Nq.js";import{o as ie,p as re}from"./wO7_YHzT.js";import{f as se}from"./BbzAf_0F.js";function ne(i="curveLinear"){return Z().x(a=>a.axisX).y(a=>a.axisY).curve(ee[i])}function ae(i){let a=[[]],g=0;for(let l in i){if(i[l].visible==!1||i[l].value===void 0||i[l].value===null){a[g].length&&(g++,a[g]=[]);continue}a[g].push(i[l])}return a}function oe({selection:i,pathClassName:a,segmentData:g,linePath:l,params:o}){return i.selectAll("path").data(g,(s,c)=>s.length?`${s[0].id}_${s[s.length-1].id}`:c).join(s=>s.append("path").classed(a,!0).attr("fill","none").attr("pointer-events","visibleStroke").style("vector-effect","non-scaling-stroke").style("cursor","pointer"),s=>s,s=>s.remove()).attr("stroke-width",o.lineWidth).attr("stroke",(s,c)=>s[0]&&s[0].color).attr("d",s=>l(s))}function ge({selection:i,seriesLabel:a,fullChartParams:g}){if(i.interrupt("highlight"),!a){i.transition("highlight").duration(200).style("opacity",1);return}i.each((l,o,d)=>{l===a?M(d[o]).style("opacity",1):M(d[o]).style("opacity",g.styles.unhighlightedOpacity)})}function pe({defsSelection:i,clipPathData:a,transitionDuration:g,transitionEase:l}){i.selectAll("clipPath").data(a).join(o=>o.append("clipPath"),o=>o,o=>o.remove()).attr("id",o=>o.id).each((o,d,s)=>{M(s[d]).selectAll("rect").data([o]).join(c=>{const u=c.append("rect");return u.transition().duration(g).ease(R(l)).tween("tween",(v,E,x)=>w=>{const T=v.width*w;u.attr("x",0).attr("y",0).attr("width",I=>T).attr("height",I=>I.height)}),u},c=>c.attr("x",0).attr("y",0).attr("width",u=>u.width).attr("height",u=>u.height),c=>c.remove())})}const de=(i,{selection:a,computedData$:g,computedAxesData$:l,visibleComputedData$:o,visibleComputedAxesData$:d,seriesLabels$:s,SeriesDataMap$:c,GroupDataMap$:u,fullParams$:v,fullDataFormatter$:E,fullChartParams$:x,gridAxesTransform$:w,gridGraphicTransform$:T,gridAxesSize$:I,gridHighlight$:$,gridContainerPosition$:j,allContainerPosition$:z,layout$:O,event$:G})=>{const b=new N,C=Q(i,"clipPath-box"),B=te(i,"path"),{seriesSelection$:le,axesSelection$:ce,defsSelection$:H,graphicGSelection$:F}=ie({selection:a,pluginName:i,clipPathID:C,seriesLabels$:s,gridContainerPosition$:j,gridAxesTransform$:w,gridGraphicTransform$:T}),U=new V(e=>{const p=v.pipe(m(b)).subscribe(n=>{if(!n)return;const r=ne(n.lineCurve);e.next(r)});return()=>{p.unsubscribe()}}),W=x.pipe(f(e=>e.transitionDuration),A()),X=x.pipe(f(e=>e.transitionEase),A());P({defsSelection:H,seriesLabels:s,axisSize:I,transitionDuration:W,transitionEase:X}).pipe(m(b),y(async e=>e)).subscribe(e=>{const n=[{id:C,width:e.axisSize.width,height:e.axisSize.height}].concat(e.seriesLabels.map(r=>({id:`orbcharts__clipPath_${r}`,width:e.axisSize.width,height:e.axisSize.height})));pe({defsSelection:e.defsSelection,clipPathData:n,transitionDuration:e.transitionDuration,transitionEase:e.transitionEase})});const Y=g.pipe(f(e=>{const p=new Map;return e.flat().forEach(n=>p.set(n.id,n)),p})),q=re({fullDataFormatter$:E,gridAxesSize$:I,computedData$:g,fullChartParams$:x,gridContainerPosition$:z,layout$:O}),J=x.pipe(m(b),f(e=>e.highlightTarget),A()),K=P({graphicGSelection:F,visibleComputedAxesData:d,linePath:U,params:v}).pipe(m(b),y(async e=>e),f(e=>{let p=[];return e.graphicGSelection.each((n,r,h)=>{const S=ae(e.visibleComputedAxesData[r]??[]);p[r]=oe({selection:M(h[r]),pathClassName:B,linePath:e.linePath,segmentData:S,params:e.params})}),p}));return P({pathSelectionArr:K,computedData:g,SeriesDataMap:c,GroupDataMap:u,highlightTarget:J,gridGroupPositionFn:q}).pipe(m(b),y(async e=>e)).subscribe(e=>{e.pathSelectionArr.forEach(p=>{p.on("mouseover",(n,r)=>{const h=r[0]?r[0].seriesLabel:"",{groupIndex:S,groupLabel:D}=e.gridGroupPositionFn(n),t=e.GroupDataMap.get(D).find(L=>L.seriesLabel===h)??r[0];G.next({type:"grid",eventName:"mouseover",pluginName:i,highlightTarget:e.highlightTarget,datum:t,gridIndex:t.gridIndex,series:e.SeriesDataMap.get(t.seriesLabel),seriesIndex:t.seriesIndex,seriesLabel:t.seriesLabel,group:e.GroupDataMap.get(t.groupLabel),groupIndex:t.groupIndex,groupLabel:t.groupLabel,event:n,data:e.computedData})}).on("mousemove",(n,r)=>{const h=r[0]?r[0].seriesLabel:"",{groupIndex:S,groupLabel:D}=e.gridGroupPositionFn(n),t=e.GroupDataMap.get(D).find(L=>L.seriesLabel===h)??r[0];G.next({type:"grid",eventName:"mousemove",pluginName:i,highlightTarget:e.highlightTarget,datum:t,gridIndex:t.gridIndex,series:e.SeriesDataMap.get(t.seriesLabel),seriesIndex:t.seriesIndex,seriesLabel:t.seriesLabel,group:e.GroupDataMap.get(t.groupLabel),groupIndex:t.groupIndex,groupLabel:t.groupLabel,event:n,data:e.computedData})}).on("mouseout",(n,r)=>{const h=r[0]?r[0].seriesLabel:"",{groupIndex:S,groupLabel:D}=e.gridGroupPositionFn(n),t=e.GroupDataMap.get(D).find(L=>L.seriesLabel===h)??r[0];G.next({type:"grid",eventName:"mouseout",pluginName:i,highlightTarget:e.highlightTarget,datum:t,gridIndex:t.gridIndex,series:e.SeriesDataMap.get(t.seriesLabel),seriesIndex:t.seriesIndex,seriesLabel:t.seriesLabel,group:e.GroupDataMap.get(t.groupLabel),groupIndex:t.groupIndex,groupLabel:t.groupLabel,event:n,data:e.computedData})}).on("click",(n,r)=>{const h=r[0]?r[0].seriesLabel:"",{groupIndex:S,groupLabel:D}=e.gridGroupPositionFn(n),t=e.GroupDataMap.get(D).find(L=>L.seriesLabel===h)??r[0];G.next({type:"grid",eventName:"click",pluginName:i,highlightTarget:e.highlightTarget,datum:t,gridIndex:t.gridIndex,series:e.SeriesDataMap.get(t.seriesLabel),seriesIndex:t.seriesIndex,seriesLabel:t.seriesLabel,group:e.GroupDataMap.get(t.groupLabel),groupIndex:t.groupIndex,groupLabel:t.groupLabel,event:n,data:e.computedData})})})}),x.pipe(m(b),se(e=>e.highlightTarget==="series"),y(e=>P({graphicGSelection:F,gridHighlight:$,DataMap:Y,fullChartParams:x}).pipe(m(b),y(async p=>p)))).subscribe(e=>{const p=e.gridHighlight[0]?e.gridHighlight[0].seriesLabel:null;ge({selection:e.graphicGSelection,seriesLabel:p,fullChartParams:e.fullChartParams})}),()=>{b.next(void 0)}};export{de as c};
