import{S as $,m as l,bi as D,k as r,t as M,l as y,bj as A,ar as j,bl as v}from"./ZOIXw5Nq.js";const V=(F,{rootSelection:X,dataFormatter$:f,fullDataFormatter$:c,xyMinMax$:u,layout$:k})=>{const m=new $;let s={k:1,x:0,y:0};const p=c.pipe(l(i=>i.xAxis),D()),S=c.pipe(l(i=>i.yAxis),D()),b=new j(i=>{r({initXAxis:p,layout:k,xyMinMax:u}).pipe(M(m),y(async n=>n)).subscribe(n=>{const e=v({maxValue:n.xyMinMax.maxX,minValue:n.xyMinMax.minX,axisWidth:n.layout.width,scaleDomain:n.initXAxis.scaleDomain,scaleRange:n.initXAxis.scaleRange});i.next(e)})}),Y=r({initXAxis:p,initYAxis:S,xyMinMax:u}).pipe(M(m),y(async i=>i),l(i=>{let n=i.xyMinMax.minX,e=i.xyMinMax.maxX,t=i.xyMinMax.minY,o=i.xyMinMax.maxY;return i.initXAxis.scaleDomain[0]==="auto"&&n>0&&(n=0),i.initXAxis.scaleDomain[1]==="auto"&&e<0&&(e=0),i.initYAxis.scaleDomain[0]==="auto"&&t>0&&(t=0),i.initYAxis.scaleDomain[1]==="auto"&&o<0&&(o=0),{minX:n,maxX:e,minY:t,maxY:o}}));return r({initXScale:b,fullDataFormatter:c,minMaxScaleDomain:Y}).pipe(M(m),y(async i=>i)).subscribe(i=>{const n=i.initXScale.copy(),e=A().on("zoom",function(o){const a=o.transform,h=z=>{const g=Math.round(z);return Math.min(i.minMaxScaleDomain.maxX,Math.max(i.minMaxScaleDomain.minX,g))},x=a.rescaleX(n).domain().map(h);x[0]<=i.minMaxScaleDomain.minX&&x[1]>=i.minMaxScaleDomain.maxX?a.k<s.k&&(a.k=s.k,a.x=s.x,a.y=s.y):x[1]-x[0]<=1&&a.k>s.k&&(a.k=s.k,a.x=s.x,a.y=s.y),s.k=a.k,s.x=a.x,s.y=a.y;const w={...i.fullDataFormatter,xAxis:{...i.fullDataFormatter.xAxis,scaleDomain:x}};f.next(w)});X.call(e)}),()=>{m.next(void 0),X.call(A().on("zoom",null))}};export{V as c};
