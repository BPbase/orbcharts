import{n as ie,u as re,q as se,o as ne,c as oe}from"./Cn0m7fL-.js";import{E as le,f as $t,D as ue,a as ce,S as W}from"./CdJnNJ0s.js";import{c as pe,g as ge,a as me,b as de,d as fe,e as xe,D as he,f as Ae,h as De,i as $e,j as ye,k as Te,G as I,l as k}from"./DOvFTFAM.js";import{D as Yt,s as Se,S as Pe,c as be,a as Le,d as Ee,m as Et,o as _t,t as Ft,b as B,h as _e,e as Fe,g as Re,A as Ie,f as Rt,i as it,k as X,l as T,n as ke,p as Me,q as ve,_ as Ce,r as Ne,O as V,u as Oe,v as Ge,w as ze,x as w,y as h,z,B as P,C as b,E as H,Q as q,U as Zt,F as yt,G as qt,H as we,I as Be,J as Jt}from"./DXLUV_DG.js";import{g as Ue,f as dt,c as He,L as J}from"./BKkaBTQr.js";import{c as Xe,P as It,a as Ve,b as je,d as We,e as Ye,B as j,f as st,g as nt,h as ot,i as Ze,j as qe,k as Je,l as Qe,m as Ke,n as ta,o as ea,p as aa,q as ia,r as ra}from"./C2JMP1Q4.js";import{B as lt}from"./Dh9GyvjI.js";import{B as ut}from"./Ck9tffu_.js";import{g as sa,a as ft,b as R,c as N,d as na,p as rt,e as Qt,f as oa,h as la,z as ua,m as ca,i as pa,j as ga,k as kt,l as ma,n as Mt}from"./CSQ6-baw.js";import{B as vt}from"./CHp1cen1.js";import{m as da,S as Y,P as tt}from"./CtKtqDbs.js";const fa=({data:o=[],dataFormatter:i,chartParams:e,layout:n})=>{if(!o.length)return[];let s=[];try{const g=Object.assign({},Yt.multiGrid[0]);s=o.map((u,l)=>{const r=i.multiGrid[l]||g;return pe({data:u,dataFormatter:r,chartParams:e,layout:n},"multiGrid",l)});let c=-1;s=s.map((u,l)=>u.map((r,m)=>(c++,r.map(a=>(a.accSeriesIndex=c,a.color=Se(c,e),a)))))}catch(g){throw Error(g)}return s},xa=({fullDataFormatter$:o,computedData$:i,layout$:e,fullChartParams$:n,event$:s})=>{const g=new Pe;return be({fullDataFormatter:o,computedData:i}).pipe(Le(async c=>c),Ee((c,u)=>c.computedData.length===u.computedData.length),Et(c=>(g.next(void 0),c.computedData.map((u,l)=>{const r=c.fullDataFormatter.multiGrid[l]??c.fullDataFormatter.multiGrid[0],m=_t(r).pipe(Ft(g),B(1)),a=_t(u).pipe(Ft(g),B(1)),t=ge({fullDataFormatter$:m,layout$:e}).pipe(B(1)),p=me({computedData$:a,fullDataFormatter$:m,layout$:e}).pipe(B(1)),f=de({gridAxesTransform$:t}).pipe(B(1)),d=fe({fullDataFormatter$:m,layout$:e}).pipe(B(1)),D=a.pipe(Et(F=>F.flat())).pipe(B(1)),y=_e({datumList$:D,fullChartParams$:n,event$:s}).pipe(B(1)),$=Fe({datumList$:D}).pipe(B(1)),L=Re({datumList$:D}).pipe(B(1)),A=xe({computedData$:a}).pipe(B(1));return{gridAxesTransform$:t,gridGraphicTransform$:p,gridAxesOppositeTransform$:f,gridAxesSize$:d,gridHighlight$:y,SeriesDataMap$:$,GroupDataMap$:L,visibleComputedData$:A}}))))},ha=({subject:o,observer:i})=>{const e=xa({fullDataFormatter$:i.fullDataFormatter$,computedData$:i.computedData$,layout$:i.layout$,fullChartParams$:i.fullChartParams$,event$:o.event$}).pipe(B(1));return{fullParams$:i.fullParams$,fullChartParams$:i.fullChartParams$,fullDataFormatter$:i.fullDataFormatter$,computedData$:i.computedData$,layout$:i.layout$,multiGrid$:e}};class Aa extends Ie{constructor(i,e){super({defaultDataFormatter:Yt,computedDataFn:fa,contextObserverFn:ha},i,e)}}function Da(o,i,e,n,s,g,c,u){var l=[],r=0,m=0,a=!1,t=function(){a&&!l.length&&!r&&i.complete()},p=function(d){return r<n?f(d):l.push(d)},f=function(d){r++;var D=!1;it(e(d,m++)).subscribe(Rt(i,function(y){i.next(y)},function(){D=!0},void 0,function(){if(D)try{r--;for(var y=function(){var $=l.shift();c||f($)};l.length&&r<n;)y();t()}catch($){i.error($)}}))};return o.subscribe(Rt(i,p,function(){a=!0,t()})),function(){}}function Tt(o,i,e){return e===void 0&&(e=1/0),X(i)?Tt(function(n,s){return T(function(g,c){return i(n,g,s,c)})(it(o(n,s)))},e):(typeof i=="number"&&(e=i),ke(function(n,s){return Da(n,s,o,e)}))}function $a(o){return o===void 0&&(o=1/0),Tt(Me,o)}var ya=["addListener","removeListener"],Ta=["addEventListener","removeEventListener"],Sa=["on","off"];function xt(o,i,e,n){if(X(e)&&(n=e,e=void 0),n)return xt(o,i,e).pipe(ve(n));var s=Ce(La(o)?Ta.map(function(u){return function(l){return o[u](i,l,e)}}):Pa(o)?ya.map(Ct(o,i)):ba(o)?Sa.map(Ct(o,i)):[],2),g=s[0],c=s[1];if(!g&&Ne(o))return Tt(function(u){return xt(u,i,e)})(it(o));if(!g)throw new TypeError("Invalid event target");return new V(function(u){var l=function(){for(var r=[],m=0;m<arguments.length;m++)r[m]=arguments[m];return u.next(1<r.length?r:r[0])};return g(l),function(){return c(l)}})}function Ct(o,i){return function(e){return function(n){return o[e](i,n)}}}function Pa(o){return X(o.addListener)&&X(o.removeListener)}function ba(o){return X(o.on)&&X(o.off)}function La(o){return X(o.addEventListener)&&X(o.removeEventListener)}function ht(){for(var o=[],i=0;i<arguments.length;i++)o[i]=arguments[i];var e=Oe(o),n=Ge(o,1/0),s=o;return s.length?s.length===1?it(s[0]):$a(n)(ze(s,e)):le}const Kt="Dots",Ea=R(Kt,"g"),_a=R(Kt,"circle");function Fa({selection:o,data:i,fullParams:e,fullChartParams:n,graphicOppositeScale:s}){const g=l=>{const r=l.size();return n.transitionDuration/r};let c=0;return o.selectAll("g").data(i,l=>l.id).join(l=>(c=g(l),l.append("g").classed(Ea,!0)),l=>l,l=>l.remove()).attr("transform",l=>`translate(${l.axisX}, ${l.axisY})`).each((l,r,m)=>{H(m[r]).selectAll("circle").data([l]).join(a=>a.append("circle").style("cursor","pointer").style("vector-effect","non-scaling-stroke").classed(_a,!0).attr("opacity",0).transition().delay((t,p)=>r*c).attr("opacity",1),a=>a.transition().duration(50).attr("opacity",1),a=>a.remove()).attr("r",e.radius).attr("fill",(a,t)=>ft({datum:a,colorType:e.fillColorType,fullChartParams:n})).attr("stroke",(a,t)=>ft({datum:a,colorType:e.strokeColorType,fullChartParams:n})).attr("stroke-width",e.strokeWidth).attr("transform",`scale(${s[0]}, ${s[1]})`)})}function Ra({selection:o,ids:i,onlyShowHighlighted:e,fullChartParams:n}){if(o.interrupt("highlight"),!i.length){o.transition("highlight").duration(200).style("opacity",e===!0?0:1);return}o.each((s,g,c)=>{i.includes(s.id)?H(c[g]).style("opacity",1).transition("highlight").duration(200):H(c[g]).style("opacity",e===!0?0:n.styles.unhighlightedOpacity).transition("highlight").duration(200)})}function Ia({defsSelection:o,clipPathData:i}){o.selectAll("clipPath").data(i).join(e=>e.append("clipPath"),e=>e,e=>e.remove()).attr("id",e=>e.id).each((e,n,s)=>{H(s[n]).selectAll("rect").data([e]).join("rect").attr("x",0).attr("y",0).attr("width",g=>g.width).attr("height",g=>g.height)})}const ka=(o,{selection:i,computedData$:e,visibleComputedData$:n,SeriesDataMap$:s,GroupDataMap$:g,fullParams$:c,fullChartParams$:u,gridAxesTransform$:l,gridGraphicTransform$:r,gridAxesSize$:m,gridHighlight$:a,event$:t})=>{const p=new w,f=sa(o,"clipPath-box"),d=i.append("g").attr("clip-path",`url(#${f})`),D=d.append("defs"),y=d.append("g"),$=new w;l.pipe(h(p),T(x=>x.value),z()).subscribe(x=>{d.style("transform",x)}),r.pipe(h(p),P(async x=>x.value),z()).subscribe(x=>{y.transition().duration(50).style("transform",x)});const L=r.pipe(h(p),T(x=>[1/x.scale[0],1/x.scale[1]]));m.pipe(h(p),P(async x=>x)).subscribe(x=>{const O=[{id:f,width:x.width,height:x.height}];Ia({defsSelection:D,clipPathData:O})});const A=u.pipe(h(p),T(x=>x.highlightTarget),z());b({computedData:e,visibleComputedData:n,SeriesDataMap:s,GroupDataMap:g,graphicOppositeScale:L,fullChartParams:u,fullParams:c,highlightTarget:A}).pipe(h(p),P(async x=>x)).subscribe(x=>{const O=Fa({selection:y,data:x.visibleComputedData.flat(),fullParams:x.fullParams,fullChartParams:x.fullChartParams,graphicOppositeScale:x.graphicOppositeScale});O.on("mouseover",(U,S)=>{U.stopPropagation(),t.next({type:"grid",eventName:"mouseover",pluginName:o,highlightTarget:x.highlightTarget,datum:S,series:x.SeriesDataMap.get(S.seriesLabel),seriesIndex:S.seriesIndex,seriesLabel:S.seriesLabel,groups:x.GroupDataMap.get(S.groupLabel),groupIndex:S.groupIndex,groupLabel:S.groupLabel,event:U,data:x.computedData})}).on("mousemove",(U,S)=>{U.stopPropagation(),t.next({type:"grid",eventName:"mousemove",pluginName:o,highlightTarget:x.highlightTarget,data:x.computedData,datum:S,series:x.SeriesDataMap.get(S.seriesLabel),seriesIndex:S.seriesIndex,seriesLabel:S.seriesLabel,groups:x.GroupDataMap.get(S.groupLabel),groupIndex:S.groupIndex,groupLabel:S.groupLabel,event:U})}).on("mouseout",(U,S)=>{U.stopPropagation(),t.next({type:"grid",eventName:"mouseout",pluginName:o,highlightTarget:x.highlightTarget,datum:S,series:x.SeriesDataMap.get(S.seriesLabel),seriesIndex:S.seriesIndex,seriesLabel:S.seriesLabel,groups:x.GroupDataMap.get(S.groupLabel),groupIndex:S.groupIndex,groupLabel:S.groupLabel,event:U,data:x.computedData})}).on("click",(U,S)=>{U.stopPropagation(),t.next({type:"grid",eventName:"click",pluginName:o,highlightTarget:x.highlightTarget,datum:S,series:x.SeriesDataMap.get(S.seriesLabel),seriesIndex:S.seriesIndex,seriesLabel:S.seriesLabel,groups:x.GroupDataMap.get(S.groupLabel),groupIndex:S.groupIndex,groupLabel:S.groupLabel,event:U,data:x.computedData})}),$.next(O)});const F=a.subscribe(),_=c.pipe(h(p),T(x=>x.onlyShowHighlighted),z());return u.pipe(h(p),P(x=>b({graphicSelection:$,highlight:a,onlyShowHighlighted:_,fullChartParams:u}).pipe(h(p),P(async O=>O)))).subscribe(x=>{Ra({selection:x.graphicSelection,ids:x.highlight,onlyShowHighlighted:x.onlyShowHighlighted,fullChartParams:x.fullChartParams})}),()=>{p.next(void 0),F.unsubscribe()}},Nt="Dots",Q=q(Nt,he)(({selection:o,name:i,subject:e,observer:n})=>{const s=new w,g=ka(Nt,{selection:o,computedData$:n.computedData$,visibleComputedData$:n.visibleComputedData$,SeriesDataMap$:n.SeriesDataMap$,GroupDataMap$:n.GroupDataMap$,fullParams$:n.fullParams$,fullChartParams$:n.fullChartParams$,gridAxesTransform$:n.gridAxesTransform$,gridGraphicTransform$:n.gridGraphicTransform$,gridAxesSize$:n.gridAxesSize$,gridHighlight$:n.gridHighlight$,event$:e.event$});return()=>{s.next(void 0),g()}}),St="GroupAxis",Ot=R(St,"xAxis"),Gt=R(St,"groupingLabel"),ct=6;function Ma({selection:o,params:i,tickTextAlign:e,axisLabelAlign:n,gridAxesSize:s,fullDataFormatter:g,chartParams:c,groupScale:u,contentTransform:l}){const r=o.selectAll(`g.${Ot}`).data([i]).join("g").classed(Ot,!0);o.selectAll(`g.${Gt}`).data([i]).join("g").classed(Gt,!0).each((t,p,f)=>{H(f[p]).selectAll("text").data([t]).join(d=>d.append("text").style("font-weight","bold"),d=>d,d=>d.remove()).attr("text-anchor",n.textAnchor).attr("dominant-baseline",n.dominantBaseline).style("font-size",`${c.styles.textSize}px`).style("fill",N(i.labelColorType,c)).style("transform",l).text(d=>g.groupAxis.label)}).attr("transform",t=>`translate(${s.width+t.tickPadding+i.labelOffset[0]}, ${-t.tickPadding-ct-i.labelOffset[1]})`);const m=na(u).scale(u).tickSize(i.tickFullLine==!0?-s.height:ct).tickSizeOuter(0).tickFormat(t=>rt(t,i.tickFormat)).tickPadding(i.tickPadding),a=r.transition().duration(100).call(m);return a.selectAll("line").style("fill","none").style("stroke",i.tickLineVisible==!0?N(i.tickColorType,c):"none").style("stroke-dasharray",i.tickFullLineDasharray).attr("pointer-events","none"),a.selectAll("path").style("fill","none").style("stroke",i.axisLineVisible==!0?N(i.axisLineColorType,c):"none").style("shape-rendering","crispEdges"),r.selectAll("text").style("font-family","sans-serif").style("font-size",`${c.styles.textSize}px`).style("color",N(i.tickTextColorType,c)).attr("text-anchor",e.textAnchor).attr("dominant-baseline",e.dominantBaseline).attr("transform-origin",`0 -${i.tickPadding+ct}`).style("transform",l),r}const M=q(St,Ae)(({selection:o,name:i,observer:e,subject:n})=>{const s=new w,g=o.append("g");e.gridAxesTransform$.pipe(h(s),T(m=>m.value),z()).subscribe(m=>{g.style("transform",m).attr("opacity",0).transition().attr("opacity",1)});const c=b({fullParams:e.fullParams$,gridAxesOppositeTransform:e.gridAxesOppositeTransform$}).pipe(h(s),P(async m=>{const a=m.gridAxesOppositeTransform.rotate+m.fullParams.tickTextRotate;return`translate(${m.gridAxesOppositeTransform.translate[0]}px, ${m.gridAxesOppositeTransform.translate[1]}px) rotate(${a}deg) rotateX(${m.gridAxesOppositeTransform.rotateX}deg) rotateY(${m.gridAxesOppositeTransform.rotateY}deg)`}),z()),u=new V(m=>{b({fullDataFormatter:e.fullDataFormatter$,gridAxesSize:e.gridAxesSize$,computedData:e.computedData$}).pipe(h(s),P(async a=>a)).subscribe(a=>{const p=a.computedData[0]?a.computedData[0].length-1:0,f=a.fullDataFormatter.groupAxis.scaleDomain[0]==="auto"?0-a.fullDataFormatter.groupAxis.scalePadding:a.fullDataFormatter.groupAxis.scaleDomain[0]-a.fullDataFormatter.groupAxis.scalePadding,d=a.fullDataFormatter.groupAxis.scaleDomain[1]==="auto"?p+a.fullDataFormatter.groupAxis.scalePadding:a.fullDataFormatter.groupAxis.scaleDomain[1]+a.fullDataFormatter.groupAxis.scalePadding,D=a.computedData[0]?a.computedData[0].length:0;let y=a.fullDataFormatter.grid.seriesType==="row"?(a.computedData[0]??[]).map(F=>F.groupLabel):a.computedData.map(F=>F[0].groupLabel);const $=new Array(D).fill(0).map((F,_)=>y[_]!=null?y[_]:String(_)).filter((F,_)=>_>=f&&_<=d),L=a.fullDataFormatter.groupAxis.scalePadding,A=Zt({axisLabels:$,axisWidth:a.gridAxesSize.width,padding:L});m.next(A)})}),l=e.fullDataFormatter$.pipe(h(s),T(m=>{let a="middle",t="hanging";return m.groupAxis.position==="bottom"?(a="middle",t="hanging"):m.groupAxis.position==="top"?(a="middle",t="auto"):m.groupAxis.position==="left"?(a="end",t="middle"):m.groupAxis.position==="right"&&(a="start",t="middle"),{textAnchor:a,dominantBaseline:t}})),r=e.fullDataFormatter$.pipe(h(s),T(m=>{let a="start",t="hanging";return m.groupAxis.position==="bottom"?t="hanging":m.groupAxis.position==="top"?t="auto":m.groupAxis.position==="left"?a="end":m.groupAxis.position==="right"&&(a="start"),m.valueAxis.position==="left"?a="start":m.valueAxis.position==="right"?a="end":m.valueAxis.position==="bottom"?t="auto":m.valueAxis.position==="top"&&(t="hanging"),{textAnchor:a,dominantBaseline:t}}));return b({params:e.fullParams$,tickTextAlign:l,axisLabelAlign:r,gridAxesSize:e.gridAxesSize$,fullDataFormatter:e.fullDataFormatter$,chartParams:e.fullChartParams$,groupScale:u,contentTransform:c}).pipe(h(s),P(async m=>m)).subscribe(m=>{Ma({selection:g,params:m.params,tickTextAlign:m.tickTextAlign,axisLabelAlign:m.axisLabelAlign,gridAxesSize:m.gridAxesSize,fullDataFormatter:m.fullDataFormatter,chartParams:m.chartParams,groupScale:m.groupScale,contentTransform:m.contentTransform})}),()=>{s.next(void 0)}}),Pt="ValueAxis",zt=R(Pt,"g"),wt=R(Pt,"text"),Bt=6;function va({selection:o,fullParams:i,tickTextAlign:e,axisLabelAlign:n,gridAxesSize:s,fullDataFormatter:g,fullChartParams:c,valueScale:u,contentTransform:l,minAndMax:r}){const m=o.selectAll(`g.${zt}`).data([i]).join("g").classed(zt,!0);o.selectAll(`g.${wt}`).data([i]).join("g").classed(wt,!0).each((d,D,y)=>{H(y[D]).selectAll("text").data([d]).join($=>$.append("text").style("font-weight","bold"),$=>$,$=>$.remove()).attr("text-anchor",n.textAnchor).attr("dominant-baseline",n.dominantBaseline).style("font-size",`${c.styles.textSize}px`).style("fill",N(i.labelColorType,c)).style("transform",l).text($=>g.valueAxis.label)}).attr("transform",d=>`translate(${-d.tickPadding+i.labelOffset[0]}, ${s.height+d.tickPadding+i.labelOffset[1]})`);const a=r[1]-r[0],t=Qt(u).scale(u).ticks(a>i.ticks?i.ticks:r[0]===0&&r[1]===0?1:Math.ceil(a)).tickFormat(d=>rt(d,i.tickFormat)).tickSize(i.tickFullLine==!0?-s.width:Bt).tickPadding(i.tickPadding),p=m.transition().duration(100).call(t);return p.selectAll("line").style("fill","none").style("stroke",i.tickLineVisible==!0?N(i.tickColorType,c):"none").style("stroke-dasharray",i.tickFullLineDasharray).attr("pointer-events","none"),p.selectAll("path").style("fill","none").style("stroke",i.axisLineVisible==!0?N(i.axisLineColorType,c):"none").style("shape-rendering","crispEdges"),m.selectAll("text").style("font-family","sans-serif").style("font-size",`${c.styles.textSize}px`).style("color",N(i.tickTextColorType,c)).attr("text-anchor",e.textAnchor).attr("dominant-baseline",e.dominantBaseline).attr("transform-origin",`-${i.tickPadding+Bt} 0`).style("transform",l),m}const G=q(Pt,De)(({selection:o,name:i,observer:e,subject:n})=>{const s=new w,g=o.append("g");e.gridAxesTransform$.pipe(h(s),T(a=>a.value),z()).subscribe(a=>{g.style("transform",a).attr("opacity",0).transition().attr("opacity",1)});const c=b({fullParams:e.fullParams$,gridAxesOppositeTransform:e.gridAxesOppositeTransform$}).pipe(h(s),P(async a=>{const t=a.gridAxesOppositeTransform.rotate+a.fullParams.tickTextRotate;return`translate(${a.gridAxesOppositeTransform.translate[0]}px, ${a.gridAxesOppositeTransform.translate[1]}px) rotate(${t}deg) rotateX(${a.gridAxesOppositeTransform.rotateX}deg) rotateY(${a.gridAxesOppositeTransform.rotateY}deg)`}),z()),u=new V(a=>{b({fullDataFormatter:e.fullDataFormatter$,gridAxesSize:e.gridAxesSize$,computedData:e.computedData$}).pipe(h(s),P(async t=>t)).subscribe(t=>{const f=t.computedData[0]?t.computedData[0].length-1:0,d=t.fullDataFormatter.groupAxis.scaleDomain[0]==="auto"?0-t.fullDataFormatter.groupAxis.scalePadding:t.fullDataFormatter.groupAxis.scaleDomain[0]-t.fullDataFormatter.groupAxis.scalePadding,D=t.fullDataFormatter.groupAxis.scaleDomain[1]==="auto"?f+t.fullDataFormatter.groupAxis.scalePadding:t.fullDataFormatter.groupAxis.scaleDomain[1]+t.fullDataFormatter.groupAxis.scalePadding,y=t.computedData.map((L,A)=>L.filter((F,_)=>_>=d&&_<=D)),$=oa(y.flat());a.next($)})}),l=new V(a=>{b({fullDataFormatter:e.fullDataFormatter$,gridAxesSize:e.gridAxesSize$,minAndMax:u}).pipe(h(s),P(async t=>t)).subscribe(t=>{const p=yt({maxValue:t.minAndMax[1],minValue:t.minAndMax[0],axisWidth:t.gridAxesSize.height,scaleDomain:t.fullDataFormatter.valueAxis.scaleDomain,scaleRange:t.fullDataFormatter.valueAxis.scaleRange});a.next(p)})}),r=e.fullDataFormatter$.pipe(h(s),T(a=>{let t="start",p="hanging";return a.valueAxis.position==="left"?(t="end",p="middle"):a.valueAxis.position==="right"?(t="start",p="middle"):a.valueAxis.position==="bottom"?(t="middle",p="hanging"):a.valueAxis.position==="top"&&(t="middle",p="auto"),{textAnchor:t,dominantBaseline:p}})),m=e.fullDataFormatter$.pipe(h(s),T(a=>{let t="start",p="hanging";return a.groupAxis.position==="bottom"?p="auto":a.groupAxis.position==="top"?p="hanging":a.groupAxis.position==="left"?t="start":a.groupAxis.position==="right"&&(t="end"),a.valueAxis.position==="left"?t="end":a.valueAxis.position==="right"?t="start":a.valueAxis.position==="bottom"?p="hanging":a.valueAxis.position==="top"&&(p="auto"),{textAnchor:t,dominantBaseline:p}}));return b({fullParams:e.fullParams$,tickTextAlign:r,axisLabelAlign:m,computedData:e.computedData$,gridAxesSize:e.gridAxesSize$,fullDataFormatter:e.fullDataFormatter$,fullChartParams:e.fullChartParams$,valueScale:l,contentTransform:c,minAndMax:u}).pipe(h(s),P(async a=>a)).subscribe(a=>{va({selection:g,fullParams:a.fullParams,tickTextAlign:a.tickTextAlign,axisLabelAlign:a.axisLabelAlign,gridAxesSize:a.gridAxesSize,fullDataFormatter:a.fullDataFormatter,fullChartParams:a.fullChartParams,valueScale:a.valueScale,contentTransform:a.contentTransform,minAndMax:a.minAndMax})}),()=>{s.next(void 0)}}),bt="ValueStackAxis",Ut=R(bt,"g"),Ht=R(bt,"text"),Xt=6;function Ca({selection:o,fullParams:i,tickTextAlign:e,axisLabelAlign:n,gridAxesSize:s,fullDataFormatter:g,fullChartParams:c,valueScale:u,contentTransform:l,minAndMax:r}){const m=o.selectAll(`g.${Ut}`).data([i]).join("g").classed(Ut,!0);o.selectAll(`g.${Ht}`).data([i]).join("g").classed(Ht,!0).each((d,D,y)=>{H(y[D]).selectAll("text").data([d]).join($=>$.append("text").style("font-weight","bold"),$=>$,$=>$.remove()).attr("text-anchor",n.textAnchor).attr("dominant-baseline",n.dominantBaseline).style("font-size",`${c.styles.textSize}px`).style("fill",N(i.labelColorType,c)).style("transform",l).text($=>g.valueAxis.label)}).attr("transform",d=>`translate(${-d.tickPadding+i.labelOffset[0]}, ${s.height+d.tickPadding+i.labelOffset[1]})`);const a=r[1]-r[0],t=Qt(u).scale(u).ticks(a>i.ticks?i.ticks:r[0]===0&&r[1]===0?1:Math.ceil(a)).tickFormat(d=>rt(d,i.tickFormat)).tickSize(i.tickFullLine==!0?-s.width:Xt).tickPadding(i.tickPadding),p=m.transition().duration(100).call(t);return p.selectAll("line").style("fill","none").style("stroke",i.tickLineVisible==!0?N(i.tickColorType,c):"none").style("stroke-dasharray",i.tickFullLineDasharray).attr("pointer-events","none"),p.selectAll("path").style("fill","none").style("stroke",i.axisLineVisible==!0?N(i.axisLineColorType,c):"none").style("shape-rendering","crispEdges"),m.selectAll("text").style("font-family","sans-serif").style("font-size",`${c.styles.textSize}px`).style("color",N(i.tickTextColorType,c)).attr("text-anchor",e.textAnchor).attr("dominant-baseline",e.dominantBaseline).attr("transform-origin",`-${i.tickPadding+Xt} 0`).style("transform",l),m}const pt=q(bt,$e)(({selection:o,name:i,observer:e,subject:n})=>{const s=new w,g=o.append("g");e.gridAxesTransform$.pipe(h(s),T(a=>a.value),z()).subscribe(a=>{g.style("transform",a).attr("opacity",0).transition().attr("opacity",1)});const c=b({fullParams:e.fullParams$,gridAxesOppositeTransform:e.gridAxesOppositeTransform$}).pipe(h(s),P(async a=>{const t=a.gridAxesOppositeTransform.rotate+a.fullParams.tickTextRotate;return`translate(${a.gridAxesOppositeTransform.translate[0]}px, ${a.gridAxesOppositeTransform.translate[1]}px) rotate(${t}deg) rotateX(${a.gridAxesOppositeTransform.rotateX}deg) rotateY(${a.gridAxesOppositeTransform.rotateY}deg)`}),z()),u=new V(a=>{b({fullDataFormatter:e.fullDataFormatter$,gridAxesSize:e.gridAxesSize$,computedData:e.computedData$}).pipe(h(s),P(async t=>t)).subscribe(t=>{const f=t.computedData[0]?t.computedData[0].length-1:0,d=t.fullDataFormatter.groupAxis.scaleDomain[0]==="auto"?0-t.fullDataFormatter.groupAxis.scalePadding:t.fullDataFormatter.groupAxis.scaleDomain[0]-t.fullDataFormatter.groupAxis.scalePadding,D=t.fullDataFormatter.groupAxis.scaleDomain[1]==="auto"?f+t.fullDataFormatter.groupAxis.scalePadding:t.fullDataFormatter.groupAxis.scaleDomain[1]+t.fullDataFormatter.groupAxis.scalePadding,y=t.computedData.map((A,F)=>A.filter((_,x)=>x>=d&&x<=D)),$=new Array(y[0]?y[0].length:0).fill(null).map((A,F)=>y.reduce((_,x)=>{if(x&&x[F]){const O=x[F].value==null||x[F].visible==!1?0:x[F].value;return _+O}return _},0)),L=la($);a.next(L)})}),l=new V(a=>{b({fullDataFormatter:e.fullDataFormatter$,gridAxesSize:e.gridAxesSize$,minAndMax:u}).pipe(h(s),P(async t=>t)).subscribe(t=>{const p=yt({maxValue:t.minAndMax[1],minValue:t.minAndMax[0],axisWidth:t.gridAxesSize.height,scaleDomain:t.fullDataFormatter.valueAxis.scaleDomain,scaleRange:t.fullDataFormatter.valueAxis.scaleRange});a.next(p)})}),r=e.fullDataFormatter$.pipe(h(s),T(a=>{let t="start",p="hanging";return a.valueAxis.position==="left"?(t="end",p="middle"):a.valueAxis.position==="right"?(t="start",p="middle"):a.valueAxis.position==="bottom"?(t="middle",p="hanging"):a.valueAxis.position==="top"&&(t="middle",p="auto"),{textAnchor:t,dominantBaseline:p}})),m=e.fullDataFormatter$.pipe(h(s),T(a=>{let t="start",p="hanging";return a.groupAxis.position==="bottom"?p="auto":a.groupAxis.position==="top"?p="hanging":a.groupAxis.position==="left"?t="start":a.groupAxis.position==="right"&&(t="end"),a.valueAxis.position==="left"?t="end":a.valueAxis.position==="right"?t="start":a.valueAxis.position==="bottom"?p="hanging":a.valueAxis.position==="top"&&(p="auto"),{textAnchor:t,dominantBaseline:p}}));return b({fullParams:e.fullParams$,tickTextAlign:r,axisLabelAlign:m,computedData:e.computedData$,gridAxesSize:e.gridAxesSize$,fullDataFormatter:e.fullDataFormatter$,fullChartParams:e.fullChartParams$,valueScale:l,contentTransform:c,minAndMax:u}).pipe(h(s),P(async a=>a)).subscribe(a=>{Ca({selection:g,fullParams:a.fullParams,tickTextAlign:a.tickTextAlign,axisLabelAlign:a.axisLabelAlign,gridAxesSize:a.gridAxesSize,fullDataFormatter:a.fullDataFormatter,fullChartParams:a.fullChartParams,valueScale:a.valueScale,contentTransform:a.contentTransform,minAndMax:a.minAndMax})}),()=>{s.next(void 0)}}),te="ScalingArea",Na=R(te,"rect"),v=q(te,ye)(({selection:o,rootSelection:i,name:e,observer:n,subject:s})=>{const g=new w,c=i.insert("rect","g").classed(Na,!0).attr("opacity",0);let u={k:1,x:0,y:0};n.layout$.pipe(h(g)).subscribe(r=>{c.attr("width",r.width).attr("height",r.height).attr("x",r.left).attr("y",r.top)});const l=n.computedData$.pipe(T(r=>r[0]?r[0].length-1:0),z());return b({initGroupAxis:n.fullDataFormatter$.pipe(T(r=>r.groupAxis),$t()),fullDataFormatter:n.fullDataFormatter$,groupMaxIndex:l,layout:n.layout$,axisSize:n.gridAxesSize$}).pipe(h(g),P(async r=>r)).subscribe(r=>{const a=r.groupMaxIndex,t=r.initGroupAxis.scaleDomain[0]==="auto"?0-r.initGroupAxis.scalePadding:r.initGroupAxis.scaleDomain[0]-r.initGroupAxis.scalePadding,p=r.initGroupAxis.scaleDomain[1]==="auto"?a+r.initGroupAxis.scalePadding:r.initGroupAxis.scaleDomain[1]+r.initGroupAxis.scalePadding,f=r.fullDataFormatter.valueAxis.position==="left"||r.fullDataFormatter.valueAxis.position==="top"?[0,1]:[1,0],D=yt({maxValue:r.groupMaxIndex,minValue:0,axisWidth:r.axisSize.width,scaleDomain:[t,p],scaleRange:f}).copy(),y=ua().on("zoom",function(L){const A=L.transform,F=x=>{const O=Math.round(x);return Math.min(a,Math.max(0,O))},_=r.fullDataFormatter.groupAxis.position==="bottom"||r.fullDataFormatter.groupAxis.position==="top"?A.rescaleX(D).domain().map(F):A.rescaleY(D).domain().map(F);_[0]<=0&&_[1]>=a?A.k<u.k&&(A.k=u.k,A.x=u.x,A.y=u.y):_[1]-_[0]<=1&&A.k>u.k&&(A.k=u.k,A.x=u.x,A.y=u.y),u.k=A.k,u.x=A.x,u.y=A.y,s.dataFormatter$.next({...r.fullDataFormatter,groupAxis:{...r.fullDataFormatter.groupAxis,scaleDomain:_}})});i.call(y)}),()=>{g.next(void 0),c.remove()}});function Oa(o,i){let e=new V(()=>{});return o.each(function(){const n=xt(this,i);e=ht(e,n)}),e}const At="GroupArea",Dt=R(At,"label-box");function Ga({groupLabel:o,axisX:i,axisHeight:e,fullParams:n}){return n.showLine&&o?[{id:o,x1:i,x2:i,y1:0,y2:e}]:[]}function za({selection:o,pluginName:i,lineData:e,fullParams:n,fullChartParams:s}){const g=R(i,"auxline"),c=o.selectAll(`line.${g}`).data(e),u=c.enter().append("line").classed(g,!0).style("stroke",r=>N(n.lineColorType,s)).style("stroke-width",1).style("stroke-dasharray",n.lineDashArray??"none").style("pointer-events","none"),l=c.merge(u);return c.exit().remove(),u.attr("x1",r=>r.x1).attr("y1",r=>r.y1).attr("x2",r=>r.x2).attr("y2",r=>r.y2),c.transition().duration(50).attr("x1",r=>r.x1).attr("y1",r=>r.y1).attr("x2",r=>r.x2).attr("y2",r=>r.y2),l}function wa(o){o.selectAll("line").data([]).exit().remove()}function Ba({groupLabel:o,axisX:i,fullParams:e}){return e.showLabel&&o?[{id:o,x:i,y:-e.labelPadding,text:rt(o,e.labelTextFormat)}]:[]}function Ua({selection:o,labelData:i,fullParams:e,fullChartParams:n,gridAxesOppositeTransformValue:s}){const g=n.styles.textSize+4,c=o.selectAll(`g.${Dt}`).data(i),u=c.enter().append("g").classed(Dt,!0).style("cursor","pointer"),l=u.merge(c);return u.attr("transform",(r,m)=>`translate(${r.x}, ${r.y})`),c.transition().duration(50).attr("transform",(r,m)=>`translate(${r.x}, ${r.y})`),c.exit().remove(),l.each((r,m,a)=>{const t=ca(r.text,n.styles.textSize)+12,p=-t/2,f=H(a[m]).selectAll("rect").data([r]),d=f.enter().append("rect").attr("height",`${g}px`).attr("fill",$=>N(e.labelColorType,n)).attr("x",p).attr("y",-2).attr("rx",5).attr("ry",5).style("cursor","pointer");f.merge(d).attr("width",$=>`${t}px`).style("transform",s),f.exit().remove();const D=H(a[m]).selectAll("text").data([r]),y=D.enter().append("text").style("dominant-baseline","hanging").style("cursor","pointer");D.merge(y).text($=>$.text).style("transform",s).attr("fill",$=>N(e.labelTextColorType,n)).attr("font-size",n.styles.textSize).attr("x",p+6),D.exit().remove()}),l}function Ha(o){o.selectAll(`g.${Dt}`).data([]).exit().remove()}const Xa=q(At,Te)(({selection:o,rootSelection:i,name:e,subject:n,observer:s})=>{const g=new w,c=i.insert("rect","g").classed(R(At,"rect"),!0).attr("opacity",0),u=o.append("g");s.layout$.pipe(h(g)).subscribe(t=>{c.attr("width",t.rootWidth).attr("height",t.rootHeight)}),s.gridAxesTransform$.pipe(h(g),T(t=>t.value),z()).subscribe(t=>{u.style("transform",t)});const l=new V(t=>{b({fullDataFormatter:s.fullDataFormatter$,gridAxesSize:s.gridAxesSize$,computedData:s.computedData$}).pipe(h(g),P(async p=>p)).subscribe(p=>{const d=p.computedData[0]?p.computedData[0].length-1:0,D=p.fullDataFormatter.groupAxis.scaleDomain[0]==="auto"?0-p.fullDataFormatter.groupAxis.scalePadding:p.fullDataFormatter.groupAxis.scaleDomain[0]-p.fullDataFormatter.groupAxis.scalePadding,y=p.fullDataFormatter.groupAxis.scaleDomain[1]==="auto"?d+p.fullDataFormatter.groupAxis.scalePadding:p.fullDataFormatter.groupAxis.scaleDomain[1]+p.fullDataFormatter.groupAxis.scalePadding,$=p.computedData[0]?p.computedData[0].length:0;let L=p.fullDataFormatter.grid.seriesType==="row"?(p.computedData[0]??[]).map(x=>x.groupLabel):p.computedData.map(x=>x[0].groupLabel);const A=new Array($).fill(0).map((x,O)=>L[O]!=null?L[O]:String(O)).filter((x,O)=>O>=D&&O<=y),F=p.fullDataFormatter.groupAxis.scalePadding,_=Zt({axisLabels:A,axisWidth:p.gridAxesSize.width,padding:F});t.next(_)})}),r=Ue({fullDataFormatter$:s.fullDataFormatter$,gridAxesSize$:s.gridAxesSize$,computedData$:s.computedData$,fullChartParams$:s.fullChartParams$}),m=s.fullChartParams$.pipe(h(g),T(t=>t.highlightTarget),z());return b({computedData:s.computedData$,gridAxesSize:s.gridAxesSize$,fullParams:s.fullParams$,fullChartParams:s.fullChartParams$,highlightTarget:m,SeriesDataMap:s.SeriesDataMap$,GroupDataMap:s.GroupDataMap$,gridGroupPositionFn:r,groupScale:l}).pipe(h(g),P(async t=>t)).subscribe(t=>{i.on("mouseover",(p,f)=>{const{groupIndex:d,groupLabel:D}=t.gridGroupPositionFn(p);n.event$.next({type:"grid",pluginName:e,eventName:"mouseover",highlightTarget:t.highlightTarget,datum:null,series:[],seriesIndex:-1,seriesLabel:"",groups:t.GroupDataMap.get(D)??[],groupIndex:d,groupLabel:D,event:p,data:t.computedData})}).on("mousemove",(p,f)=>{const{groupIndex:d,groupLabel:D}=t.gridGroupPositionFn(p);n.event$.next({type:"grid",pluginName:e,eventName:"mousemove",highlightTarget:t.highlightTarget,datum:null,series:[],seriesIndex:-1,seriesLabel:"",groups:t.GroupDataMap.get(D)??[],groupIndex:d,groupLabel:D,event:p,data:t.computedData})}).on("mouseout",(p,f)=>{const{groupIndex:d,groupLabel:D}=t.gridGroupPositionFn(p);n.event$.next({type:"grid",pluginName:e,eventName:"mouseout",highlightTarget:t.highlightTarget,datum:null,series:[],seriesIndex:-1,seriesLabel:"",groups:t.GroupDataMap.get(D)??[],groupIndex:d,groupLabel:D,event:p,data:t.computedData})}).on("click",(p,f)=>{p.stopPropagation();const{groupIndex:d,groupLabel:D}=t.gridGroupPositionFn(p);n.event$.next({type:"grid",pluginName:e,eventName:"click",highlightTarget:t.highlightTarget,datum:null,series:[],seriesIndex:-1,seriesLabel:"",groups:t.GroupDataMap.get(D)??[],groupIndex:d,groupLabel:D,event:p,data:t.computedData})})}),b({event:n.event$.pipe(dt(t=>t.eventName==="mouseover"||t.eventName==="mousemove")),computedData:s.computedData$,groupScale:l,gridAxesSize:s.gridAxesSize$,fullParams:s.fullParams$,fullChartParams:s.fullChartParams$,highlightTarget:m,gridAxesOppositeTransform:s.gridAxesOppositeTransform$,GroupDataMap:s.GroupDataMap$,gridGroupPositionFn:r}).pipe(h(g),P(async t=>t)).subscribe(t=>{const p=t.groupScale(t.event.groupLabel)??0,f=Ga({groupLabel:t.event.groupLabel,axisX:p,axisHeight:t.gridAxesSize.height,fullParams:t.fullParams});za({selection:u,pluginName:e,lineData:f,fullParams:t.fullParams,fullChartParams:t.fullChartParams});const d=Ba({groupLabel:t.event.groupLabel,axisX:p,fullParams:t.fullParams});Ua({selection:u,labelData:d,fullParams:t.fullParams,fullChartParams:t.fullChartParams,gridAxesOppositeTransformValue:t.gridAxesOppositeTransform.value}).on("mouseover",(y,$)=>{const{groupIndex:L,groupLabel:A}=t.gridGroupPositionFn(y);n.event$.next({type:"grid",pluginName:e,eventName:"mouseover",highlightTarget:t.highlightTarget,datum:null,series:[],seriesIndex:-1,seriesLabel:"",groups:t.event.groups,groupIndex:L,groupLabel:A,event:y,data:t.computedData})}).on("mousemove",(y,$)=>{const{groupIndex:L,groupLabel:A}=t.gridGroupPositionFn(y);n.event$.next({type:"grid",pluginName:e,eventName:"mousemove",highlightTarget:t.highlightTarget,datum:null,series:[],seriesIndex:-1,seriesLabel:"",groups:t.event.groups,groupIndex:L,groupLabel:A,event:y,data:t.computedData})}).on("mouseout",(y,$)=>{const{groupIndex:L,groupLabel:A}=t.gridGroupPositionFn(y);n.event$.next({type:"grid",pluginName:e,eventName:"mouseout",highlightTarget:t.highlightTarget,datum:null,series:[],seriesIndex:-1,seriesLabel:"",groups:t.event.groups,groupIndex:L,groupLabel:A,event:y,data:t.computedData})}).on("click",(y,$)=>{const{groupIndex:L,groupLabel:A}=t.gridGroupPositionFn(y);n.event$.next({type:"grid",pluginName:e,eventName:"click",highlightTarget:t.highlightTarget,datum:null,series:[],seriesIndex:-1,seriesLabel:"",groups:t.event.groups,groupIndex:L,groupLabel:A,event:y,data:t.computedData})})}),Oa(c,"mouseout").pipe(h(g)).subscribe(t=>{console.log("rootMouseout"),wa(u),Ha(u)}),()=>{g.next(void 0),c.remove()}}),Va={bars:{barWidth:0,barPadding:1,barGroupPadding:40,barRadius:!1},lines:{lineCurve:"curveLinear",lineWidth:2}},ja={position:"right",justify:"end",padding:28,backgroundFill:"none",backgroundStroke:"none",gap:10,listRectWidth:14,listRectHeight:14,listRectRadius:0,gridList:[{listRectWidth:14,listRectHeight:14,listRectRadius:0}]},Wa={position:"left",scaleDomain:[0,"auto"],scaleRange:[0,.9],label:""},Ya={position:"bottom",scaleDomain:[0,"auto"],scalePadding:.5,label:""},Za={type:"grid",visibleFilter:(o,i,e,n)=>!0,grid:{rowLabels:[],columnLabels:[],seriesType:"row"},valueAxis:{...Wa},groupAxis:{...Ya}},qa={type:"multiGrid",visibleFilter:(o,i,e,n)=>!0,multiGrid:[{...Za}]},K="BarsAndLines",Ja=R(K,"bars"),Qa=R(K,"lines"),Ka=qt(K,Va)(({selection:o,name:i,subject:e,observer:n})=>{const s=new w,g=o.append("g").attr("class",Ja),c=o.append("g").attr("class",Qa);let u=()=>{},l=()=>{};const r=n.computedData$.pipe(h(s),T(d=>d[0]||[])),m=n.computedData$.pipe(h(s),T(d=>d[1]||[])),a=n.fullParams$.pipe(h(s),T(d=>d.bars)),t=n.fullParams$.pipe(h(s),T(d=>d.lines)),p=n.fullDataFormatter$.pipe(h(s),T(d=>d.multiGrid[0]||qa.multiGrid[0])),f=b({fullDataFormatter:n.fullDataFormatter$,defaultFullDataFormatter:p}).pipe(h(s),T(d=>d.fullDataFormatter.multiGrid[1]??d.defaultFullDataFormatter));return n.multiGrid$.subscribe(d=>{d[0]?u=Xe(K,{selection:g,computedData$:r,visibleComputedData$:d[0].visibleComputedData$,SeriesDataMap$:d[0].SeriesDataMap$,GroupDataMap$:d[0].GroupDataMap$,fullParams$:a,fullChartParams$:n.fullChartParams$,gridAxesTransform$:d[0].gridAxesTransform$,gridGraphicTransform$:d[0].gridGraphicTransform$,gridAxesSize$:d[0].gridAxesSize$,gridHighlight$:d[0].gridHighlight$,event$:e.event$}):u(),d[1]?l=He(K,{selection:c,computedData$:m,SeriesDataMap$:d[1].SeriesDataMap$,GroupDataMap$:d[1].GroupDataMap$,fullParams$:t,fullDataFormatter$:f,fullChartParams$:n.fullChartParams$,gridAxesTransform$:d[1].gridAxesTransform$,gridGraphicTransform$:d[1].gridGraphicTransform$,gridAxesSize$:d[1].gridAxesSize$,gridHighlight$:d[1].gridHighlight$,event$:e.event$}):l()}),()=>{s.next(void 0),u(),l()}}),Vt="MultiGridLegend",ti=qt(Vt,ja)(({selection:o,rootSelection:i,observer:e,subject:n})=>{const s=new w,g=e.multiGrid$.pipe(h(s),T(r=>r.map((a,t)=>a.SeriesDataMap$.pipe(T(p=>Array.from(p.keys()))))),P(r=>b(r)),T(r=>r.flat())),c=b({fullParams:e.fullParams$,multiGrid:e.multiGrid$,computedData:e.computedData$}).pipe(h(s),P(async r=>r),T(r=>r.computedData.map((m,a)=>{const t=we(r.fullParams.gridList[a]??{},{listRectWidth:r.fullParams.listRectWidth,listRectHeight:r.fullParams.listRectHeight,listRectRadius:r.fullParams.listRectRadius});return m.map(p=>t)}).flat())),u=b({fullParams:e.fullParams$,seriesList:c}).pipe(h(s),P(async r=>r),T(r=>(console.log("fullParams",r),{...r.fullParams,seriesList:r.seriesList})));u.subscribe(r=>{console.log("subscription")});const l=pa(Vt,{rootSelection:i,seriesLabels$:g,fullParams$:u,layout$:e.layout$,fullChartParams$:e.fullChartParams$});return()=>{s.next(void 0),l()}}),ei={backgroundColorType:"background",strokeColorType:"primary",backgroundOpacity:.8,textColorType:"primary",offset:[20,5],padding:10,textRenderFn:o=>{if(o.highlightTarget==="datum"&&o.datum)return[`${o.datum.label}: ${o.datum.value}`];if(o.highlightTarget==="series"){const i=o.seriesLabel,e=o.series.map(n=>n.value).join(",");return[i,e]}else if(o.highlightTarget==="group"){const i=o.groupLabel,e=o.groups.map(n=>n.value).join(",");return[i,e]}return[]},svgRenderFn:null},Lt="Tooltip",jt=R(Lt,"g"),ai=R(Lt,"box");function ii(o,i){const e=i.textSize*1.5;return o.filter(n=>n!="").map((n,s)=>{const g=s*e;return`<text font-size="${i.textSize}" fill="${i.textColor}" x="0" y="${g}" style="dominant-baseline:text-before-edge">${n}</text>`}).join()}function ri({rootSelection:o,pluginName:i,rootWidth:e,rootHeight:n,svgString:s,tooltipStyle:g,event:c}){o.interrupt("fadeout");const u=5,l=s?[s]:[],r=s?[g]:[],a=o.selectAll(`g.${jt}`).data(l).join(A=>A.append("g").classed(jt,!0).attr("pointer-events","none"),A=>A,A=>A.style("opacity",0).remove()).attr("transform",()=>`translate(${c.offsetX}, ${c.offsetY})`).selectAll(`g.${ai}`).data(r).join(A=>A.append("g").classed(R(i,"box"),!0)),t=a.selectAll("rect").data(r).join(A=>A.append("rect").attr("rx",u).attr("ry",u)).attr("fill",A=>A.backgroundColor).attr("stroke",A=>A.strokeColor).attr("opacity",A=>A.backgroundOpacity),p=a.selectAll("g").data(l).join(A=>A.append("g").classed(R(i,"content"),!0).attr("transform",()=>`translate(${g.padding}, ${g.padding})`));l.length&&ga(p,l[0]);const f=p!=null&&p.node()?kt(p):{width:0,height:0};t.attr("width",f.width+g.padding*2).attr("height",f.height+g.padding*2);const d=a!=null&&a.node()?kt(a):{width:0,height:0},D=e-d.width,y=n-d.height,$=c.offsetX+g.offset[0]>D?D-c.offsetX:g.offset[0],L=c.offsetY+g.offset[1]>y?y-c.offsetY:g.offset[1];a.attr("transform",A=>`translate(${$}, ${L})`),a.attr("transform",A=>`translate(${$}, ${L})`)}const E=Be(Lt,ei)(({selection:o,rootSelection:i,name:e,chartType:n,observer:s,subject:g})=>{const c=new w,u=g.event$.pipe(h(c),dt(f=>f.eventName==="mouseover"||f.eventName==="mousemove")),l=g.event$.pipe(h(c),dt(f=>f.eventName==="mouseout")),r=b({fullChartParams:s.fullChartParams$,fullParams:s.fullParams$}).pipe(h(c),P(async f=>f),T(f=>({backgroundColor:N(f.fullParams.backgroundColorType,f.fullChartParams),backgroundOpacity:f.fullParams.backgroundOpacity,strokeColor:N(f.fullParams.strokeColorType,f.fullChartParams),offset:f.fullParams.offset,padding:f.fullParams.padding,textSize:f.fullChartParams.styles.textSize,textColor:N(f.fullParams.textColorType,f.fullChartParams)}))),m=b({fullParams:s.fullParams$,tooltipStyle:r}).pipe(h(c),P(async f=>f),T(f=>f.fullParams.svgRenderFn?f.fullParams.svgRenderFn:d=>{const D=f.fullParams.textRenderFn(d);return ii(D,f.tooltipStyle)})),a=b({event:u,contentRenderFn:m}).pipe(h(c),P(async f=>f),T(f=>f.contentRenderFn(f.event))),t=l.pipe(h(c),T(f=>"")),p=ht(u,l).pipe(h(c),T(f=>f.event));return b({svgString:ht(a,t),event:p,layout:s.layout$,tooltipStyle:r}).pipe(h(c),P(async f=>f)).subscribe(f=>{ri({rootSelection:i,pluginName:e,rootWidth:f.layout.rootWidth,rootHeight:f.layout.rootHeight,svgString:f.svgString,tooltipStyle:f.tooltipStyle,event:f.event})}),function(){c.next(void 0)}}),ee="PieEventTexts",Wt=R(ee,"text");function gt(o,i){const e=o.selectAll(`text.${Wt}`).data(i),n=e.enter().append("text").classed(Wt,!0),s=e.merge(n);return s.each((g,c,u)=>{const l=H(u[c]).text(g.text);Object.keys(g.attr).forEach(r=>{l.attr(r,g.attr[r])}),Object.keys(g.style).forEach(r=>{l.style(r,g.style[r])})}),e.exit().remove(),s}function mt({eventData:o,eventName:i,t:e,eventFn:n,textAttrs:s,textStyles:g}){return n(o,i,e).map((u,l)=>({text:u,attr:s[l],style:g[l]}))}const si=Jt(ee,ue)(({selection:o,name:i,observer:e,subject:n})=>{const s=new w,g=o.append("g");let c;e.layout$.pipe($t()).subscribe(l=>{o.attr("transform",`translate(${l.width/2}, ${l.height/2})`),e.layout$.pipe(h(s)).subscribe(r=>{o.transition().attr("transform",`translate(${r.width/2}, ${r.height/2})`)})});const u=e.fullChartParams$.pipe(h(s),T(l=>l.highlightTarget),z());return b({computedData:e.computedData$,fullParams:e.fullParams$,fullChartParams:e.fullChartParams$,highlightTarget:u}).pipe(h(s),P(async l=>l)).subscribe(l=>{g.transition().duration(l.fullChartParams.transitionDuration).ease(ma(l.fullChartParams.transitionEase)).tween("move",(r,m)=>a=>{const t=mt({eventData:{type:"series",pluginName:i,eventName:"transitionMove",event:r,highlightTarget:l.highlightTarget,data:l.computedData,series:[],seriesIndex:-1,seriesLabel:"",datum:null},eventName:"transitionMove",t:a,eventFn:l.fullParams.eventFn,textAttrs:l.fullParams.textAttrs,textStyles:l.fullParams.textStyles});gt(g,t)}).on("end",(r,m)=>{const a=mt({eventData:{type:"series",pluginName:i,eventName:"transitionEnd",event:r,highlightTarget:l.highlightTarget,data:l.computedData,series:[],seriesIndex:-1,seriesLabel:"",datum:null},eventName:"transitionMove",t:1,eventFn:l.fullParams.eventFn,textAttrs:l.fullParams.textAttrs,textStyles:l.fullParams.textStyles});gt(g,a),c&&c.unsubscribe(),c=n.event$.subscribe(t=>{const p=mt({eventData:t,eventName:t.eventName,t:1,eventFn:l.fullParams.eventFn,textAttrs:l.fullParams.textAttrs,textStyles:l.fullParams.textStyles});gt(g,p)})})}),()=>{s.next(void 0)}}),ae="PieLabels",ni=R(ae,"text");function oi(o,i,e,n){return o.map((s,g)=>{const[c,u]=i.centroid(s),[l,r]=e.centroid(s);return{pieDatum:s,arcIndex:g,arcLabel:s.data.label,x:c*n,y:u*n,mouseoverX:l*n,mouseoverY:r*n}}).filter(s=>s.pieDatum.data.visible)}function li(o,i,e,n){let s=o.selectAll("text").data(i,l=>l.pieDatum.id),g=s.enter().append("text").classed(ni,!0),c=s.exit();g.append("text");const u=s.merge(g);return u.attr("font-weight","bold").attr("text-anchor","middle").style("dominant-baseline","middle").style("cursor",l=>n.highlightTarget&&n.highlightTarget!="none"?"pointer":"none").text(l=>e.labelFn(l.pieDatum.data)).attr("font-size",n.styles.textSize).attr("fill",(l,r)=>ft({datum:l.pieDatum.data,colorType:e.labelColorType,fullChartParams:n})).transition().attr("transform",l=>"translate("+l.x+","+l.y+")"),c.remove(),u}function ui({labelSelection:o,ids:i,fullChartParams:e}){if(o.interrupt("highlight"),!i.length){o.transition().duration(200).attr("transform",n=>"translate("+n.x+","+n.y+")").style("opacity",1);return}o.each((n,s,g)=>{const c=H(g[s]);i.includes(n.pieDatum.id)?c.style("opacity",1).transition().duration(200).attr("transform",u=>"translate("+u.mouseoverX+","+u.mouseoverY+")"):c.style("opacity",e.styles.unhighlightedOpacity).transition().duration(200).attr("transform",u=>"translate("+u.x+","+u.y+")")})}const et=Jt(ae,ce)(({selection:o,observer:i,subject:e})=>{const n=new w,s=o.append("g");let g=new w,c=[];return i.layout$.pipe($t()).subscribe(u=>{o.attr("transform",`translate(${u.width/2}, ${u.height/2})`),i.layout$.pipe(h(n)).subscribe(l=>{o.transition().attr("transform",`translate(${l.width/2}, ${l.height/2})`)})}),b({layout:i.layout$,computedData:i.computedData$,fullParams:i.fullParams$,fullChartParams:i.fullChartParams$}).pipe(h(n),P(async u=>u)).subscribe(u=>{const l=u.layout.width<u.layout.height?u.layout.width:u.layout.height,r=Mt({axisWidth:l,innerRadius:0,outerRadius:u.fullParams.outerRadius,padAngle:0,cornerRadius:0}),m=Mt({axisWidth:l,innerRadius:0,outerRadius:u.fullParams.outerMouseoverRadius,padAngle:0,cornerRadius:0}),a=da({computedDataSeries:u.computedData,startAngle:u.fullParams.startAngle,endAngle:u.fullParams.endAngle});c=oi(a,r,m,u.fullParams.labelCentroid);const t=li(s,c,u.fullParams,u.fullChartParams);g.next(t)}),b({labelSelection:g,highlight:i.seriesHighlight$,fullChartParams:i.fullChartParams$}).pipe(h(n),P(async u=>u)).subscribe(u=>{ui({labelSelection:u.labelSelection,ids:u.highlight,fullChartParams:u.fullChartParams})}),()=>{n.next(void 0)}}),Z=[15,38,25,17,26,72,64,29],C=[[55,80,50,11,150],[35,40,15,65,120]],ci=[[[1205,850,930,1111,1500],[735,900,880,1035,1120]],[[55,80,50,11,150],[35,40,15,65,120]]],at={series:{Bubbles:{PRESET_SERIES_BASIC:{chart:W,plugins:[vt,Y,E],preset:It,data:Z},PRESET_BUBBLES_SCALING_BY_RADIUS:{chart:W,plugins:[vt,Y,E],preset:Ve,data:Z}},Pie:{PRESET_SERIES_BASIC:{chart:W,plugins:[tt,et,Y,E],preset:It,data:Z},PRESET_PIE_WITH_INNER_LABELS:{chart:W,plugins:[tt,et,Y,E],preset:je,data:Z},PRESET_PIE_DONUT:{chart:W,plugins:[tt,et,si,Y,E],preset:We,data:Z},PRESET_PIE_HALF_DONUT:{chart:W,plugins:[tt,et,Y,E],preset:Ye,data:Z}}},grid:{Bars:{PRESET_GRID_BASIC:{chart:I,plugins:[j,M,G,v,k,E],preset:st,data:C},PRESET_GRID_ROTATE_AXIS_LABEL:{chart:I,plugins:[j,M,G,v,k,E],preset:nt,data:C},PRESET_GRID_HORIZONTAL:{chart:I,plugins:[j,M,G,v,k,E],preset:ot,data:C},PRESET_BARS_ROUND:{chart:I,plugins:[j,M,G,v,k,E],preset:Ze,data:C},PRESET_BARS_HORIZONTAL_AND_ROUND:{chart:I,plugins:[j,M,G,v,k,E],preset:qe,data:C},PRESET_BARS_THIN:{chart:I,plugins:[j,M,G,v,k,E],preset:Je,data:C},PRESET_BARS_HORIZONTAL_AND_THIN:{chart:I,plugins:[j,M,G,v,k,E],preset:Qe,data:C}},BarStack:{PRESET_GRID_BASIC:{chart:I,plugins:[lt,M,pt,v,k,E],preset:st,data:C},PRESET_GRID_ROTATE_AXIS_LABEL:{chart:I,plugins:[lt,M,pt,v,k,E],preset:nt,data:C},PRESET_GRID_HORIZONTAL:{chart:I,plugins:[lt,M,pt,v,k,E],preset:ot,data:C}},BarsTriangle:{PRESET_GRID_BASIC:{chart:I,plugins:[ut,M,G,v,k,E],preset:st,data:C},PRESET_GRID_ROTATE_AXIS_LABEL:{chart:I,plugins:[ut,M,G,v,k,E],preset:nt,data:C},PRESET_GRID_HORIZONTAL:{chart:I,plugins:[ut,M,G,v,k,E],preset:ot,data:C}},Lines:{PRESET_LINES_BASIC:{chart:I,plugins:[J,M,G,Q,v,k,E],preset:Ke,data:C},PRESET_LINES_ROTATE_AXIS_LABEL:{chart:I,plugins:[J,M,G,Q,v,k,E],preset:ta,data:C},PRESET_LINES_HORIZONTAL:{chart:I,plugins:[J,M,G,Q,v,k,E],preset:ea,data:C},PRESET_LINES_CURVE:{chart:I,plugins:[J,M,G,Q,v,k,E],preset:aa,data:C},PRESET_LINES_HIGHLIGHT_GROUP_DOTS:{chart:I,plugins:[J,M,G,Q,Xa,v,k,E],preset:ia,data:C}}},multiGrid:{BarsAndLines:{PRESET_MULTI_GRID_BASIC:{chart:Aa,plugins:[Ka,ti,E],preset:ra,data:ci}}}},pi={id:"chart",style:{width:"100%",height:"100vh"}},Pi=ie({__name:"[presetName]",setup(o){const e=re().params,n=at[e.chartType]&&at[e.chartType][e.pluginName]&&at[e.chartType][e.pluginName][e.presetName]?at[e.chartType][e.pluginName][e.presetName]:null;return se(()=>{if(!n)return;const s=document.querySelector("#chart"),g=n.plugins.map(u=>new u);console.log("detail.preset",n.preset);const c=new n.chart(s,{preset:n.preset});c.plugins$.next(g),c.data$.next(n.data)}),(s,g)=>(ne(),oe("div",pi))}});export{Pi as default};
