import{S as H,t as h,m as y,h as k,o as b,p as F,s as v,$ as ge,b as X,F as pe,x as ce,Y as de,z as me,i as he,ay as xe}from"./CzjhHakb.js";import{c as Z,d as $e,e as De,f as fe,g as Y,h as q,i as Ae,j as Se}from"./u-UBqIpB.js";import{l as re,m as ye,n as ee,o as Le}from"./sU_-MLKA.js";import{f as Pe}from"./CHn3Vcg8.js";import{c as Te}from"./CFEEDzG_.js";import{c as Ge}from"./DkqUpMvk.js";function Ie(r="curveLinear",o){return De().x(i=>i.axisX).y0(i=>o).y1(i=>i.axisY).curve(fe[r])}function be(r){let o=[[]],i=0;for(let s in r){if(r[s].visible==!1||r[s].value===void 0||r[s].value===null){o[i].length&&(i++,o[i]=[]);continue}o[i].push(r[s])}return o}function Ce({selection:r,pathClassName:o,segmentData:i,areaPath:s,linearGradientIds:a,params:u}){return r.selectAll("path").data(i,(n,m)=>n.length?`${n[0].id}_${n[n.length-1].id}`:m).join(n=>n.append("path").classed(o,!0).attr("fill","none").style("vector-effect","non-scaling-stroke").style("cursor","pointer"),n=>n,n=>n.remove()).attr("fill",(n,m)=>n[0]?`url(#${a[n[0].seriesIndex]})`:"").attr("d",n=>s(n))}function Me({selection:r,seriesLabel:o,fullChartParams:i}){if(r.interrupt("highlight"),!o){r.transition("highlight").duration(200).style("opacity",1);return}r.each((s,a,u)=>{s===o?v(u[a]).style("opacity",1):v(u[a]).style("opacity",i.styles.unhighlightedOpacity)})}function Fe({defsSelection:r,computedData:o,linearGradientIds:i,params:s}){r.selectAll("linearGradient").data(o??[]).join(a=>a.append("linearGradient").attr("x1","0%").attr("x2","0%").attr("y1","100%").attr("y2","0%").attr("spreadMethod","pad"),a=>a,a=>a.remove()).attr("id",(a,u)=>a[0]?i[a[0].seriesIndex]:"").html((a,u)=>{const d=a[0]?a[0].color:"";return`
        <stop offset="0%"   stop-color="${d}" stop-opacity="${s.linearGradientOpacity[0]}"/>
        <stop offset="100%" stop-color="${d}" stop-opacity="${s.linearGradientOpacity[1]}"/>
      `})}function Re({defsSelection:r,clipPathData:o,transitionDuration:i,transitionEase:s}){r.selectAll("clipPath").data(o).join(a=>a.append("clipPath"),a=>a,a=>a.remove()).attr("id",a=>a.id).each((a,u,d)=>{v(d[u]).selectAll("rect").data([a]).join(n=>{const m=n.append("rect");return m.transition().duration(i).ease($e(s)).tween("tween",(g,N,$)=>T=>{const C=g.width*T;m.attr("x",0).attr("y",0).attr("width",A=>C).attr("height",A=>A.height)}),m},n=>n.attr("x",0).attr("y",0).attr("width",m=>m.width).attr("height",m=>m.height),n=>n.remove())})}const we=(r,{selection:o,computedData$:i,computedLayoutData$:s,visibleComputedData$:a,visibleComputedLayoutData$:u,seriesLabels$:d,SeriesDataMap$:n,GroupDataMap$:m,fullParams$:g,fullDataFormatter$:N,fullChartParams$:$,gridAxesTransform$:T,gridGraphicTransform$:C,gridAxesSize$:A,gridHighlight$:G,gridContainerPosition$:L,layout$:w,event$:R})=>{const D=new H,U=Z(r,"clipPath-box"),e=Y(r,"path"),{seriesSelection$:P,axesSelection$:x,defsSelection$:S,graphicGSelection$:z}=re({selection:o,pluginName:r,clipPathID:U,seriesLabels$:d,gridContainerPosition$:L,gridAxesTransform$:T,gridGraphicTransform$:C}),V=C.pipe(h(D),y(t=>-t.translate[1]/t.scale[1])),Q=new ge(t=>{const f=b({fullParams:g,valueAxisStart:V}).pipe(h(D)).subscribe(c=>{const p=Ie(c.fullParams.lineCurve,c.valueAxisStart);t.next(p)});return()=>{f.unsubscribe()}}),I=$.pipe(y(t=>t.transitionDuration),k()),O=$.pipe(y(t=>t.transitionEase),k());b({defsSelection:S,seriesLabels:d,axisSize:A,transitionDuration:I,transitionEase:O}).pipe(h(D),F(async t=>t)).subscribe(t=>{const c=[{id:U,width:t.axisSize.width,height:t.axisSize.height}].concat(t.seriesLabels.map(p=>({id:`orbcharts__clipPath_${p}`,width:t.axisSize.width,height:t.axisSize.height})));Re({defsSelection:t.defsSelection,clipPathData:c,transitionDuration:t.transitionDuration,transitionEase:t.transitionEase})});const se=i.pipe(y(t=>{const f=new Map;return t.flat().forEach(c=>f.set(c.id,c)),f})),oe=ye({fullDataFormatter$:N,gridAxesSize$:A,computedData$:i,fullChartParams$:$,gridContainerPosition$:L,layout$:w}),ne=$.pipe(h(D),y(t=>t.highlightTarget),k()),le=d.pipe(h(D),y(t=>t.map((f,c)=>Z(r,`lineargradient-${f}`)))),ue=b({graphicGSelection:z,defsSelection:S,visibleComputedLayoutData:u,linearGradientIds:le,areaPath:Q,params:g}).pipe(h(D),F(async t=>t),y(t=>{let f=[];return t.graphicGSelection.each((c,p,M)=>{const B=be(t.visibleComputedLayoutData[p]??[]);f[p]=Ce({selection:v(M[p]),pathClassName:e,areaPath:t.areaPath,segmentData:B,linearGradientIds:t.linearGradientIds,params:t.params}),Fe({defsSelection:t.defsSelection,computedData:t.visibleComputedLayoutData,linearGradientIds:t.linearGradientIds,params:t.params})}),f}));return b({pathSelectionArr:ue,computedData:i,SeriesDataMap:n,GroupDataMap:m,highlightTarget:ne,gridGroupPositionFn:oe}).pipe(h(D),F(async t=>t)).subscribe(t=>{t.pathSelectionArr.forEach(f=>{f.on("mouseover",(c,p)=>{const M=p[0]?p[0].seriesLabel:"",{groupIndex:B,groupLabel:_}=t.gridGroupPositionFn(c),l=t.GroupDataMap.get(_).find(E=>E.seriesLabel===M)??p[0];R.next({type:"grid",eventName:"mouseover",pluginName:r,highlightTarget:t.highlightTarget,datum:l,gridIndex:l.gridIndex,series:t.SeriesDataMap.get(l.seriesLabel),seriesIndex:l.seriesIndex,seriesLabel:l.seriesLabel,groups:t.GroupDataMap.get(l.groupLabel),groupIndex:l.groupIndex,groupLabel:l.groupLabel,event:c,data:t.computedData})}).on("mousemove",(c,p)=>{const M=p[0]?p[0].seriesLabel:"",{groupIndex:B,groupLabel:_}=t.gridGroupPositionFn(c),l=t.GroupDataMap.get(_).find(E=>E.seriesLabel===M)??p[0];R.next({type:"grid",eventName:"mousemove",pluginName:r,highlightTarget:t.highlightTarget,datum:l,gridIndex:l.gridIndex,series:t.SeriesDataMap.get(l.seriesLabel),seriesIndex:l.seriesIndex,seriesLabel:l.seriesLabel,groups:t.GroupDataMap.get(l.groupLabel),groupIndex:l.groupIndex,groupLabel:l.groupLabel,event:c,data:t.computedData})}).on("mouseout",(c,p)=>{const M=p[0]?p[0].seriesLabel:"",{groupIndex:B,groupLabel:_}=t.gridGroupPositionFn(c),l=t.GroupDataMap.get(_).find(E=>E.seriesLabel===M)??p[0];R.next({type:"grid",eventName:"mouseout",pluginName:r,highlightTarget:t.highlightTarget,datum:l,gridIndex:l.gridIndex,series:t.SeriesDataMap.get(l.seriesLabel),seriesIndex:l.seriesIndex,seriesLabel:l.seriesLabel,groups:t.GroupDataMap.get(l.groupLabel),groupIndex:l.groupIndex,groupLabel:l.groupLabel,event:c,data:t.computedData})}).on("click",(c,p)=>{const M=p[0]?p[0].seriesLabel:"",{groupIndex:B,groupLabel:_}=t.gridGroupPositionFn(c),l=t.GroupDataMap.get(_).find(E=>E.seriesLabel===M)??p[0];R.next({type:"grid",eventName:"click",pluginName:r,highlightTarget:t.highlightTarget,datum:l,gridIndex:l.gridIndex,series:t.SeriesDataMap.get(l.seriesLabel),seriesIndex:l.seriesIndex,seriesLabel:l.seriesLabel,groups:t.GroupDataMap.get(l.groupLabel),groupIndex:l.groupIndex,groupLabel:l.groupLabel,event:c,data:t.computedData})})})}),$.pipe(h(D),Pe(t=>t.highlightTarget==="series"),F(t=>b({graphicGSelection:z,gridHighlight:G,DataMap:se,fullChartParams:$}).pipe(h(D),F(async f=>f)))).subscribe(t=>{const f=t.gridHighlight[0]?t.gridHighlight[0].seriesLabel:null;Me({selection:t.graphicGSelection,seriesLabel:f,fullChartParams:t.fullChartParams})}),()=>{D.next(void 0)}},te="LineAreas",Xe=X(te,pe)(({selection:r,name:o,observer:i,subject:s})=>{const a=new H,u=we(te,{selection:r,computedData$:i.computedData$,visibleComputedData$:i.visibleComputedData$,computedLayoutData$:i.computedLayoutData$,visibleComputedLayoutData$:i.visibleComputedLayoutData$,seriesLabels$:i.seriesLabels$,SeriesDataMap$:i.SeriesDataMap$,GroupDataMap$:i.GroupDataMap$,fullParams$:i.fullParams$,fullDataFormatter$:i.fullDataFormatter$,fullChartParams$:i.fullChartParams$,gridAxesTransform$:i.gridAxesTransform$,gridGraphicTransform$:i.gridGraphicTransform$,gridAxesSize$:i.gridAxesSize$,gridHighlight$:i.gridHighlight$,gridContainerPosition$:i.gridContainerPosition$,allContainerPosition$:i.gridContainerPosition$,layout$:i.layout$,event$:s.event$});return()=>{a.next(void 0),u()}}),ae="Dots",Ye=X(ae,ce)(({selection:r,name:o,subject:i,observer:s})=>{const a=new H,u=Te(ae,{selection:r,computedData$:s.computedData$,computedLayoutData$:s.computedLayoutData$,visibleComputedData$:s.visibleComputedData$,visibleComputedLayoutData$:s.visibleComputedLayoutData$,seriesLabels$:s.seriesLabels$,SeriesDataMap$:s.SeriesDataMap$,GroupDataMap$:s.GroupDataMap$,fullParams$:s.fullParams$,fullChartParams$:s.fullChartParams$,gridAxesTransform$:s.gridAxesTransform$,gridGraphicTransform$:s.gridGraphicTransform$,gridGraphicReverseScale$:s.gridGraphicReverseScale$,gridAxesSize$:s.gridAxesSize$,gridHighlight$:s.gridHighlight$,gridContainerPosition$:s.gridContainerPosition$,event$:i.event$});return()=>{a.next(void 0),u()}}),ie="ValueStackAxis",We=X(ie,de)(({selection:r,name:o,observer:i,subject:s})=>{const a=new H,u=Ge(ie,{selection:r,computedData$:i.computedStackedData$,fullParams$:i.fullParams$,fullDataFormatter$:i.fullDataFormatter$,fullChartParams$:i.fullChartParams$,gridAxesTransform$:i.gridAxesTransform$,gridAxesReverseTransform$:i.gridAxesReverseTransform$,gridAxesSize$:i.gridAxesSize$,gridContainerPosition$:i.gridContainerPosition$,isSeriesSeprate$:i.isSeriesSeprate$});return()=>{a.next(void 0),u()}}),j="GroupAux",J=Y(j,"label-box");function ze({groupLabel:r,axisX:o,axisHeight:i,fullParams:s}){return s.showLine&&r?[{id:r,x1:o,x2:o,y1:0,y2:i}]:[]}function _e({selection:r,pluginName:o,lineData:i,fullParams:s,fullChartParams:a}){const u=Y(o,"auxline"),d=r.selectAll(`line.${u}`).data(i),n=d.enter().append("line").classed(u,!0).style("stroke",g=>q(s.lineColorType,a)).style("stroke-width",1).style("stroke-dasharray",s.lineDashArray??"none").style("pointer-events","none"),m=d.merge(n);return d.exit().remove(),n.attr("x1",g=>g.x1).attr("y1",g=>g.y1).attr("x2",g=>g.x2).attr("y2",g=>g.y2),d.transition().duration(50).attr("x1",g=>g.x1).attr("y1",g=>g.y1).attr("x2",g=>g.x2).attr("y2",g=>g.y2),m}function Ee(r){r.selectAll("line").data([]).exit().remove()}function ke({groupLabel:r,axisX:o,fullParams:i}){return i.showLabel&&r?[{id:r,x:o,y:-i.labelPadding,text:Ae(r,i.labelTextFormat)}]:[]}function Ne({selection:r,labelData:o,fullParams:i,fullDataFormatter:s,fullChartParams:a,labelTransform:u,textSizePx:d}){const n=d+4,m=r.selectAll(`g.${J}`).data(o),g=m.enter().append("g").classed(J,!0).style("cursor","pointer"),N=g.merge(m);return g.attr("transform",($,T)=>`translate(${$.x}, ${$.y})`),m.transition().duration(50).attr("transform",($,T)=>`translate(${$.x}, ${$.y})`),m.exit().remove(),N.each(($,T,C)=>{const A=Se($.text,d)+12;let G=-A/2,L=-2;s.grid.groupAxis.position==="bottom"?(G=i.labelRotate?-A:-A/2,L=2):s.grid.groupAxis.position==="left"?(G=-A+2,L=-n/2):s.grid.groupAxis.position==="right"?(G=-2,L=-n/2):s.grid.groupAxis.position==="top"&&(G=i.labelRotate?-A:-A/2,L=-n+2);const w=v(C[T]).selectAll("rect").data([$]),R=w.enter().append("rect").attr("height",`${n}px`).attr("fill",e=>q(i.labelColorType,a)).attr("x",G).attr("y",L).attr("rx",5).attr("ry",5).style("cursor","pointer");w.merge(R).attr("width",e=>`${A}px`).style("transform",u),w.exit().remove();const D=v(C[T]).selectAll("text").data([$]),U=D.enter().append("text").style("dominant-baseline","hanging").style("cursor","pointer");D.merge(U).text(e=>e.text).style("transform",u).attr("fill",e=>q(i.labelTextColorType,a)).attr("font-size",a.styles.textSize).attr("x",G+6).attr("y",L),D.exit().remove()}),N}function Ue(r){r.selectAll(`g.${J}`).data([]).exit().remove()}const Ke=X(j,me)(({selection:r,rootSelection:o,name:i,subject:s,observer:a})=>{const u=new H;let d=!1;const n=o.insert("rect","g").classed(Y(j,"rect"),!0).attr("opacity",0),{seriesSelection$:m,axesSelection$:g,defsSelection$:N,graphicGSelection$:$}=re({selection:r,pluginName:j,clipPathID:"test",seriesLabels$:a.seriesLabels$,gridContainerPosition$:a.gridContainerPosition$,gridAxesTransform$:a.gridAxesTransform$,gridGraphicTransform$:a.gridGraphicTransform$});a.layout$.pipe(h(u)).subscribe(e=>{n.attr("width",e.rootWidth).attr("height",e.rootHeight)});const T=b({fullDataFormatter:a.fullDataFormatter$,gridAxesSize:a.gridAxesSize$,computedData:a.computedData$}).pipe(h(u),F(async e=>e),y(e=>{const x=e.computedData[0]?e.computedData[0].length-1:0,S=e.fullDataFormatter.grid.groupAxis.scaleDomain[0]==="auto"?0-e.fullDataFormatter.grid.groupAxis.scalePadding:e.fullDataFormatter.grid.groupAxis.scaleDomain[0]-e.fullDataFormatter.grid.groupAxis.scalePadding,z=e.fullDataFormatter.grid.groupAxis.scaleDomain[1]==="auto"?x+e.fullDataFormatter.grid.groupAxis.scalePadding:e.fullDataFormatter.grid.groupAxis.scaleDomain[1]+e.fullDataFormatter.grid.groupAxis.scalePadding;return[S,z]}),he(1)),C=b({groupScaleDomain:T,gridAxesSize:a.gridAxesSize$}).pipe(h(u),F(async e=>e),y(e=>xe().domain(e.groupScaleDomain).range([0,e.gridAxesSize.width]))),A=a.fullChartParams$.pipe(h(u),y(e=>e.highlightTarget),k()),G=ee(o,"mousemove").pipe(h(u)),L=b({fullParams:a.fullParams$,fullDataFormatter:a.fullDataFormatter$,gridAxesReverseTransform:a.gridAxesReverseTransform$,gridContainerPosition:a.gridContainerPosition$}).pipe(h(u),F(async e=>e),y(e=>{const P=`translate(${e.gridAxesReverseTransform.translate[0]}px, ${e.gridAxesReverseTransform.translate[1]}px)`,x=`rotate(${e.gridAxesReverseTransform.rotate}deg) rotateX(${e.gridAxesReverseTransform.rotateX}deg) rotateY(${e.gridAxesReverseTransform.rotateY}deg)`,S=`scale(${1/e.gridContainerPosition[0].scale[0]}, ${1/e.gridContainerPosition[0].scale[1]})`,V=`rotate(${e.fullDataFormatter.grid.groupAxis.position==="left"&&e.fullDataFormatter.grid.valueAxis.position==="top"||e.fullDataFormatter.grid.groupAxis.position==="right"&&e.fullDataFormatter.grid.valueAxis.position==="bottom"?e.fullParams.labelRotate+180:e.fullParams.labelRotate}deg)`;return`${P} ${x} ${S} ${V}`}),k()),w=a.gridContainerPosition$.pipe(h(u),y(e=>e.reduce((x,S)=>S.columnIndex>x?S.columnIndex:x,0)+1),k()),R=a.gridContainerPosition$.pipe(h(u),y(e=>e.reduce((x,S)=>S.rowIndex>x?S.rowIndex:x,0)+1),k()),D=Le({rootSelection:o,fullDataFormatter$:a.fullDataFormatter$,gridAxesSize$:a.gridAxesSize$,computedData$:a.computedData$,fullChartParams$:a.fullChartParams$,gridContainerPosition$:a.gridContainerPosition$,layout$:a.layout$}).pipe(h(u));b({axesSelection:g,columnAmount:w,rowAmount:R,layout:a.layout$,rootMousemove:G,gridGroupPosition:D,computedData:a.computedData$,groupScale:C,gridAxesSize:a.gridAxesSize$,fullParams:a.fullParams$,fullDataFormatter:a.fullDataFormatter$,fullChartParams:a.fullChartParams$,highlightTarget:A,labelTransform:L,GroupDataMap:a.GroupDataMap$,textSizePx:a.textSizePx$}).subscribe(e=>{const{groupIndex:P,groupLabel:x}=e.gridGroupPosition,S=e.groupScale(P)??0,z=ze({groupLabel:x,axisX:S,axisHeight:e.gridAxesSize.height,fullParams:e.fullParams});_e({selection:e.axesSelection,pluginName:i,lineData:z,fullParams:e.fullParams,fullChartParams:e.fullChartParams});const V=ke({groupLabel:x,axisX:S,fullParams:e.fullParams});Ne({selection:e.axesSelection,labelData:V,fullParams:e.fullParams,fullDataFormatter:e.fullDataFormatter,fullChartParams:e.fullChartParams,labelTransform:e.labelTransform,textSizePx:e.textSizePx}).on("mouseover",(I,O)=>{I.stopPropagation(),d=!0,s.event$.next({type:"grid",pluginName:i,eventName:"mouseover",highlightTarget:e.highlightTarget,datum:null,gridIndex:0,series:[],seriesIndex:-1,seriesLabel:"",groups:e.GroupDataMap.get(x)??[],groupIndex:P,groupLabel:x,event:I,data:e.computedData})}).on("mousemove",(I,O)=>{I.stopPropagation(),s.event$.next({type:"grid",pluginName:i,eventName:"mousemove",highlightTarget:e.highlightTarget,datum:null,gridIndex:0,series:[],seriesIndex:-1,seriesLabel:"",groups:e.GroupDataMap.get(x)??[],groupIndex:P,groupLabel:x,event:I,data:e.computedData})}).on("click",(I,O)=>{I.stopPropagation(),s.event$.next({type:"grid",pluginName:i,eventName:"click",highlightTarget:e.highlightTarget,datum:null,gridIndex:0,series:[],seriesIndex:-1,seriesLabel:"",groups:e.GroupDataMap.get(x)??[],groupIndex:P,groupLabel:x,event:I,data:e.computedData})})});const U=ee(n,"mouseout").pipe(h(u));return b({rootRectMouseout:U,axesSelection:g}).pipe(h(u),F(async e=>e)).subscribe(e=>{setTimeout(()=>{d!=!0&&(Ee(e.axesSelection),Ue(e.axesSelection))})}),()=>{u.next(void 0),n.remove()}});export{Ye as D,Ke as G,Xe as L,We as V,we as c};
