import{f as R,_ as O,i as _,h as H,O as G,j as v,y as W,k as q,S as J,t as $,m as E,d as C,e as T,s as F,c as w,l as Q}from"./CjdleEie.js";import{g as N,c as S,p as V,d as X}from"./CzUzxl8i.js";import{m as B,a as K}from"./CrDNbRWq.js";import{g as Y}from"./W937OcHy.js";import{f as Z}from"./5rDUwiLZ.js";var j=["addListener","removeListener"],ee=["addEventListener","removeEventListener"],te=["on","off"];function b(t,s,a,o){if(v(a)&&(o=a,a=void 0),o)return b(t,s,a).pipe(R(o));var i=O(ae(t)?ee.map(function(g){return function(d){return t[g](s,d,a)}}):re(t)?j.map(z(t,s)):ne(t)?te.map(z(t,s)):[],2),u=i[0],p=i[1];if(!u&&_(t))return B(function(g){return b(g,s,a)})(H(t));if(!u)throw new TypeError("Invalid event target");return new G(function(g){var d=function(){for(var n=[],x=0;x<arguments.length;x++)n[x]=arguments[x];return g.next(1<n.length?n:n[0])};return u(d),function(){return p(d)}})}function z(t,s){return function(a){return function(o){return t[a](s,o)}}}function re(t){return v(t.addListener)&&v(t.removeListener)}function ne(t){return v(t.on)&&v(t.off)}function ae(t){return v(t.addEventListener)&&v(t.removeEventListener)}function ie(t,s){let a=new G(()=>{});return t.each(function(){const o=b(this,s);a=K(a,o)}),a}const I="GroupAux",M=N(I,"label-box");function oe({groupLabel:t,axisX:s,axisHeight:a,fullParams:o}){return o.showLine&&t?[{id:t,x1:s,x2:s,y1:0,y2:a}]:[]}function se({selection:t,pluginName:s,lineData:a,fullParams:o,fullChartParams:i}){const u=N(s,"auxline"),p=t.selectAll(`line.${u}`).data(a),g=p.enter().append("line").classed(u,!0).style("stroke",n=>S(o.lineColorType,i)).style("stroke-width",1).style("stroke-dasharray",o.lineDashArray??"none").style("pointer-events","none"),d=p.merge(g);return p.exit().remove(),g.attr("x1",n=>n.x1).attr("y1",n=>n.y1).attr("x2",n=>n.x2).attr("y2",n=>n.y2),p.transition().duration(50).attr("x1",n=>n.x1).attr("y1",n=>n.y1).attr("x2",n=>n.x2).attr("y2",n=>n.y2),d}function le(t){t.selectAll("line").data([]).exit().remove()}function ue({groupLabel:t,axisX:s,fullParams:a}){return a.showLabel&&t?[{id:t,x:s,y:-a.labelPadding,text:V(t,a.labelTextFormat)}]:[]}function ge({selection:t,labelData:s,fullParams:a,fullChartParams:o,gridAxesReverseTransformValue:i}){const u=o.styles.textSize+4,p=t.selectAll(`g.${M}`).data(s),g=p.enter().append("g").classed(M,!0).style("cursor","pointer"),d=g.merge(p);return g.attr("transform",(n,x)=>`translate(${n.x}, ${n.y})`),p.transition().duration(50).attr("transform",(n,x)=>`translate(${n.x}, ${n.y})`),p.exit().remove(),d.each((n,x,P)=>{const e=X(n.text,o.styles.textSize)+12,r=-e/2,h=w(P[x]).selectAll("rect").data([n]),c=h.enter().append("rect").attr("height",`${u}px`).attr("fill",f=>S(a.labelColorType,o)).attr("x",r).attr("y",-2).attr("rx",5).attr("ry",5).style("cursor","pointer");h.merge(c).attr("width",f=>`${e}px`).style("transform",i),h.exit().remove();const l=w(P[x]).selectAll("text").data([n]),m=l.enter().append("text").style("dominant-baseline","hanging").style("cursor","pointer");l.merge(m).text(f=>f.text).style("transform",i).attr("fill",f=>S(a.labelTextColorType,o)).attr("font-size",o.styles.textSize).attr("x",r+6),l.exit().remove()}),d}function pe(t){t.selectAll(`g.${M}`).data([]).exit().remove()}const fe=W(I,q)(({selection:t,rootSelection:s,name:a,subject:o,observer:i})=>{const u=new J,p=s.insert("rect","g").classed(N(I,"rect"),!0).attr("opacity",0),g=t.append("g");i.layout$.pipe($(u)).subscribe(e=>{p.attr("width",e.rootWidth).attr("height",e.rootHeight)}),i.gridAxesTransform$.pipe($(u),E(e=>e.value),C()).subscribe(e=>{g.style("transform",e)});const d=new G(e=>{T({fullDataFormatter:i.fullDataFormatter$,gridAxesSize:i.gridAxesSize$,computedData:i.computedData$}).pipe($(u),F(async r=>r)).subscribe(r=>{const c=r.computedData[0]?r.computedData[0].length-1:0,l=r.fullDataFormatter.grid.groupAxis.scaleDomain[0]==="auto"?0-r.fullDataFormatter.grid.groupAxis.scalePadding:r.fullDataFormatter.grid.groupAxis.scaleDomain[0]-r.fullDataFormatter.grid.groupAxis.scalePadding,m=r.fullDataFormatter.grid.groupAxis.scaleDomain[1]==="auto"?c+r.fullDataFormatter.grid.groupAxis.scalePadding:r.fullDataFormatter.grid.groupAxis.scaleDomain[1]+r.fullDataFormatter.grid.groupAxis.scalePadding,f=r.computedData[0]?r.computedData[0].length:0;let D=r.fullDataFormatter.grid.gridData.seriesDirection==="row"?(r.computedData[0]??[]).map(A=>A.groupLabel):r.computedData.map(A=>A[0].groupLabel);const y=new Array(f).fill(0).map((A,L)=>D[L]!=null?D[L]:String(L)).filter((A,L)=>L>=l&&L<=m),k=r.fullDataFormatter.grid.groupAxis.scalePadding,U=Q({axisLabels:y,axisWidth:r.gridAxesSize.width,padding:k});e.next(U)})}),n=Y({fullDataFormatter$:i.fullDataFormatter$,gridAxesSize$:i.gridAxesSize$,computedData$:i.computedData$,fullChartParams$:i.fullChartParams$}),x=i.fullChartParams$.pipe($(u),E(e=>e.highlightTarget),C());return T({computedData:i.computedData$,gridAxesSize:i.gridAxesSize$,fullParams:i.fullParams$,fullChartParams:i.fullChartParams$,highlightTarget:x,SeriesDataMap:i.SeriesDataMap$,GroupDataMap:i.GroupDataMap$,gridGroupPositionFn:n,groupScale:d}).pipe($(u),F(async e=>e)).subscribe(e=>{s.on("mouseover",(r,h)=>{const{groupIndex:c,groupLabel:l}=e.gridGroupPositionFn(r);o.event$.next({type:"grid",pluginName:a,eventName:"mouseover",highlightTarget:e.highlightTarget,datum:null,gridIndex:0,series:[],seriesIndex:-1,seriesLabel:"",groups:e.GroupDataMap.get(l)??[],groupIndex:c,groupLabel:l,event:r,data:e.computedData})}).on("mousemove",(r,h)=>{const{groupIndex:c,groupLabel:l}=e.gridGroupPositionFn(r);o.event$.next({type:"grid",pluginName:a,eventName:"mousemove",highlightTarget:e.highlightTarget,datum:null,gridIndex:0,series:[],seriesIndex:-1,seriesLabel:"",groups:e.GroupDataMap.get(l)??[],groupIndex:c,groupLabel:l,event:r,data:e.computedData})}).on("mouseout",(r,h)=>{const{groupIndex:c,groupLabel:l}=e.gridGroupPositionFn(r);o.event$.next({type:"grid",pluginName:a,eventName:"mouseout",highlightTarget:e.highlightTarget,datum:null,gridIndex:0,series:[],seriesIndex:-1,seriesLabel:"",groups:e.GroupDataMap.get(l)??[],groupIndex:c,groupLabel:l,event:r,data:e.computedData})}).on("click",(r,h)=>{r.stopPropagation();const{groupIndex:c,groupLabel:l}=e.gridGroupPositionFn(r);o.event$.next({type:"grid",pluginName:a,eventName:"click",highlightTarget:e.highlightTarget,datum:null,gridIndex:0,series:[],seriesIndex:-1,seriesLabel:"",groups:e.GroupDataMap.get(l)??[],groupIndex:c,groupLabel:l,event:r,data:e.computedData})})}),T({event:o.event$.pipe(Z(e=>e.eventName==="mouseover"||e.eventName==="mousemove")),computedData:i.computedData$,groupScale:d,gridAxesSize:i.gridAxesSize$,fullParams:i.fullParams$,fullChartParams:i.fullChartParams$,highlightTarget:x,gridAxesReverseTransform:i.gridAxesReverseTransform$,GroupDataMap:i.GroupDataMap$,gridGroupPositionFn:n}).pipe($(u),F(async e=>e)).subscribe(e=>{const r=e.groupScale(e.event.groupLabel)??0,h=oe({groupLabel:e.event.groupLabel,axisX:r,axisHeight:e.gridAxesSize.height,fullParams:e.fullParams});se({selection:g,pluginName:a,lineData:h,fullParams:e.fullParams,fullChartParams:e.fullChartParams});const c=ue({groupLabel:e.event.groupLabel,axisX:r,fullParams:e.fullParams});ge({selection:g,labelData:c,fullParams:e.fullParams,fullChartParams:e.fullChartParams,gridAxesReverseTransformValue:e.gridAxesReverseTransform.value}).on("mouseover",(m,f)=>{const{groupIndex:D,groupLabel:y}=e.gridGroupPositionFn(m);o.event$.next({type:"grid",pluginName:a,eventName:"mouseover",highlightTarget:e.highlightTarget,datum:null,gridIndex:0,series:[],seriesIndex:-1,seriesLabel:"",groups:e.event.groups,groupIndex:D,groupLabel:y,event:m,data:e.computedData})}).on("mousemove",(m,f)=>{const{groupIndex:D,groupLabel:y}=e.gridGroupPositionFn(m);o.event$.next({type:"grid",pluginName:a,eventName:"mousemove",highlightTarget:e.highlightTarget,datum:null,gridIndex:0,series:[],seriesIndex:-1,seriesLabel:"",groups:e.event.groups,groupIndex:D,groupLabel:y,event:m,data:e.computedData})}).on("mouseout",(m,f)=>{const{groupIndex:D,groupLabel:y}=e.gridGroupPositionFn(m);o.event$.next({type:"grid",pluginName:a,eventName:"mouseout",highlightTarget:e.highlightTarget,datum:null,gridIndex:0,series:[],seriesIndex:-1,seriesLabel:"",groups:e.event.groups,groupIndex:D,groupLabel:y,event:m,data:e.computedData})}).on("click",(m,f)=>{const{groupIndex:D,groupLabel:y}=e.gridGroupPositionFn(m);o.event$.next({type:"grid",pluginName:a,eventName:"click",highlightTarget:e.highlightTarget,datum:null,gridIndex:0,series:[],seriesIndex:-1,seriesLabel:"",groups:e.event.groups,groupIndex:D,groupLabel:y,event:m,data:e.computedData})})}),ie(p,"mouseout").pipe($(u)).subscribe(e=>{console.log("rootMouseout"),le(g),pe(g)}),()=>{u.next(void 0),p.remove()}}),De=[[55,80,50,11,150],[35,40,15,65,120],[75,90,600,50,120],[50,60,445,80,110]];export{fe as G,De as g};
