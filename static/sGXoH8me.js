import{S as E,n as b,d as w,t as A,o as S,m as y,e as U,s as O,aI as q,at as G,aO as H}from"./D0O9ZvbE.js";import{j as P,n as J,g as C,h as I,o as K,q as Q}from"./CLAZhRXT.js";import{b as Z}from"./DdT0iQQs.js";const _=6;function N(v,k){return v.map((t,f)=>{const u=I(t,k),s=typeof u=="string"?u.split(`
`):[u];return{text:u,textArr:s}})}function ee({selection:v,groupingLabelClassName:k,fullParams:t,axisLabelAlign:f,gridAxesSize:u,fullDataFormatter:s,chartParams:h,textReverseTransform:R}){const c=t.tickPadding+t.labelOffset[0],a=t.tickPadding+t.labelOffset[1];let x=0,n=0;s.grid.groupAxis.position==="bottom"?(n=a,s.grid.valueAxis.position==="left"?x=c:s.grid.valueAxis.position==="right"&&(x=-c)):s.grid.groupAxis.position==="top"?(n=-a,s.grid.valueAxis.position==="left"?x=c:s.grid.valueAxis.position==="right"&&(x=-c)):s.grid.groupAxis.position==="left"?(x=-c,s.grid.valueAxis.position==="bottom"?n=-a:s.grid.valueAxis.position==="top"&&(n=a)):s.grid.groupAxis.position==="right"&&(x=c,s.grid.valueAxis.position==="bottom"?n=-a:s.grid.valueAxis.position==="top"&&(n=a)),v.selectAll(`g.${k}`).data([t]).join("g").classed(k,!0).each((r,m,T)=>{O(T[m]).selectAll("text").data([r]).join(g=>g.append("text").style("font-weight","bold"),g=>g,g=>g.remove()).attr("text-anchor",f.textAnchor).attr("dominant-baseline",f.dominantBaseline).attr("font-size",h.styles.textSize).style("fill",P(t.labelColorType,h)).style("transform",R).attr("x",x).attr("y",n).text(g=>s.grid.groupAxis.label)}).attr("transform",r=>`translate(${u.width}, 0)`)}function ie({selection:v,xAxisClassName:k,fullParams:t,tickTextAlign:f,gridAxesSize:u,fullDataFormatter:s,chartParams:h,groupScale:R,groupScaleDomain:c,groupLabelData:a,textReverseTransformWithRotate:x,textSizePx:n}){const r=v.selectAll(`g.${k}`).data([t]).join("g").classed(k,!0),m=Math.floor(c[1])-Math.ceil(c[0])+1;let T=0,g=0;s.grid.groupAxis.position==="left"?(T=0,g=-t.tickPadding):s.grid.groupAxis.position==="right"?(T=0,g=t.tickPadding):s.grid.groupAxis.position==="bottom"?(T=t.tickPadding,g=0):s.grid.groupAxis.position==="top"&&(T=-t.tickPadding,g=-0);const L=J(R).scale(R).ticks(t.ticks==="all"||t.ticks>m?m:t.ticks).tickSize(t.tickFullLine==!0?u.height:-_).tickSizeOuter(0).tickFormat(M=>{var z;return((z=a[M])==null?void 0:z.text)??""}).tickPadding(T),D=r.transition().duration(100).call(L).on("end",(M,z)=>{r.selectAll(".tick text").each((j,B,X)=>{var o;const i=((o=a[j])==null?void 0:o.textArr)??[];Z(O(X[B]),{textArr:i,textSizePx:n,groupAxisPosition:s.grid.groupAxis.position})})});return D.selectAll("line").style("fill","none").style("stroke",t.tickLineVisible==!0?P(t.tickColorType,h):"none").style("stroke-dasharray",t.tickFullLineDasharray).attr("pointer-events","none"),D.selectAll("path").style("fill","none").style("stroke",t.axisLineVisible==!0?P(t.axisLineColorType,h):"none").style("shape-rendering","crispEdges"),r.selectAll("text").attr("font-size",h.styles.textSize).attr("fill",P(t.tickTextColorType,h)).attr("text-anchor",f.textAnchor).attr("dominant-baseline",f.dominantBaseline).attr("x",g).style("transform",x).attr("dy",0),r}const ce=(v,{selection:k,computedData$:t,fullParams$:f,fullDataFormatter$:u,fullChartParams$:s,gridAxesTransform$:h,gridAxesReverseTransform$:R,gridAxesSize$:c,gridContainerPosition$:a,isSeriesSeprate$:x,textSizePx$:n})=>{const r=new E,m=C(v,"container"),T=C(v,"xAxisG"),g=C(v,"xAxis"),L=C(v,"groupingLabel"),D=b({computedData:t.pipe(w((e,l)=>e.length===l.length)),isSeriesSeprate:x}).pipe(A(r),S(async e=>e),y(e=>e.isSeriesSeprate?e.computedData:[e.computedData[0]]),y((e,l)=>k.selectAll(`g.${m}`).data(e,p=>p[0]?p[0].seriesIndex:l).join("g").classed(m,!0))),V=D.pipe(A(r),y((e,l)=>e.selectAll(`g.${T}`).data([T]).join("g").classed(T,!0)));b({containerSelection:D,gridContainerPosition:a}).pipe(A(r),S(async e=>e)).subscribe(e=>{e.containerSelection.attr("transform",(l,p)=>{const $=e.gridContainerPosition[p]??e.gridContainerPosition[0],Y=$.translate,W=$.scale;return`translate(${Y[0]}, ${Y[1]}) scale(${W[0]}, ${W[1]})`})}),b({axisSelection:V,gridAxesTransform:h}).pipe(A(r),S(async e=>e)).subscribe(e=>{e.axisSelection.style("transform",e.gridAxesTransform.value)});const M=b({gridAxesReverseTransform:R,gridContainerPosition:a}).pipe(A(r),S(async e=>e),y(e=>{const l=`rotateX(${e.gridAxesReverseTransform.rotateX}deg) rotateY(${e.gridAxesReverseTransform.rotateY}deg)`,p=`rotate(${e.gridAxesReverseTransform.rotate}deg)`,$=`scale(${1/e.gridContainerPosition[0].scale[0]}, ${1/e.gridContainerPosition[0].scale[1]})`;return`${l} ${p} ${$}`}),w()),z=b({textReverseTransform:M,fullParams:f}).pipe(A(r),S(async e=>e),y(e=>`${e.textReverseTransform} rotate(${e.fullParams.tickTextRotate}deg)`)),j=b({fullDataFormatter:u,gridAxesSize:c,computedData:t}).pipe(A(r),S(async e=>e),y(e=>{const l=e.computedData[0]?e.computedData[0].length-1:0,p=e.fullDataFormatter.grid.groupAxis.scaleDomain[0]-e.fullDataFormatter.grid.groupAxis.scalePadding,$=e.fullDataFormatter.grid.groupAxis.scaleDomain[1]==="max"?l+e.fullDataFormatter.grid.groupAxis.scalePadding:e.fullDataFormatter.grid.groupAxis.scaleDomain[1]+e.fullDataFormatter.grid.groupAxis.scalePadding;return[p,$]}),U(1)),B=b({groupScaleDomain:j,gridAxesSize:c}).pipe(A(r),S(async e=>e),y(e=>q().domain(e.groupScaleDomain).range([0,e.gridAxesSize.width]))),X=t.pipe(y(e=>(e[0]??[]).map(l=>l.groupLabel))),i=b({fullDataFormatter:u,fullParams:f}).pipe(A(r),S(async e=>e),y(e=>{let l="middle",p="hanging";return e.fullDataFormatter.grid.groupAxis.position==="bottom"?(l=e.fullParams.tickTextRotate?"end":"middle",p="hanging"):e.fullDataFormatter.grid.groupAxis.position==="top"?(l=e.fullParams.tickTextRotate?"start":"middle",p="auto"):e.fullDataFormatter.grid.groupAxis.position==="left"?(l="end",p="middle"):e.fullDataFormatter.grid.groupAxis.position==="right"&&(l="start",p="middle"),{textAnchor:l,dominantBaseline:p}})),o=u.pipe(A(r),y(e=>{let l="start",p="hanging";return e.grid.groupAxis.position==="bottom"?p="hanging":e.grid.groupAxis.position==="top"?p="auto":e.grid.groupAxis.position==="left"?l="end":e.grid.groupAxis.position==="right"&&(l="start"),e.grid.valueAxis.position==="left"?l="start":e.grid.valueAxis.position==="right"?l="end":e.grid.valueAxis.position==="bottom"?p="auto":e.grid.valueAxis.position==="top"&&(p="hanging"),{textAnchor:l,dominantBaseline:p}})),d=b({groupLabels:X,fullParams:f}).pipe(A(r),S(async e=>e),y(e=>N(e.groupLabels,e.fullParams.tickFormat)));return b({axisSelection:V,fullParams:f,tickTextAlign:i,axisLabelAlign:o,gridAxesSize:c,fullDataFormatter:u,chartParams:s,groupScale:B,groupScaleDomain:j,groupLabelData:d,textReverseTransform:M,textReverseTransformWithRotate:z,textSizePx:n}).pipe(A(r),S(async e=>e)).subscribe(e=>{ie({selection:e.axisSelection,xAxisClassName:g,fullParams:e.fullParams,tickTextAlign:e.tickTextAlign,gridAxesSize:e.gridAxesSize,fullDataFormatter:e.fullDataFormatter,chartParams:e.chartParams,groupScale:e.groupScale,groupScaleDomain:e.groupScaleDomain,groupLabelData:e.groupLabelData,textReverseTransformWithRotate:e.textReverseTransformWithRotate,textSizePx:e.textSizePx}),ee({selection:e.axisSelection,groupingLabelClassName:L,fullParams:e.fullParams,axisLabelAlign:e.axisLabelAlign,gridAxesSize:e.gridAxesSize,fullDataFormatter:e.fullDataFormatter,chartParams:e.chartParams,textReverseTransform:e.textReverseTransform})}),()=>{r.next(void 0)}},te=6;function se({selection:v,textClassName:k,fullParams:t,axisLabelAlign:f,gridAxesSize:u,fullDataFormatter:s,fullChartParams:h,textReverseTransform:R}){const c=t.tickPadding-t.labelOffset[0],a=t.tickPadding+t.labelOffset[1];let x=0,n=0;s.grid.groupAxis.position==="bottom"?(n=-a,s.grid.valueAxis.position==="left"?x=-c:s.grid.valueAxis.position==="right"&&(x=c)):s.grid.groupAxis.position==="top"?(n=a,s.grid.valueAxis.position==="left"?x=-c:s.grid.valueAxis.position==="right"&&(x=c)):s.grid.groupAxis.position==="left"?(x=c,s.grid.valueAxis.position==="bottom"?n=a:s.grid.valueAxis.position==="top"&&(n=-a)):s.grid.groupAxis.position==="right"&&(x=-c,s.grid.valueAxis.position==="bottom"?n=a:s.grid.valueAxis.position==="top"&&(n=-a)),v.selectAll(`g.${k}`).data([t]).join("g").classed(k,!0).each((r,m,T)=>{O(T[m]).selectAll("text").data([r]).join(g=>g.append("text").style("font-weight","bold"),g=>g,g=>g.remove()).attr("text-anchor",f.textAnchor).attr("dominant-baseline",f.dominantBaseline).attr("font-size",h.styles.textSize).style("fill",P(t.labelColorType,h)).style("transform",R).attr("x",x).attr("y",n).text(g=>s.grid.valueAxis.label)}).attr("transform",r=>`translate(0, ${u.height})`)}function oe({selection:v,yAxisClassName:k,fullParams:t,tickTextAlign:f,gridAxesSize:u,fullDataFormatter:s,fullChartParams:h,valueScale:R,textReverseTransformWithRotate:c,minAndMax:a}){const x=v.selectAll(`g.${k}`).data([t]).join("g").classed(k,!0),n=a[1]-a[0];let r=0,m=0;s.grid.valueAxis.position==="left"?(r=t.tickPadding,m=0):s.grid.valueAxis.position==="right"?(r=-t.tickPadding,m=0):s.grid.valueAxis.position==="bottom"?(r=0,m=t.tickPadding):s.grid.valueAxis.position==="top"&&(r=0,m=-t.tickPadding);const T=K(R).scale(R).ticks(n>t.ticks?t.ticks:a[0]===0&&a[1]===0?1:Math.ceil(n)).tickFormat(D=>I(D,t.tickFormat)).tickSize(t.tickFullLine==!0?-u.width:te).tickPadding(r),g=x.transition().duration(100).call(T);g.selectAll("line").style("fill","none").style("stroke",t.tickLineVisible==!0?P(t.tickColorType,h):"none").style("stroke-dasharray",t.tickFullLineDasharray).attr("pointer-events","none"),g.selectAll("path").style("fill","none").style("stroke",t.axisLineVisible==!0?P(t.axisLineColorType,h):"none").style("shape-rendering","crispEdges");const L=x.selectAll("text").attr("font-size",h.styles.textSize).style("color",P(t.tickTextColorType,h)).attr("text-anchor",f.textAnchor).attr("dominant-baseline",f.dominantBaseline).attr("y",m);return L.style("transform",c),(s.grid.valueAxis.position==="bottom"||s.grid.valueAxis.position==="top")&&L.attr("dy",0),x}const ge=(v,{selection:k,computedData$:t,fullParams$:f,fullDataFormatter$:u,fullChartParams$:s,gridAxesTransform$:h,gridAxesReverseTransform$:R,gridAxesSize$:c,gridContainerPosition$:a,isSeriesSeprate$:x})=>{const n=new E,r=C(v,"container"),m=C(v,"yAxisG"),T=C(v,"yAxis"),g=C(v,"text"),L=b({computedData:t.pipe(w((i,o)=>i.length===o.length)),isSeriesSeprate:x}).pipe(A(n),S(async i=>i),y(i=>i.isSeriesSeprate?i.computedData:[i.computedData[0]]),y((i,o)=>k.selectAll(`g.${r}`).data(i,d=>d[0]?d[0].seriesIndex:o).join("g").classed(r,!0))),D=L.pipe(A(n),y((i,o)=>i.selectAll(`g.${m}`).data([m]).join("g").classed(m,!0)));b({containerSelection:L,gridContainerPosition:a}).pipe(A(n),S(async i=>i)).subscribe(i=>{i.containerSelection.attr("transform",(o,d)=>{const e=i.gridContainerPosition[d]??i.gridContainerPosition[0],l=e.translate,p=e.scale;return`translate(${l[0]}, ${l[1]}) scale(${p[0]}, ${p[1]})`})}),b({axisSelection:D,gridAxesTransform:h}).pipe(A(n),S(async i=>i)).subscribe(i=>{i.axisSelection.style("transform",i.gridAxesTransform.value)});const V=b({gridAxesReverseTransform:R,gridContainerPosition:a}).pipe(A(n),S(async i=>i),y(i=>{const o=`rotateX(${i.gridAxesReverseTransform.rotateX}deg) rotateY(${i.gridAxesReverseTransform.rotateY}deg)`,d=`rotate(${i.gridAxesReverseTransform.rotate}deg)`,e=`scale(${1/i.gridContainerPosition[0].scale[0]}, ${1/i.gridContainerPosition[0].scale[1]})`;return`${o} ${d} ${e}`}),w()),M=b({textReverseTransform:V,fullParams:f}).pipe(A(n),S(async i=>i),y(i=>`${i.textReverseTransform} rotate(${i.fullParams.tickTextRotate}deg)`)),z=new G(i=>{b({fullDataFormatter:u,gridAxesSize:c,computedData:t}).pipe(A(n),S(async o=>o)).subscribe(o=>{const d=o.computedData[0]?o.computedData[0].length-1:0,e=o.fullDataFormatter.grid.groupAxis.scaleDomain[0]-o.fullDataFormatter.grid.groupAxis.scalePadding,l=o.fullDataFormatter.grid.groupAxis.scaleDomain[1]==="max"?d+o.fullDataFormatter.grid.groupAxis.scalePadding:o.fullDataFormatter.grid.groupAxis.scaleDomain[1]+o.fullDataFormatter.grid.groupAxis.scalePadding,p=o.computedData.map((Y,W)=>Y.filter((ne,F)=>F>=e&&F<=l)),$=Q(p.flat());$[0]===$[1]&&($[0]=$[1]-1),i.next($)})}),j=new G(i=>{b({fullDataFormatter:u,gridAxesSize:c,minAndMax:z}).pipe(A(n),S(async o=>o)).subscribe(o=>{const d=H({maxValue:o.minAndMax[1],minValue:o.minAndMax[0],axisWidth:o.gridAxesSize.height,scaleDomain:o.fullDataFormatter.grid.valueAxis.scaleDomain,scaleRange:o.fullDataFormatter.grid.valueAxis.scaleRange});i.next(d)})}),B=b({fullDataFormatter:u,fullParams:f}).pipe(A(n),S(async i=>i),y(i=>{let o="start",d="hanging";return i.fullDataFormatter.grid.valueAxis.position==="left"?(o="end",d="middle"):i.fullDataFormatter.grid.valueAxis.position==="right"?(o="start",d="middle"):i.fullDataFormatter.grid.valueAxis.position==="bottom"?(o=i.fullParams.tickTextRotate?"end":"middle",d="hanging"):i.fullDataFormatter.grid.valueAxis.position==="top"&&(o=i.fullParams.tickTextRotate?"start":"middle",d="auto"),{textAnchor:o,dominantBaseline:d}})),X=u.pipe(A(n),y(i=>{let o="start",d="hanging";return i.grid.groupAxis.position==="bottom"?d="auto":i.grid.groupAxis.position==="top"?d="hanging":i.grid.groupAxis.position==="left"?o="start":i.grid.groupAxis.position==="right"&&(o="end"),i.grid.valueAxis.position==="left"?o="end":i.grid.valueAxis.position==="right"?o="start":i.grid.valueAxis.position==="bottom"?d="hanging":i.grid.valueAxis.position==="top"&&(d="auto"),{textAnchor:o,dominantBaseline:d}}));return b({axisSelection:D,fullParams:f,tickTextAlign:B,axisLabelAlign:X,computedData:t,gridAxesSize:c,fullDataFormatter:u,fullChartParams:s,valueScale:j,textReverseTransform:V,textReverseTransformWithRotate:M,minAndMax:z}).pipe(A(n),S(async i=>i)).subscribe(i=>{oe({selection:i.axisSelection,yAxisClassName:T,fullParams:i.fullParams,tickTextAlign:i.tickTextAlign,gridAxesSize:i.gridAxesSize,fullDataFormatter:i.fullDataFormatter,fullChartParams:i.fullChartParams,valueScale:i.valueScale,textReverseTransformWithRotate:i.textReverseTransformWithRotate,minAndMax:i.minAndMax}),se({selection:i.axisSelection,textClassName:g,fullParams:i.fullParams,axisLabelAlign:i.axisLabelAlign,gridAxesSize:i.gridAxesSize,fullDataFormatter:i.fullDataFormatter,fullChartParams:i.fullChartParams,textReverseTransform:i.textReverseTransform})}),()=>{n.next(void 0)}};export{ce as a,ge as c};
