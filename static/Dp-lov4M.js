import{a6 as he,a7 as xe,a8 as fe,a9 as $e,O as J,aa as O,S as Y,t as $,m as T,d as H,i as F,j as z,s as B,A as K,ab as De,ac as Ae,ad as ye,ae as Le,af as Se}from"./hQFDSd1w.js";import{c as ne,d as Pe,e as Te,f as be,g as Q,h as re,i as Ie,j as Ge}from"./CrPrLvvz.js";import{k as ce,l as pe}from"./C1ZudAwN.js";import{f as Me}from"./C3MF7qht.js";import{c as Ce}from"./CvnMrnyQ.js";import{c as Fe}from"./CTQxU0vj.js";import{m as ve,a as we}from"./Dmk-7pGf.js";var Ee=["addListener","removeListener"],Re=["addEventListener","removeEventListener"],ze=["on","off"];function ae(r,o,e,n){if(O(e)&&(n=e,e=void 0),n)return ae(r,o,e).pipe(he(n));var a=xe(Ue(r)?Re.map(function(s){return function(p){return r[s](o,p,e)}}):_e(r)?Ee.map(oe(r,o)):ke(r)?ze.map(oe(r,o)):[],2),l=a[0],m=a[1];if(!l&&fe(r))return ve(function(s){return ae(s,o,e)})($e(r));if(!l)throw new TypeError("Invalid event target");return new J(function(s){var p=function(){for(var g=[],P=0;P<arguments.length;P++)g[P]=arguments[P];return s.next(1<g.length?g:g[0])};return l(p),function(){return m(p)}})}function oe(r,o){return function(e){return function(n){return r[e](o,n)}}}function _e(r){return O(r.addListener)&&O(r.removeListener)}function ke(r){return O(r.on)&&O(r.off)}function Ue(r){return O(r.addEventListener)&&O(r.removeEventListener)}function Ne(r="curveLinear",o){return Te().x(e=>e.axisX).y0(e=>o).y1(e=>e.axisY).curve(be[r])}function He(r){let o=[[]],e=0;for(let n in r){if(r[n].visible==!1||r[n].value===void 0||r[n].value===null){o[e].length&&(e++,o[e]=[]);continue}o[e].push(r[n])}return o}function Oe({selection:r,pathClassName:o,segmentData:e,areaPath:n,linearGradientIds:a,params:l}){return r.selectAll("path").data(e,(s,p)=>s.length?`${s[0].id}_${s[s.length-1].id}`:p).join(s=>s.append("path").classed(o,!0).attr("fill","none").style("vector-effect","non-scaling-stroke").style("cursor","pointer"),s=>s,s=>s.remove()).attr("fill",(s,p)=>s[0]?`url(#${a[s[0].seriesIndex]})`:"").attr("d",s=>n(s))}function Ve({selection:r,seriesLabel:o,fullChartParams:e}){if(r.interrupt("highlight"),!o){r.transition("highlight").duration(200).style("opacity",1);return}r.each((n,a,l)=>{n===o?B(l[a]).style("opacity",1):B(l[a]).style("opacity",e.styles.unhighlightedOpacity)})}function Be({defsSelection:r,computedData:o,linearGradientIds:e,params:n}){r.selectAll("linearGradient").data(o??[]).join(a=>a.append("linearGradient").attr("x1","0%").attr("x2","0%").attr("y1","100%").attr("y2","0%").attr("spreadMethod","pad"),a=>a,a=>a.remove()).attr("id",(a,l)=>a[0]?e[a[0].seriesIndex]:"").html((a,l)=>{const m=a[0]?a[0].color:"";return`
        <stop offset="0%"   stop-color="${m}" stop-opacity="${n.linearGradientOpacity[0]}"/>
        <stop offset="100%" stop-color="${m}" stop-opacity="${n.linearGradientOpacity[1]}"/>
      `})}function Xe({defsSelection:r,clipPathData:o,transitionDuration:e,transitionEase:n}){r.selectAll("clipPath").data(o).join(a=>a.append("clipPath"),a=>a,a=>a.remove()).attr("id",a=>a.id).each((a,l,m)=>{B(m[l]).selectAll("rect").data([a]).join(s=>{const p=s.append("rect");return p.transition().duration(e).ease(Pe(n)).tween("tween",(g,P,f)=>b=>{const M=g.width*b;p.attr("x",0).attr("y",0).attr("width",S=>M).attr("height",S=>S.height)}),p},s=>s.attr("x",0).attr("y",0).attr("width",p=>p.width).attr("height",p=>p.height),s=>s.remove())})}const je=(r,{selection:o,computedData$:e,computedLayoutData$:n,visibleComputedData$:a,visibleComputedLayoutData$:l,seriesLabels$:m,SeriesDataMap$:s,GroupDataMap$:p,fullParams$:g,fullDataFormatter$:P,fullChartParams$:f,gridAxesTransform$:b,gridGraphicTransform$:M,gridAxesSize$:S,gridHighlight$:I,gridContainerPosition$:G,layout$:V,event$:v})=>{const D=new Y,i=ne(r,"clipPath-box"),c=Q(r,"path"),{seriesSelection$:L,axesSelection$:h,defsSelection$:w,graphicGSelection$:E}=ce({selection:o,pluginName:r,clipPathID:i,seriesLabels$:m,gridContainerPosition$:G,gridAxesTransform$:b,gridGraphicTransform$:M}),X=M.pipe($(D),T(t=>-t.translate[1]/t.scale[1])),j=new J(t=>{const A=F({fullParams:g,valueAxisStart:X}).pipe($(D)).subscribe(x=>{const d=Ne(x.fullParams.lineCurve,x.valueAxisStart);t.next(d)});return()=>{A.unsubscribe()}}),y=f.pipe(T(t=>t.transitionDuration),H()),_=f.pipe(T(t=>t.transitionEase),H());F({defsSelection:w,seriesLabels:m,axisSize:S,transitionDuration:y,transitionEase:_}).pipe($(D),z(async t=>t)).subscribe(t=>{const x=[{id:i,width:t.axisSize.width,height:t.axisSize.height}].concat(t.seriesLabels.map(d=>({id:`orbcharts__clipPath_${d}`,width:t.axisSize.width,height:t.axisSize.height})));Xe({defsSelection:t.defsSelection,clipPathData:x,transitionDuration:t.transitionDuration,transitionEase:t.transitionEase})});const Z=e.pipe(T(t=>{const A=new Map;return t.flat().forEach(x=>A.set(x.id,x)),A})),k=pe({fullDataFormatter$:P,gridAxesSize$:S,computedData$:e,fullChartParams$:f}),R=f.pipe($(D),T(t=>t.highlightTarget),H()),me=m.pipe($(D),T(t=>t.map((A,x)=>ne(r,`lineargradient-${A}`)))),de=F({graphicGSelection:E,defsSelection:w,visibleComputedLayoutData:l,linearGradientIds:me,areaPath:j,params:g}).pipe($(D),z(async t=>t),T(t=>{let A=[];return t.graphicGSelection.each((x,d,C)=>{const W=He(t.visibleComputedLayoutData[d]??[]);A[d]=Oe({selection:B(C[d]),pathClassName:c,areaPath:t.areaPath,segmentData:W,linearGradientIds:t.linearGradientIds,params:t.params}),Be({defsSelection:t.defsSelection,computedData:t.visibleComputedLayoutData,linearGradientIds:t.linearGradientIds,params:t.params})}),A}));return F({pathSelectionArr:de,computedData:e,SeriesDataMap:s,GroupDataMap:p,highlightTarget:R,gridGroupPositionFn:k}).pipe($(D),z(async t=>t)).subscribe(t=>{t.pathSelectionArr.forEach(A=>{A.on("mouseover",(x,d)=>{const C=d[0]?d[0].seriesLabel:"",{groupIndex:W,groupLabel:U}=t.gridGroupPositionFn(x),u=t.GroupDataMap.get(U).find(N=>N.seriesLabel===C)??d[0];v.next({type:"grid",eventName:"mouseover",pluginName:r,highlightTarget:t.highlightTarget,datum:u,gridIndex:u.gridIndex,series:t.SeriesDataMap.get(u.seriesLabel),seriesIndex:u.seriesIndex,seriesLabel:u.seriesLabel,groups:t.GroupDataMap.get(u.groupLabel),groupIndex:u.groupIndex,groupLabel:u.groupLabel,event:x,data:t.computedData})}).on("mousemove",(x,d)=>{const C=d[0]?d[0].seriesLabel:"",{groupIndex:W,groupLabel:U}=t.gridGroupPositionFn(x),u=t.GroupDataMap.get(U).find(N=>N.seriesLabel===C)??d[0];v.next({type:"grid",eventName:"mousemove",pluginName:r,highlightTarget:t.highlightTarget,datum:u,gridIndex:u.gridIndex,series:t.SeriesDataMap.get(u.seriesLabel),seriesIndex:u.seriesIndex,seriesLabel:u.seriesLabel,groups:t.GroupDataMap.get(u.groupLabel),groupIndex:u.groupIndex,groupLabel:u.groupLabel,event:x,data:t.computedData})}).on("mouseout",(x,d)=>{const C=d[0]?d[0].seriesLabel:"",{groupIndex:W,groupLabel:U}=t.gridGroupPositionFn(x),u=t.GroupDataMap.get(U).find(N=>N.seriesLabel===C)??d[0];v.next({type:"grid",eventName:"mouseout",pluginName:r,highlightTarget:t.highlightTarget,datum:u,gridIndex:u.gridIndex,series:t.SeriesDataMap.get(u.seriesLabel),seriesIndex:u.seriesIndex,seriesLabel:u.seriesLabel,groups:t.GroupDataMap.get(u.groupLabel),groupIndex:u.groupIndex,groupLabel:u.groupLabel,event:x,data:t.computedData})}).on("click",(x,d)=>{const C=d[0]?d[0].seriesLabel:"",{groupIndex:W,groupLabel:U}=t.gridGroupPositionFn(x),u=t.GroupDataMap.get(U).find(N=>N.seriesLabel===C)??d[0];v.next({type:"grid",eventName:"click",pluginName:r,highlightTarget:t.highlightTarget,datum:u,gridIndex:u.gridIndex,series:t.SeriesDataMap.get(u.seriesLabel),seriesIndex:u.seriesIndex,seriesLabel:u.seriesLabel,groups:t.GroupDataMap.get(u.groupLabel),groupIndex:u.groupIndex,groupLabel:u.groupLabel,event:x,data:t.computedData})})})}),f.pipe($(D),Me(t=>t.highlightTarget==="series"),z(t=>F({graphicGSelection:E,gridHighlight:I,DataMap:Z,fullChartParams:f}).pipe($(D),z(async A=>A)))).subscribe(t=>{const A=t.gridHighlight[0]?t.gridHighlight[0].seriesLabel:null;Ve({selection:t.graphicGSelection,seriesLabel:A,fullChartParams:t.fullChartParams})}),()=>{D.next(void 0)}},se="LineAreas",ot=K(se,De)(({selection:r,name:o,observer:e,subject:n})=>{const a=new Y,l=je(se,{selection:r,computedData$:e.computedData$,visibleComputedData$:e.visibleComputedData$,computedLayoutData$:e.computedLayoutData$,visibleComputedLayoutData$:e.visibleComputedLayoutData$,seriesLabels$:e.seriesLabels$,SeriesDataMap$:e.SeriesDataMap$,GroupDataMap$:e.GroupDataMap$,fullParams$:e.fullParams$,fullDataFormatter$:e.fullDataFormatter$,fullChartParams$:e.fullChartParams$,gridAxesTransform$:e.gridAxesTransform$,gridGraphicTransform$:e.gridGraphicTransform$,gridAxesSize$:e.gridAxesSize$,gridHighlight$:e.gridHighlight$,gridContainerPosition$:e.gridContainerPosition$,layout$:e.layout$,event$:n.event$});return()=>{a.next(void 0),l()}}),le="Dots",st=K(le,Ae)(({selection:r,name:o,subject:e,observer:n})=>{const a=new Y,l=Ce(le,{selection:r,computedData$:n.computedData$,computedLayoutData$:n.computedLayoutData$,visibleComputedData$:n.visibleComputedData$,visibleComputedLayoutData$:n.visibleComputedLayoutData$,seriesLabels$:n.seriesLabels$,SeriesDataMap$:n.SeriesDataMap$,GroupDataMap$:n.GroupDataMap$,fullParams$:n.fullParams$,fullChartParams$:n.fullChartParams$,gridAxesTransform$:n.gridAxesTransform$,gridGraphicTransform$:n.gridGraphicTransform$,gridGraphicReverseScale$:n.gridGraphicReverseScale$,gridAxesSize$:n.gridAxesSize$,gridHighlight$:n.gridHighlight$,gridContainerPosition$:n.gridContainerPosition$,event$:e.event$});return()=>{a.next(void 0),l()}}),ue="ValueStackAxis",lt=K(ue,ye)(({selection:r,name:o,observer:e,subject:n})=>{const a=new Y,l=Fe(ue,{selection:r,computedData$:e.computedStackedData$,fullParams$:e.fullParams$,fullDataFormatter$:e.fullDataFormatter$,fullChartParams$:e.fullChartParams$,gridAxesTransform$:e.gridAxesTransform$,gridAxesReverseTransform$:e.gridAxesReverseTransform$,gridAxesSize$:e.gridAxesSize$,gridContainerPosition$:e.gridContainerPosition$,isSeriesSeprate$:e.isSeriesSeprate$});return()=>{a.next(void 0),l()}});function ge(r,o){let e=new J(()=>{});return r.each(function(){const n=ae(this,o);e=we(e,n)}),e}const q="GroupAux",ie=Q(q,"label-box");function We({groupLabel:r,axisX:o,axisHeight:e,fullParams:n}){return n.showLine&&r?[{id:r,x1:o,x2:o,y1:0,y2:e}]:[]}function Ye({selection:r,pluginName:o,lineData:e,fullParams:n,fullChartParams:a}){const l=Q(o,"auxline"),m=r.selectAll(`line.${l}`).data(e),s=m.enter().append("line").classed(l,!0).style("stroke",g=>re(n.lineColorType,a)).style("stroke-width",1).style("stroke-dasharray",n.lineDashArray??"none").style("pointer-events","none"),p=m.merge(s);return m.exit().remove(),s.attr("x1",g=>g.x1).attr("y1",g=>g.y1).attr("x2",g=>g.x2).attr("y2",g=>g.y2),m.transition().duration(50).attr("x1",g=>g.x1).attr("y1",g=>g.y1).attr("x2",g=>g.x2).attr("y2",g=>g.y2),p}function qe(r){r.selectAll("line").data([]).exit().remove()}function Je({groupLabel:r,axisX:o,fullParams:e}){return e.showLabel&&r?[{id:r,x:o,y:-e.labelPadding,text:Ie(r,e.labelTextFormat)}]:[]}function Ke({selection:r,labelData:o,fullParams:e,fullDataFormatter:n,fullChartParams:a,labelTransform:l,textSizePx:m}){const s=m+4,p=r.selectAll(`g.${ie}`).data(o),g=p.enter().append("g").classed(ie,!0).style("cursor","pointer"),P=g.merge(p);return g.attr("transform",(f,b)=>`translate(${f.x}, ${f.y})`),p.transition().duration(50).attr("transform",(f,b)=>`translate(${f.x}, ${f.y})`),p.exit().remove(),P.each((f,b,M)=>{const S=Ge(f.text,m)+12;let I=-S/2,G=-2;n.grid.groupAxis.position==="bottom"?(I=-S/2,G=2):n.grid.groupAxis.position==="left"?(I=-S+2,G=-s/2):n.grid.groupAxis.position==="right"?(I=-2,G=-s/2):n.grid.groupAxis.position==="top"&&(I=-S/2,G=-s+2);const V=B(M[b]).selectAll("rect").data([f]),v=V.enter().append("rect").attr("height",`${s}px`).attr("fill",c=>re(e.labelColorType,a)).attr("x",I).attr("y",G).attr("rx",5).attr("ry",5).style("cursor","pointer");V.merge(v).attr("width",c=>`${S}px`).style("transform",l),V.exit().remove();const D=B(M[b]).selectAll("text").data([f]),i=D.enter().append("text").style("dominant-baseline","hanging").style("cursor","pointer");D.merge(i).text(c=>c.text).style("transform",l).attr("fill",c=>re(e.labelTextColorType,a)).attr("font-size",a.styles.textSize).attr("x",I+6).attr("y",G),D.exit().remove()}),P}function Qe(r){r.selectAll(`g.${ie}`).data([]).exit().remove()}const ut=K(q,Le)(({selection:r,rootSelection:o,name:e,subject:n,observer:a})=>{const l=new Y;let m=!1;const s=o.insert("rect","g").classed(Q(q,"rect"),!0).attr("opacity",0),{seriesSelection$:p,axesSelection$:g,defsSelection$:P,graphicGSelection$:f}=ce({selection:r,pluginName:q,clipPathID:"test",seriesLabels$:a.seriesLabels$,gridContainerPosition$:a.gridContainerPosition$,gridAxesTransform$:a.gridAxesTransform$,gridGraphicTransform$:a.gridGraphicTransform$});a.layout$.pipe($(l)).subscribe(i=>{s.attr("width",i.rootWidth).attr("height",i.rootHeight)});const b=new J(i=>{F({fullDataFormatter:a.fullDataFormatter$,gridAxesSize:a.gridAxesSize$,computedData:a.computedData$}).pipe($(l),z(async c=>c)).subscribe(c=>{const h=c.computedData[0]?c.computedData[0].length-1:0,w=c.fullDataFormatter.grid.groupAxis.scaleDomain[0]==="auto"?0-c.fullDataFormatter.grid.groupAxis.scalePadding:c.fullDataFormatter.grid.groupAxis.scaleDomain[0]-c.fullDataFormatter.grid.groupAxis.scalePadding,E=c.fullDataFormatter.grid.groupAxis.scaleDomain[1]==="auto"?h+c.fullDataFormatter.grid.groupAxis.scalePadding:c.fullDataFormatter.grid.groupAxis.scaleDomain[1]+c.fullDataFormatter.grid.groupAxis.scalePadding,X=c.computedData[0]?c.computedData[0].length:0;let j=c.fullDataFormatter.grid.seriesDirection==="row"?(c.computedData[0]??[]).map(k=>k.groupLabel):c.computedData.map(k=>k[0].groupLabel);const y=new Array(X).fill(0).map((k,R)=>j[R]!=null?j[R]:String(R)).filter((k,R)=>R>=w&&R<=E),_=c.fullDataFormatter.grid.groupAxis.scalePadding,Z=Se({axisLabels:y,axisWidth:c.gridAxesSize.width,padding:_});i.next(Z)})}),M=pe({fullDataFormatter$:a.fullDataFormatter$,gridAxesSize$:a.gridAxesSize$,computedData$:a.computedData$,fullChartParams$:a.fullChartParams$}),S=a.fullChartParams$.pipe($(l),T(i=>i.highlightTarget),H()),I=ge(o,"mousemove").pipe($(l)),G=F({fullParams:a.fullParams$,fullDataFormatter:a.fullDataFormatter$,gridAxesReverseTransform:a.gridAxesReverseTransform$,gridContainerPosition:a.gridContainerPosition$}).pipe($(l),z(async i=>i),T(i=>{const c=`translate(${i.gridAxesReverseTransform.translate[0]}px, ${i.gridAxesReverseTransform.translate[1]}px)`,L=`rotate(${i.gridAxesReverseTransform.rotate}deg) rotateX(${i.gridAxesReverseTransform.rotateX}deg) rotateY(${i.gridAxesReverseTransform.rotateY}deg)`,h=`scale(${1/i.gridContainerPosition[0].scale[0]}, ${1/i.gridContainerPosition[0].scale[1]})`,E=`rotate(${i.fullDataFormatter.grid.groupAxis.position==="left"&&i.fullDataFormatter.grid.valueAxis.position==="top"||i.fullDataFormatter.grid.groupAxis.position==="right"&&i.fullDataFormatter.grid.valueAxis.position==="bottom"?180:0}deg)`;return`${c} ${L} ${h} ${E}`}),H()),V=a.gridContainerPosition$.pipe($(l),T(i=>i.reduce((L,h)=>h.columnIndex>L?h.columnIndex:L,0)+1),H()),v=a.gridContainerPosition$.pipe($(l),T(i=>i.reduce((L,h)=>h.rowIndex>L?h.rowIndex:L,0)+1),H());F({axesSelection:g,columnAmount:V,rowAmount:v,layout:a.layout$,rootMousemove:I,gridGroupPositionFn:M,computedData:a.computedData$,groupScale:b,gridAxesSize:a.gridAxesSize$,fullParams:a.fullParams$,fullDataFormatter:a.fullDataFormatter$,fullChartParams:a.fullChartParams$,highlightTarget:S,labelTransform:G,GroupDataMap:a.GroupDataMap$,textSizePx:a.textSizePx$}).subscribe(i=>{const c={offsetX:i.rootMousemove.offsetX*i.columnAmount%i.layout.rootWidth,offsetY:i.rootMousemove.offsetY*i.rowAmount%i.layout.rootHeight},{groupIndex:L,groupLabel:h}=i.gridGroupPositionFn(c),w=i.groupScale(h)??0,E=We({groupLabel:h,axisX:w,axisHeight:i.gridAxesSize.height,fullParams:i.fullParams});Ye({selection:i.axesSelection,pluginName:e,lineData:E,fullParams:i.fullParams,fullChartParams:i.fullChartParams});const X=Je({groupLabel:h,axisX:w,fullParams:i.fullParams});Ke({selection:i.axesSelection,labelData:X,fullParams:i.fullParams,fullDataFormatter:i.fullDataFormatter,fullChartParams:i.fullChartParams,labelTransform:i.labelTransform,textSizePx:i.textSizePx}).on("mouseover",(y,_)=>{y.stopPropagation(),m=!0,n.event$.next({type:"grid",pluginName:e,eventName:"mouseover",highlightTarget:i.highlightTarget,datum:null,gridIndex:0,series:[],seriesIndex:-1,seriesLabel:"",groups:i.GroupDataMap.get(h)??[],groupIndex:L,groupLabel:h,event:y,data:i.computedData})}).on("mousemove",(y,_)=>{y.stopPropagation(),n.event$.next({type:"grid",pluginName:e,eventName:"mousemove",highlightTarget:i.highlightTarget,datum:null,gridIndex:0,series:[],seriesIndex:-1,seriesLabel:"",groups:i.GroupDataMap.get(h)??[],groupIndex:L,groupLabel:h,event:y,data:i.computedData})}).on("mouseout",(y,_)=>{y.stopPropagation(),m=!1,n.event$.next({type:"grid",pluginName:e,eventName:"mouseout",highlightTarget:i.highlightTarget,datum:null,gridIndex:0,series:[],seriesIndex:-1,seriesLabel:"",groups:i.GroupDataMap.get(h)??[],groupIndex:L,groupLabel:h,event:y,data:i.computedData})}).on("click",(y,_)=>{y.stopPropagation(),n.event$.next({type:"grid",pluginName:e,eventName:"click",highlightTarget:i.highlightTarget,datum:null,gridIndex:0,series:[],seriesIndex:-1,seriesLabel:"",groups:i.GroupDataMap.get(h)??[],groupIndex:L,groupLabel:h,event:y,data:i.computedData})})});const D=ge(s,"mouseout").pipe($(l));return F({rootRectMouseout:D,axesSelection:g}).pipe($(l),z(async i=>i)).subscribe(i=>{setTimeout(()=>{m!=!0&&(qe(i.axesSelection),Qe(i.axesSelection))})}),()=>{l.next(void 0),s.remove()}}),gt=[[55,80,50,11,150],[35,40,15,65,120]];export{st as D,ut as G,ot as L,lt as V,je as c,gt as g};
