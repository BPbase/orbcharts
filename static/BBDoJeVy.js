import{aH as Pe,aI as re,aJ as me,aK as ge,aL as Ce,aM as _,aN as Ge,aO as O,a1 as ke,aP as Ie,c as Te,a3 as Ne,aQ as Re,a9 as Y,aa as N,a7 as k,a5 as se,ac as ue,ad as Oe,aR as pe,ag as de,g as Ee,aS as Ve,aT as Xe,aU as Ye,aF as je,al as le,aV as T,m as M,i as E,o as w,p as S,h as J,s as ne,S as ze,t as We,aW as Ae}from"./E1orKXwV.js";import{g as te}from"./EQqw3RI0.js";import{m as Ue,a as He}from"./CrtVkC9x.js";function q(e,n){return e==null||n==null?NaN:e<n?-1:e>n?1:e>=n?0:NaN}function qe(e,n){return e==null||n==null?NaN:n<e?-1:n>e?1:n>=e?0:NaN}function we(e){let n,r,t;e.length!==2?(n=q,r=(u,l)=>q(e(u),l),t=(u,l)=>e(u)-l):(n=e===q||e===qe?e:Je,r=e,t=e);function o(u,l,s=0,g=u.length){if(s<g){if(n(l,l)!==0)return g;do{const m=s+g>>>1;r(u[m],l)<0?s=m+1:g=m}while(s<g)}return s}function a(u,l,s=0,g=u.length){if(s<g){if(n(l,l)!==0)return g;do{const m=s+g>>>1;r(u[m],l)<=0?s=m+1:g=m}while(s<g)}return s}function i(u,l,s=0,g=u.length){const m=o(u,l,s,g-1);return m>s&&t(u[m-1],l)>-t(u[m],l)?m-1:m}return{left:o,center:i,right:a}}function Je(){return 0}function Be(e){return e===null?NaN:+e}const Qe=we(q),Ze=Qe.right;we(Be).center;const Ke=Math.sqrt(50),_e=Math.sqrt(10),en=Math.sqrt(2);function B(e,n,r){const t=(n-e)/Math.max(0,r),o=Math.floor(Math.log10(t)),a=t/Math.pow(10,o),i=a>=Ke?10:a>=_e?5:a>=en?2:1;let u,l,s;return o<0?(s=Math.pow(10,-o)/i,u=Math.round(e*s),l=Math.round(n*s),u/s<e&&++u,l/s>n&&--l,s=-s):(s=Math.pow(10,o)*i,u=Math.round(e/s),l=Math.round(n/s),u*s<e&&++u,l*s>n&&--l),l<u&&.5<=r&&r<2?B(e,n,r*2):[u,l,s]}function nn(e,n,r){if(n=+n,e=+e,r=+r,!(r>0))return[];if(e===n)return[e];const t=n<e,[o,a,i]=t?B(n,e,r):B(e,n,r);if(!(a>=o))return[];const u=a-o+1,l=new Array(u);if(t)if(i<0)for(let s=0;s<u;++s)l[s]=(a-s)/-i;else for(let s=0;s<u;++s)l[s]=(a-s)*i;else if(i<0)for(let s=0;s<u;++s)l[s]=(o+s)/-i;else for(let s=0;s<u;++s)l[s]=(o+s)*i;return l}function ae(e,n,r){return n=+n,e=+e,r=+r,B(e,n,r)[2]}function tn(e,n,r){n=+n,e=+e,r=+r;const t=n<e,o=t?ae(n,e,r):ae(e,n,r);return(t?-1:1)*(o<0?1/-o:o)}function rn(e,n){n||(n=[]);var r=e?Math.min(n.length,e.length):0,t=n.slice(),o;return function(a){for(o=0;o<r;++o)t[o]=e[o]*(1-a)+n[o]*a;return t}}function an(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function on(e,n){var r=n?n.length:0,t=e?Math.min(r,e.length):0,o=new Array(t),a=new Array(r),i;for(i=0;i<t;++i)o[i]=ce(e[i],n[i]);for(;i<r;++i)a[i]=n[i];return function(u){for(i=0;i<t;++i)a[i]=o[i](u);return a}}function sn(e,n){var r=new Date;return e=+e,n=+n,function(t){return r.setTime(e*(1-t)+n*t),r}}function un(e,n){var r={},t={},o;(e===null||typeof e!="object")&&(e={}),(n===null||typeof n!="object")&&(n={});for(o in n)o in e?r[o]=ce(e[o],n[o]):t[o]=n[o];return function(a){for(o in r)t[o]=r[o](a);return t}}function ce(e,n){var r=typeof n,t;return n==null||r==="boolean"?Pe(n):(r==="number"?re:r==="string"?(t=me(n))?(n=t,ge):Ce:n instanceof me?ge:n instanceof Date?sn:an(n)?rn:Array.isArray(n)?on:typeof n.valueOf!="function"&&typeof n.toString!="function"||isNaN(n)?un:re)(e,n)}function ln(e,n){return e=+e,n=+n,function(r){return Math.round(e*(1-r)+n*r)}}function cn(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function Q(e,n){if((r=(e=n?e.toExponential(n-1):e.toExponential()).indexOf("e"))<0)return null;var r,t=e.slice(0,r);return[t.length>1?t[0]+t.slice(2):t,+e.slice(r+1)]}function X(e){return e=Q(Math.abs(e)),e?e[1]:NaN}function fn(e,n){return function(r,t){for(var o=r.length,a=[],i=0,u=e[0],l=0;o>0&&u>0&&(l+u+1>t&&(u=Math.max(1,t-l)),a.push(r.substring(o-=u,o+u)),!((l+=u+1)>t));)u=e[i=(i+1)%e.length];return a.reverse().join(n)}}function mn(e){return function(n){return n.replace(/[0-9]/g,function(r){return e[+r]})}}var gn=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Z(e){if(!(n=gn.exec(e)))throw new Error("invalid format: "+e);var n;return new fe({fill:n[1],align:n[2],sign:n[3],symbol:n[4],zero:n[5],width:n[6],comma:n[7],precision:n[8]&&n[8].slice(1),trim:n[9],type:n[10]})}Z.prototype=fe.prototype;function fe(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}fe.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function pn(e){e:for(var n=e.length,r=1,t=-1,o;r<n;++r)switch(e[r]){case".":t=o=r;break;case"0":t===0&&(t=r),o=r;break;default:if(!+e[r])break e;t>0&&(t=0);break}return t>0?e.slice(0,t)+e.slice(o+1):e}var Se;function dn(e,n){var r=Q(e,n);if(!r)return e+"";var t=r[0],o=r[1],a=o-(Se=Math.max(-8,Math.min(8,Math.floor(o/3)))*3)+1,i=t.length;return a===i?t:a>i?t+new Array(a-i+1).join("0"):a>0?t.slice(0,a)+"."+t.slice(a):"0."+new Array(1-a).join("0")+Q(e,Math.max(0,n+a-1))[0]}function he(e,n){var r=Q(e,n);if(!r)return e+"";var t=r[0],o=r[1];return o<0?"0."+new Array(-o).join("0")+t:t.length>o+1?t.slice(0,o+1)+"."+t.slice(o+1):t+new Array(o-t.length+2).join("0")}const xe={"%":(e,n)=>(e*100).toFixed(n),b:e=>Math.round(e).toString(2),c:e=>e+"",d:cn,e:(e,n)=>e.toExponential(n),f:(e,n)=>e.toFixed(n),g:(e,n)=>e.toPrecision(n),o:e=>Math.round(e).toString(8),p:(e,n)=>he(e*100,n),r:he,s:dn,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function be(e){return e}var De=Array.prototype.map,ye=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function hn(e){var n=e.grouping===void 0||e.thousands===void 0?be:fn(De.call(e.grouping,Number),e.thousands+""),r=e.currency===void 0?"":e.currency[0]+"",t=e.currency===void 0?"":e.currency[1]+"",o=e.decimal===void 0?".":e.decimal+"",a=e.numerals===void 0?be:mn(De.call(e.numerals,String)),i=e.percent===void 0?"%":e.percent+"",u=e.minus===void 0?"−":e.minus+"",l=e.nan===void 0?"NaN":e.nan+"";function s(m){m=Z(m);var f=m.fill,d=m.align,p=m.sign,x=m.symbol,D=m.zero,A=m.width,c=m.comma,b=m.precision,y=m.trim,v=m.type;v==="n"?(c=!0,v="g"):xe[v]||(b===void 0&&(b=12),y=!0,v="g"),(D||f==="0"&&d==="=")&&(D=!0,f="0",d="=");var L=x==="$"?r:x==="#"&&/[boxX]/.test(v)?"0"+v.toLowerCase():"",$=x==="$"?t:/[%p]/.test(v)?i:"",j=xe[v],W=/[defgprs%]/.test(v);b=b===void 0?6:/[gprs]/.test(v)?Math.max(1,Math.min(21,b)):Math.max(0,Math.min(20,b));function z(h){var P=L,F=$,C,ee,R;if(v==="c")F=j(h)+F,h="";else{h=+h;var I=h<0||1/h<0;if(h=isNaN(h)?l:j(Math.abs(h),b),y&&(h=pn(h)),I&&+h==0&&p!=="+"&&(I=!1),P=(I?p==="("?p:u:p==="-"||p==="("?"":p)+P,F=(v==="s"?ye[8+Se/3]:"")+F+(I&&p==="("?")":""),W){for(C=-1,ee=h.length;++C<ee;)if(R=h.charCodeAt(C),48>R||R>57){F=(R===46?o+h.slice(C+1):h.slice(C))+F,h=h.slice(0,C);break}}}c&&!D&&(h=n(h,1/0));var U=P.length+h.length+F.length,G=U<A?new Array(A-U+1).join(f):"";switch(c&&D&&(h=n(G+h,G.length?A-F.length:1/0),G=""),d){case"<":h=P+h+F+G;break;case"=":h=P+G+h+F;break;case"^":h=G.slice(0,U=G.length>>1)+P+h+F+G.slice(U);break;default:h=G+P+h+F;break}return a(h)}return z.toString=function(){return m+""},z}function g(m,f){var d=s((m=Z(m),m.type="f",m)),p=Math.max(-8,Math.min(8,Math.floor(X(f)/3)))*3,x=Math.pow(10,-p),D=ye[8+p/3];return function(A){return d(x*A)+D}}return{format:s,formatPrefix:g}}var H,Fe,Le;xn({thousands:",",grouping:[3],currency:["$",""]});function xn(e){return H=hn(e),Fe=H.format,Le=H.formatPrefix,H}function bn(e){return Math.max(0,-X(Math.abs(e)))}function Dn(e,n){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(X(n)/3)))*3-X(Math.abs(e)))}function yn(e,n){return e=Math.abs(e),n=Math.abs(n)-e,Math.max(0,X(n)-X(e))+1}function vn(e,n){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(n).domain(e);break}return this}function Mn(e){return function(){return e}}function An(e){return+e}var ve=[0,1];function V(e){return e}function oe(e,n){return(n-=e=+e)?function(r){return(r-e)/n}:Mn(isNaN(n)?NaN:.5)}function wn(e,n){var r;return e>n&&(r=e,e=n,n=r),function(t){return Math.max(e,Math.min(n,t))}}function Sn(e,n,r){var t=e[0],o=e[1],a=n[0],i=n[1];return o<t?(t=oe(o,t),a=r(i,a)):(t=oe(t,o),a=r(a,i)),function(u){return a(t(u))}}function Fn(e,n,r){var t=Math.min(e.length,n.length)-1,o=new Array(t),a=new Array(t),i=-1;for(e[t]<e[0]&&(e=e.slice().reverse(),n=n.slice().reverse());++i<t;)o[i]=oe(e[i],e[i+1]),a[i]=r(n[i],n[i+1]);return function(u){var l=Ze(e,u,1,t)-1;return a[l](o[l](u))}}function Ln(e,n){return n.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function $n(){var e=ve,n=ve,r=ce,t,o,a,i=V,u,l,s;function g(){var f=Math.min(e.length,n.length);return i!==V&&(i=wn(e[0],e[f-1])),u=f>2?Fn:Sn,l=s=null,m}function m(f){return f==null||isNaN(f=+f)?a:(l||(l=u(e.map(t),n,r)))(t(i(f)))}return m.invert=function(f){return i(o((s||(s=u(n,e.map(t),re)))(f)))},m.domain=function(f){return arguments.length?(e=Array.from(f,An),g()):e.slice()},m.range=function(f){return arguments.length?(n=Array.from(f),g()):n.slice()},m.rangeRound=function(f){return n=Array.from(f),r=ln,g()},m.clamp=function(f){return arguments.length?(i=f?!0:V,g()):i!==V},m.interpolate=function(f){return arguments.length?(r=f,g()):r},m.unknown=function(f){return arguments.length?(a=f,m):a},function(f,d){return t=f,o=d,g()}}function Pn(){return $n()(V,V)}function Cn(e,n,r,t){var o=tn(e,n,r),a;switch(t=Z(t??",f"),t.type){case"s":{var i=Math.max(Math.abs(e),Math.abs(n));return t.precision==null&&!isNaN(a=Dn(o,i))&&(t.precision=a),Le(t,i)}case"":case"e":case"g":case"p":case"r":{t.precision==null&&!isNaN(a=yn(o,Math.max(Math.abs(e),Math.abs(n))))&&(t.precision=a-(t.type==="e"));break}case"f":case"%":{t.precision==null&&!isNaN(a=bn(o))&&(t.precision=a-(t.type==="%")*2);break}}return Fe(t)}function Gn(e){var n=e.domain;return e.ticks=function(r){var t=n();return nn(t[0],t[t.length-1],r??10)},e.tickFormat=function(r,t){var o=n();return Cn(o[0],o[o.length-1],r??10,t)},e.nice=function(r){r==null&&(r=10);var t=n(),o=0,a=t.length-1,i=t[o],u=t[a],l,s,g=10;for(u<i&&(s=i,i=u,u=s,s=o,o=a,a=s);g-- >0;){if(s=ae(i,u,r),s===l)return t[o]=i,t[a]=u,n(t);if(s>0)i=Math.floor(i/s)*s,u=Math.ceil(u/s)*s;else if(s<0)i=Math.ceil(i*s)/s,u=Math.floor(u*s)/s;else break;l=s}return e},e}function $e(){var e=Pn();return e.copy=function(){return Ln(e,$e())},vn.apply(e,arguments),Gn(e)}function kn(e){return new _(function(n){Ge(e()).subscribe(n)})}function In(e,n,r){return kn(function(){return e()?n:r})}const K=({maxValue:e=1,minValue:n=0,axisWidth:r,scaleDomain:t=O.scaleDomain,scaleRange:o=O.scaleRange})=>{const a=t[0]??O.scaleDomain[0],i=t[1]??O.scaleDomain[1],u=o[0]??O.scaleRange[0],l=o[1]??O.scaleRange[1],s=a==="auto"?n:a,g=i==="auto"?e:i,m=e-(e-s)/(1-u),f=g/l;return $e().domain([m,f]).range([0,r])};function Tn(e,n){if(!e.length)return[];try{const r=e.reduce((i,u)=>u.length>i?u.length:i,0),o=e.map((i,u)=>{if(i.length===r)return i;const l=Object.assign([],i);for(let s=l.length;s<r;s++)l[s]=null;return l}).map((i,u)=>i.map((l,s)=>l==null?{id:"",label:"",data:{},value:null}:typeof l=="number"?{id:"",label:"",data:{},value:l}:{id:l.id??"",label:l.label??"",data:l.data??{},value:l.value}));return Re(n.seriesDirection,o)}catch{return[]}}const Un=e=>{const{data:n=[],dataFormatter:r,chartParams:t}=e;if(!n.length)return[];let o;try{const a=Tn(n,r.grid),i=ke({transposedDataGrid:a,dataFormatterGrid:r.grid,chartType:"grid"}),u=Ie({transposedDataGrid:a,dataFormatterGrid:r.grid,chartType:"grid"});let l=0;o=a.map((s,g)=>s.map((m,f)=>{const d=Te("grid",0,g,f),p=u[f],x={id:m.id?m.id:d,index:l,label:m.label?m.label:d,description:m.description??"",data:m.data,value:m.value,gridIndex:0,seriesIndex:g,seriesLabel:i[g],groupIndex:f,groupLabel:p,color:Ne(g,t),visible:!0};return x.visible=r.visibleFilter(x,e),l++,x}))}catch(a){throw Error(a)}return o},Hn=({computedData$:e,fullDataFormatter$:n,layout$:r})=>{function t(a,i,u){const l=i.grid.groupAxis.position==="top"||i.grid.groupAxis.position==="bottom"?u.width:u.height,s=a[0]?a[0].length-1:0;return K({maxValue:s,minValue:0,axisWidth:l,scaleDomain:[0,s],scaleRange:[0,1]})}function o(a,i,u){const l=i.grid.valueAxis.position==="left"||i.grid.valueAxis.position==="right"?u.height:u.width,s=a.flat(),[g,m]=Ee(s);return K({maxValue:m,minValue:g,axisWidth:l,scaleDomain:[g,m],scaleRange:[0,1]})}return Y({computedData:e,fullDataFormatter:n,layout:r}).pipe(N(async a=>a),k(a=>{const i=t(a.computedData,a.fullDataFormatter,a.layout),u=o(a.computedData,a.fullDataFormatter,a.layout),l=u(0);return a.computedData.map((s,g)=>s.map((m,f)=>{const d=i(f),p=u(m.value??0);return{...m,axisX:d,axisY:p,axisYFromZero:p-l}}))}))},qn=({fullDataFormatter$:e,layout$:n})=>{const r=new se;function t({xAxis:o,yAxis:a,width:i,height:u}){if(!o||!a)return{translate:[0,0],scale:[1,1],rotate:0,rotateX:0,rotateY:0,value:""};let l=0,s=0,g=0,m=0,f=0;return o.position==="bottom"?a.position==="left"?(m=180,s=u):a.position==="right"?(m=180,f=180,l=i,s=u):(m=180,s=u):o.position==="top"?a.position==="left"||(a.position==="right"?(f=180,l=i):(m=180,s=u)):o.position==="left"?a.position==="bottom"?(g=-90,s=u):a.position==="top"?(g=-90,f=180):(m=180,s=u):o.position==="right"?a.position==="bottom"?(g=-90,m=180,s=u,l=i):a.position==="top"?(g=-90,m=180,f=180,l=i):(m=180,s=u):(m=180,s=u),{translate:[l,s],scale:[1,1],rotate:g,rotateX:m,rotateY:f,value:`translate(${l}px, ${s}px) rotate(${g}deg) rotateX(${m}deg) rotateY(${f}deg)`}}return new _(o=>(Y({fullDataFormatter:e,layout:n}).pipe(ue(r),N(async a=>a)).subscribe(a=>{const i=t({xAxis:a.fullDataFormatter.grid.groupAxis,yAxis:a.fullDataFormatter.grid.valueAxis,width:a.layout.width,height:a.layout.height});o.next(i)}),function(){r.next(void 0)}))},Jn=({gridAxesTransform$:e})=>e.pipe(k(n=>{const r=[0,0],t=[1/n.scale[0],1/n.scale[1]],o=n.rotate*-1,a=n.rotateX*-1,i=n.rotateY*-1;return{translate:r,scale:t,rotate:o,rotateX:a,rotateY:i,value:`translate(${r[0]}px, ${r[1]}px) rotate(${o}deg) rotateX(${a}deg) rotateY(${i}deg)`}})),Bn=({computedData$:e,fullDataFormatter$:n,layout$:r})=>{const t=new se;function o({data:a,groupAxis:i,valueAxis:u,width:l,height:s}){let g=0,m=0,f=0,d=0;const p=i.position==="top"||i.position==="bottom"?l:s,x=0,D=a[0]?a[0].length-1:0,A=i.scaleDomain[0]==="auto"?x-i.scalePadding:i.scaleDomain[0]-i.scalePadding,c=i.scaleDomain[1]==="auto"?D+i.scalePadding:i.scaleDomain[1]+i.scalePadding,b=K({maxValue:D,minValue:x,axisWidth:p,scaleDomain:[A,c],scaleRange:[0,1]}),y=b(x),v=b(D);x==D?(g=0,f=1):(g=y,f=(v-y)/p);const L=a.map((C,ee)=>C.filter((R,I)=>I>=A&&I<=c&&R.visible==!0)),$=pe(L),j=u.position==="left"||u.position==="right"?s:l,W=K({maxValue:$[1],minValue:$[0],axisWidth:j,scaleDomain:u.scaleDomain,scaleRange:u.scaleRange}),z=pe(a),h=W(z[0]),P=W(z[1]);return m=h,d=(P-h)/j,{translate:[g,m],scale:[f,d],rotate:0,rotateX:0,rotateY:0,value:`translate(${g}px, ${m}px) scale(${f}, ${d})`}}return new _(a=>(Y({computedData:e,fullDataFormatter:n,layout:r}).pipe(ue(t),N(async i=>i)).subscribe(i=>{const u=o({data:i.computedData,groupAxis:i.fullDataFormatter.grid.groupAxis,valueAxis:i.fullDataFormatter.grid.valueAxis,width:i.layout.width,height:i.layout.height});a.next(u)}),function(){t.next(void 0)}))},Qn=({gridContainerPosition$:e,gridAxesTransform$:n,gridGraphicTransform$:r})=>Y({gridContainerPosition:e,gridAxesTransform:n,gridGraphicTransform:r}).pipe(N(async t=>t),k(t=>t.gridAxesTransform.rotate==0||t.gridAxesTransform.rotate==180?t.gridContainerPosition.map((o,a)=>[1/t.gridGraphicTransform.scale[0]/t.gridContainerPosition[a].scale[0],1/t.gridGraphicTransform.scale[1]/t.gridContainerPosition[a].scale[1]]):t.gridContainerPosition.map((o,a)=>[1/t.gridGraphicTransform.scale[0]/t.gridContainerPosition[a].scale[1],1/t.gridGraphicTransform.scale[1]/t.gridContainerPosition[a].scale[0]]))),Zn=({fullDataFormatter$:e,layout$:n})=>{const r=new se;function t({xAxisPosition:o,yAxisPosition:a,width:i,height:u}){return(o==="bottom"||o==="top")&&(a==="left"||a==="right")?{width:i,height:u}:(o==="left"||o==="right")&&(a==="bottom"||a==="top")?{width:u,height:i}:{width:i,height:u}}return new _(o=>{Y({fullDataFormatter:e,layout:n}).pipe(ue(r),N(async a=>a)).subscribe(a=>{const i=t({xAxisPosition:a.fullDataFormatter.grid.groupAxis.position,yAxisPosition:a.fullDataFormatter.grid.valueAxis.position,width:a.layout.width,height:a.layout.height});return o.next(i),function(){r.next(void 0)}})})},Kn=({computedData$:e})=>e.pipe(k(n=>n.filter(r=>r.length).map(r=>r[0].seriesLabel)),Oe((n,r)=>JSON.stringify(n).length===JSON.stringify(r).length)),_n=({computedData$:e})=>e.pipe(k(n=>n.map(t=>t.filter(o=>o.visible==!0)).filter(t=>t.length))),et=({computedLayoutData$:e})=>e.pipe(k(n=>n.map(t=>t.filter(o=>o.visible==!0)).filter(t=>t.length))),nt=({computedData$:e,fullDataFormatter$:n,layout$:r})=>Y({computedData:e,fullDataFormatter:n,layout:r}).pipe(N(async o=>o),k(o=>{if(o.fullDataFormatter.grid.separateSeries)return de(o.layout,o.fullDataFormatter.container,o.computedData.length);{const a=de(o.layout,o.fullDataFormatter.container,1);return o.computedData.map((i,u)=>a[0])}})),tt=({isSeriesSeprate$:e,computedData$:n})=>{const r=n.pipe(k(t=>{const o=new Array(t[0]?t[0].length:0).fill(null).map((i,u)=>t.reduce((l,s)=>{if(s&&s[u]){const g=s[u].value==null||s[u].visible==!1?0:s[u].value;return l+g}return l},0));return t.map((i,u)=>i.map((l,s)=>({...l,value:o[s]})))}));return e.pipe(N(t=>In(()=>t,n,r)))};var Nn=["addListener","removeListener"],Rn=["addEventListener","removeEventListener"],On=["on","off"];function ie(e,n,r,t){if(T(r)&&(t=r,r=void 0),t)return ie(e,n,r).pipe(Ve(t));var o=Xe(Xn(e)?Rn.map(function(u){return function(l){return e[u](n,l,r)}}):En(e)?Nn.map(Me(e,n)):Vn(e)?On.map(Me(e,n)):[],2),a=o[0],i=o[1];if(!a&&Ye(e))return Ue(function(u){return ie(u,n,r)})(je(e));if(!a)throw new TypeError("Invalid event target");return new le(function(u){var l=function(){for(var s=[],g=0;g<arguments.length;g++)s[g]=arguments[g];return u.next(1<s.length?s:s[0])};return a(l),function(){return i(l)}})}function Me(e,n){return function(r){return function(t){return e[r](n,t)}}}function En(e){return T(e.addListener)&&T(e.removeListener)}function Vn(e){return T(e.on)&&T(e.off)}function Xn(e){return T(e.addEventListener)&&T(e.removeEventListener)}function Yn(e,n){let r=new le(()=>{});return e.each(function(){const t=ie(this,n);r=He(r,t)}),r}const rt=({selection:e,pluginName:n,clipPathID:r,seriesLabels$:t,gridContainerPosition$:o,gridAxesTransform$:a,gridGraphicTransform$:i})=>{const u=te(n,"series"),l=te(n,"axes"),s=te(n,"graphic"),g=t.pipe(M((p,x)=>e.selectAll(`g.${u}`).data(p,D=>D).join(D=>D.append("g").classed(u,!0).each((A,c,b)=>{ne(b[c]).selectAll(`g.${l}`).data([c]).join(y=>y.append("g").classed(l,!0).attr("clip-path",`url(#${r})`).each((v,L,$)=>{ne($[L]).selectAll("defs").data([L]).join("defs"),ne($[L]).selectAll("g").data([L]).join("g").classed(s,!0)}),y=>y,y=>y.remove())}),D=>D,D=>D.remove())),E(1));w({seriesSelection:g,gridContainerPosition:o}).pipe(S(async p=>p)).subscribe(p=>{p.seriesSelection.transition().attr("transform",(x,D)=>{const A=p.gridContainerPosition[D]??p.gridContainerPosition[0],c=A.translate,b=A.scale;return`translate(${c[0]}, ${c[1]}) scale(${b[0]}, ${b[1]})`})});const m=w({seriesSelection:g,gridAxesTransform:a}).pipe(S(async p=>p),M(p=>p.seriesSelection.select(`g.${l}`).style("transform",p.gridAxesTransform.value)),E(1)),f=m.pipe(M(p=>p.select("defs")),E(1)),d=w({axesSelection:m,gridGraphicTransform:i}).pipe(S(async p=>p),M(p=>{const x=p.axesSelection.select(`g.${s}`);return x.transition().duration(50).style("transform",p.gridGraphicTransform.value),x}),E(1));return{seriesSelection$:g,axesSelection$:m,defsSelection$:f,graphicGSelection$:d}},at=({fullDataFormatter$:e,gridAxesSize$:n,computedData$:r,fullChartParams$:t,gridContainerPosition$:o,layout$:a})=>{const i=new ze,u=w({fullDataFormatter:e,gridAxesSize:n,computedData:r}).pipe(S(async f=>f),M(f=>{const p=f.computedData[0]?f.computedData[0].length-1:0,x=f.fullDataFormatter.grid.groupAxis.scaleDomain[0]==="auto"?0-f.fullDataFormatter.grid.groupAxis.scalePadding:f.fullDataFormatter.grid.groupAxis.scaleDomain[0]-f.fullDataFormatter.grid.groupAxis.scalePadding,D=f.fullDataFormatter.grid.groupAxis.scaleDomain[1]==="auto"?p+f.fullDataFormatter.grid.groupAxis.scalePadding:f.fullDataFormatter.grid.groupAxis.scaleDomain[1]+f.fullDataFormatter.grid.groupAxis.scalePadding;return[x,D]}),E(1)),l=w({fullDataFormatter:e,computedData:r}).pipe(S(async f=>f),M(f=>f.fullDataFormatter.grid.seriesDirection==="row"?(f.computedData[0]??[]).map(d=>d.groupLabel):f.computedData.map(d=>d[0].groupLabel))),s=w({groupScaleDomain:u,groupLabels:l}).pipe(S(async f=>f),M(f=>f.groupLabels.filter((d,p)=>p>=f.groupScaleDomain[0]&&p<=f.groupScaleDomain[1]))),g=o.pipe(M(f=>f.reduce((p,x)=>x.columnIndex>p?x.columnIndex:p,0)+1),J()),m=o.pipe(M(f=>f.reduce((p,x)=>x.rowIndex>p?x.rowIndex:p,0)+1),J());return new le(f=>{w({dataFormatter:e,axisSize:n,fullChartParams:t,scaleRangeGroupLabels:s,groupScaleDomain:u,columnAmount:g,rowAmount:m,layout:a}).pipe(We(i),S(async d=>d)).subscribe(d=>{const p=d.dataFormatter.grid.valueAxis.position==="right"||d.dataFormatter.grid.valueAxis.position==="bottom",x=Ae({axisLabels:d.scaleRangeGroupLabels,axisWidth:d.axisSize.width,padding:d.dataFormatter.grid.groupAxis.scalePadding,reverse:p}),D=c=>d.dataFormatter.grid.groupAxis.position==="bottom"||d.dataFormatter.grid.groupAxis.position==="top"?c.offsetX-d.fullChartParams.padding.left:c.offsetY-d.fullChartParams.padding.top,A=c=>{const b={offsetX:c.offsetX*d.columnAmount%d.layout.rootWidth,offsetY:c.offsetY*d.rowAmount%d.layout.rootHeight},y=D(b),v=x(y),L=Math.ceil(d.groupScaleDomain[0]),$=v+L;return{groupIndex:$,groupLabel:d.scaleRangeGroupLabels[$]??""}};return f.next(A),function(){i.next(void 0)}})})},ot=({rootSelection:e,fullDataFormatter$:n,gridAxesSize$:r,computedData$:t,fullChartParams$:o,gridContainerPosition$:a,layout$:i})=>{const u=Yn(e,"mousemove"),l=w({fullDataFormatter:n,gridAxesSize:r,computedData:t}).pipe(S(async c=>c),M(c=>{const y=c.computedData[0]?c.computedData[0].length-1:0,v=c.fullDataFormatter.grid.groupAxis.scaleDomain[0]==="auto"?0-c.fullDataFormatter.grid.groupAxis.scalePadding:c.fullDataFormatter.grid.groupAxis.scaleDomain[0]-c.fullDataFormatter.grid.groupAxis.scalePadding,L=c.fullDataFormatter.grid.groupAxis.scaleDomain[1]==="auto"?y+c.fullDataFormatter.grid.groupAxis.scalePadding:c.fullDataFormatter.grid.groupAxis.scaleDomain[1]+c.fullDataFormatter.grid.groupAxis.scalePadding;return[v,L]}),E(1)),s=w({fullDataFormatter:n,computedData:t}).pipe(S(async c=>c),M(c=>c.fullDataFormatter.grid.seriesDirection==="row"?(c.computedData[0]??[]).map(b=>b.groupLabel):c.computedData.map(b=>b[0].groupLabel))),g=w({groupScaleDomain:l,groupLabels:s}).pipe(S(async c=>c),M(c=>c.groupLabels.filter((b,y)=>y>=c.groupScaleDomain[0]&&y<=c.groupScaleDomain[1]))),m=n.pipe(M(c=>c.grid.valueAxis.position==="right"||c.grid.valueAxis.position==="bottom")),f=w({reverse:m,gridAxesSize:r,scaleRangeGroupLabels:g,fullDataFormatter:n}).pipe(S(async c=>c),M(c=>Ae({axisLabels:c.scaleRangeGroupLabels,axisWidth:c.gridAxesSize.width,padding:c.fullDataFormatter.grid.groupAxis.scalePadding,reverse:c.reverse}))),d=a.pipe(M(c=>c.reduce((y,v)=>v.columnIndex>y?v.columnIndex:y,0)+1),J()),p=a.pipe(M(c=>c.reduce((y,v)=>v.rowIndex>y?v.rowIndex:y,0)+1),J()),x=w({fullDataFormatter:n,fullChartParams:o,rootMousemove:u,columnAmount:d,rowAmount:p,layout:i}).pipe(S(async c=>c),M(c=>{const b={offsetX:c.rootMousemove.offsetX*c.columnAmount%c.layout.rootWidth,offsetY:c.rootMousemove.offsetY*c.rowAmount%c.layout.rootHeight};return c.fullDataFormatter.grid.groupAxis.position==="bottom"||c.fullDataFormatter.grid.groupAxis.position==="top"?b.offsetX-c.fullChartParams.padding.left:b.offsetY-c.fullChartParams.padding.top})),D=w({xIndexScale:f,axisValue:x,groupScaleDomain:l}).pipe(S(async c=>c),M(c=>{const b=c.xIndexScale(c.axisValue),y=Math.ceil(c.groupScaleDomain[0]);return b+y})),A=w({groupIndex:D,groupLabels:s}).pipe(S(async c=>c),M(c=>c.groupLabels[c.groupIndex]??""));return w({groupIndex:D,groupLabel:A}).pipe(S(async c=>c),M(c=>({groupIndex:c.groupIndex,groupLabel:c.groupLabel})))};export{Jn as a,nt as b,K as c,Tn as d,Bn as e,Qn as f,qn as g,Zn as h,_n as i,Hn as j,et as k,tt as l,rt as m,at as n,Yn as o,ot as p,Un as q,Kn as s};
