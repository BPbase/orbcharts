import{S as X,f as p,e as V,t as l,s as d,d as x,l as W,g as Y,as as H,O as G,ak as J}from"./DumZHm4J.js";import{a as C,n as K,p as I,g as M,o as Q,q as Z}from"./DEHBezd2.js";const B=6;function _({selection:u,xAxisClassName:h,groupingLabelClassName:f,params:i,tickTextAlign:c,axisLabelAlign:b,gridAxesSize:T,fullDataFormatter:z,chartParams:n,groupScale:S,groupScaleDomain:v,groupLabels:o,textTransform:m}){const A=u.selectAll(`g.${h}`).data([i]).join("g").classed(h,!0);u.selectAll(`g.${f}`).data([i]).join("g").classed(f,!0).each((a,F,R)=>{Y(R[F]).selectAll("text").data([a]).join(g=>g.append("text").style("font-weight","bold"),g=>g,g=>g.remove()).attr("text-anchor",b.textAnchor).attr("dominant-baseline",b.dominantBaseline).attr("font-size",n.styles.textSize).style("fill",C(i.labelColorType,n)).style("transform",m).text(g=>z.grid.groupAxis.label)}).attr("transform",a=>`translate(${T.width+a.tickPadding+i.labelOffset[0]}, ${-a.tickPadding-B-i.labelOffset[1]})`);const D=Math.floor(v[1])-Math.ceil(v[0])+1;console.log(i.ticks,i.ticks==="all"||i.ticks>D?D:i.ticks);const L=K(S).scale(S).ticks(i.ticks==="all"||i.ticks>D?D:i.ticks).tickSize(i.tickFullLine==!0?-T.height:B).tickSizeOuter(0).tickFormat(a=>{const F=o[a]??"";return I(F,i.tickFormat)}).tickPadding(i.tickPadding),$=A.transition().duration(100).call(L);return $.selectAll("line").style("fill","none").style("stroke",i.tickLineVisible==!0?C(i.tickColorType,n):"none").style("stroke-dasharray",i.tickFullLineDasharray).attr("pointer-events","none"),$.selectAll("path").style("fill","none").style("stroke",i.axisLineVisible==!0?C(i.axisLineColorType,n):"none").style("shape-rendering","crispEdges"),A.selectAll("text").attr("font-size",n.styles.textSize).style("color",C(i.tickTextColorType,n)).attr("text-anchor",c.textAnchor).attr("dominant-baseline",c.dominantBaseline).attr("transform-origin",`0 -${i.tickPadding+B}`).style("transform",m),A}const oe=(u,{selection:h,computedData$:f,fullParams$:i,fullDataFormatter$:c,fullChartParams$:b,gridAxesTransform$:T,gridAxesReverseTransform$:z,gridAxesSize$:n,gridContainerPosition$:S,isSeriesSeprate$:v})=>{const o=new X,m=M(u,"container"),A=M(u,"xAxisG"),D=M(u,"xAxis"),L=M(u,"groupingLabel"),$=p({computedData:f.pipe(V((e,s)=>e.length===s.length)),isSeriesSeprate:v}).pipe(l(o),d(async e=>e),x(e=>e.isSeriesSeprate?e.computedData:[e.computedData[0]]),x((e,s)=>h.selectAll(`g.${m}`).data(e,r=>r[0]?r[0].seriesIndex:s).join("g").classed(m,!0))),a=$.pipe(l(o),x((e,s)=>e.selectAll(`g.${A}`).data([A]).join("g").classed(A,!0)));p({containerSelection:$,gridContainerPosition:S}).pipe(l(o),d(async e=>e)).subscribe(e=>{e.containerSelection.attr("transform",(s,r)=>{const k=e.gridContainerPosition[r]??e.gridContainerPosition[0],y=k.translate,P=k.scale;return`translate(${y[0]}, ${y[1]}) scale(${P[0]}, ${P[1]})`})}),p({axisSelection:a,gridAxesTransform:T}).pipe(l(o),d(async e=>e)).subscribe(e=>{e.axisSelection.style("transform",e.gridAxesTransform.value)});const F=p({fullParams:i,fullDataFormatter:c,gridAxesReverseTransform:z,gridContainerPosition:S}).pipe(l(o),d(async e=>e),x(e=>{const s=`translate(${e.gridAxesReverseTransform.translate[0]}px, ${e.gridAxesReverseTransform.translate[1]}px)`,r=`rotate(${e.gridAxesReverseTransform.rotate}deg) rotateX(${e.gridAxesReverseTransform.rotateX}deg) rotateY(${e.gridAxesReverseTransform.rotateY}deg)`,k=`scale(${1/e.gridContainerPosition[0].scale[0]}, ${1/e.gridContainerPosition[0].scale[1]})`,P=`rotate(${e.fullDataFormatter.grid.groupAxis.position==="left"&&e.fullDataFormatter.grid.valueAxis.position==="top"||e.fullDataFormatter.grid.groupAxis.position==="right"&&e.fullDataFormatter.grid.valueAxis.position==="bottom"?e.fullParams.tickTextRotate+180:e.fullParams.tickTextRotate}deg)`;return`${s} ${r} ${k} ${P}`}),V()),R=p({fullDataFormatter:c,gridAxesSize:n,computedData:f}).pipe(l(o),d(async e=>e),x(e=>{const r=e.computedData[0]?e.computedData[0].length-1:0,k=e.fullDataFormatter.grid.groupAxis.scaleDomain[0]==="auto"?0-e.fullDataFormatter.grid.groupAxis.scalePadding:e.fullDataFormatter.grid.groupAxis.scaleDomain[0]-e.fullDataFormatter.grid.groupAxis.scalePadding,y=e.fullDataFormatter.grid.groupAxis.scaleDomain[1]==="auto"?r+e.fullDataFormatter.grid.groupAxis.scalePadding:e.fullDataFormatter.grid.groupAxis.scaleDomain[1]+e.fullDataFormatter.grid.groupAxis.scalePadding;return[k,y]}),W(1)),g=p({groupScaleDomain:R,gridAxesSize:n}).pipe(l(o),d(async e=>e),x(e=>H().domain(e.groupScaleDomain).range([0,e.gridAxesSize.width]))),j=f.pipe(x(e=>(e[0]??[]).map(s=>s.groupLabel))),w=p({fullDataFormatter:c,fullParams:i}).pipe(l(o),d(async e=>e),x(e=>{let s="middle",r="hanging";return e.fullDataFormatter.grid.groupAxis.position==="bottom"?(s=e.fullParams.tickTextRotate?"end":"middle",r="hanging"):e.fullDataFormatter.grid.groupAxis.position==="top"?(s=e.fullParams.tickTextRotate?"end":"middle",r="auto"):e.fullDataFormatter.grid.groupAxis.position==="left"?(s="end",r="middle"):e.fullDataFormatter.grid.groupAxis.position==="right"&&(s="start",r="middle"),{textAnchor:s,dominantBaseline:r}})),t=c.pipe(l(o),x(e=>{let s="start",r="hanging";return e.grid.groupAxis.position==="bottom"?r="hanging":e.grid.groupAxis.position==="top"?r="auto":e.grid.groupAxis.position==="left"?s="end":e.grid.groupAxis.position==="right"&&(s="start"),e.grid.valueAxis.position==="left"?s="start":e.grid.valueAxis.position==="right"?s="end":e.grid.valueAxis.position==="bottom"?r="auto":e.grid.valueAxis.position==="top"&&(r="hanging"),{textAnchor:s,dominantBaseline:r}}));return p({axisSelection:a,params:i,tickTextAlign:w,axisLabelAlign:t,gridAxesSize:n,fullDataFormatter:c,chartParams:b,groupScale:g,groupScaleDomain:R,groupLabels:j,textTransform:F}).pipe(l(o),d(async e=>e)).subscribe(e=>{_({selection:e.axisSelection,xAxisClassName:D,groupingLabelClassName:L,params:e.params,tickTextAlign:e.tickTextAlign,axisLabelAlign:e.axisLabelAlign,gridAxesSize:e.gridAxesSize,fullDataFormatter:e.fullDataFormatter,chartParams:e.chartParams,groupScale:e.groupScale,groupScaleDomain:e.groupScaleDomain,groupLabels:e.groupLabels,textTransform:e.textTransform})}),()=>{o.next(void 0)}},E=6;function N({selection:u,yAxisClassName:h,textClassName:f,fullParams:i,tickTextAlign:c,axisLabelAlign:b,gridAxesSize:T,fullDataFormatter:z,fullChartParams:n,valueScale:S,textTransform:v,minAndMax:o}){const m=u.selectAll(`g.${h}`).data([i]).join("g").classed(h,!0);u.selectAll(`g.${f}`).data([i]).join("g").classed(f,!0).each((a,F,R)=>{Y(R[F]).selectAll("text").data([a]).join(g=>g.append("text").style("font-weight","bold"),g=>g,g=>g.remove()).attr("text-anchor",b.textAnchor).attr("dominant-baseline",b.dominantBaseline).attr("font-size",n.styles.textSize).style("fill",C(i.labelColorType,n)).style("transform",v).text(g=>z.grid.valueAxis.label)}).attr("transform",a=>`translate(${-a.tickPadding+i.labelOffset[0]}, ${T.height+a.tickPadding+i.labelOffset[1]})`);const A=o[1]-o[0],D=Q(S).scale(S).ticks(A>i.ticks?i.ticks:o[0]===0&&o[1]===0?1:Math.ceil(A)).tickFormat(a=>I(a,i.tickFormat)).tickSize(i.tickFullLine==!0?-T.width:E).tickPadding(i.tickPadding),L=m.transition().duration(100).call(D);return L.selectAll("line").style("fill","none").style("stroke",i.tickLineVisible==!0?C(i.tickColorType,n):"none").style("stroke-dasharray",i.tickFullLineDasharray).attr("pointer-events","none"),L.selectAll("path").style("fill","none").style("stroke",i.axisLineVisible==!0?C(i.axisLineColorType,n):"none").style("shape-rendering","crispEdges"),m.selectAll("text").attr("font-size",n.styles.textSize).style("color",C(i.tickTextColorType,n)).attr("text-anchor",c.textAnchor).attr("dominant-baseline",c.dominantBaseline).attr("transform-origin",`-${i.tickPadding+E} 0`).style("transform",v),m}const re=(u,{selection:h,computedData$:f,fullParams$:i,fullDataFormatter$:c,fullChartParams$:b,gridAxesTransform$:T,gridAxesReverseTransform$:z,gridAxesSize$:n,gridContainerPosition$:S,isSeriesSeprate$:v})=>{const o=new X,m=M(u,"container"),A=M(u,"yAxisG"),D=M(u,"yAxis"),L=M(u,"text"),$=p({computedData:f.pipe(V((t,e)=>t.length===e.length)),isSeriesSeprate:v}).pipe(l(o),d(async t=>t),x(t=>t.isSeriesSeprate?t.computedData:[t.computedData[0]]),x((t,e)=>h.selectAll(`g.${m}`).data(t,s=>s[0]?s[0].seriesIndex:e).join("g").classed(m,!0))),a=$.pipe(l(o),x((t,e)=>t.selectAll(`g.${A}`).data([A]).join("g").classed(A,!0)));p({containerSelection:$,gridContainerPosition:S}).pipe(l(o),d(async t=>t)).subscribe(t=>{t.containerSelection.attr("transform",(e,s)=>{const r=t.gridContainerPosition[s]??t.gridContainerPosition[0],k=r.translate,y=r.scale;return`translate(${k[0]}, ${k[1]}) scale(${y[0]}, ${y[1]})`})}),p({axisSelection:a,gridAxesTransform:T}).pipe(l(o),d(async t=>t)).subscribe(t=>{t.axisSelection.style("transform",t.gridAxesTransform.value)});const F=p({fullParams:i,fullDataFormatter:c,gridAxesReverseTransform:z,gridContainerPosition:S}).pipe(l(o),d(async t=>t),x(t=>{const e=`translate(${t.gridAxesReverseTransform.translate[0]}px, ${t.gridAxesReverseTransform.translate[1]}px)`,s=`rotate(${t.gridAxesReverseTransform.rotate}deg) rotateX(${t.gridAxesReverseTransform.rotateX}deg) rotateY(${t.gridAxesReverseTransform.rotateY}deg)`,r=`scale(${1/t.gridContainerPosition[0].scale[0]}, ${1/t.gridContainerPosition[0].scale[1]})`,y=`rotate(${t.fullDataFormatter.grid.groupAxis.position==="left"&&t.fullDataFormatter.grid.valueAxis.position==="top"||t.fullDataFormatter.grid.groupAxis.position==="right"&&t.fullDataFormatter.grid.valueAxis.position==="bottom"?t.fullParams.tickTextRotate+180:t.fullParams.tickTextRotate}deg)`;return`${e} ${s} ${r} ${y}`}),V()),R=new G(t=>{p({fullDataFormatter:c,gridAxesSize:n,computedData:f}).pipe(l(o),d(async e=>e)).subscribe(e=>{const r=e.computedData[0]?e.computedData[0].length-1:0,k=e.fullDataFormatter.grid.groupAxis.scaleDomain[0]==="auto"?0-e.fullDataFormatter.grid.groupAxis.scalePadding:e.fullDataFormatter.grid.groupAxis.scaleDomain[0]-e.fullDataFormatter.grid.groupAxis.scalePadding,y=e.fullDataFormatter.grid.groupAxis.scaleDomain[1]==="auto"?r+e.fullDataFormatter.grid.groupAxis.scalePadding:e.fullDataFormatter.grid.groupAxis.scaleDomain[1]+e.fullDataFormatter.grid.groupAxis.scalePadding,P=e.computedData.map((q,ee)=>q.filter((te,O)=>O>=k&&O<=y)),U=Z(P.flat());t.next(U)})}),g=new G(t=>{p({fullDataFormatter:c,gridAxesSize:n,minAndMax:R}).pipe(l(o),d(async e=>e)).subscribe(e=>{const s=J({maxValue:e.minAndMax[1],minValue:e.minAndMax[0],axisWidth:e.gridAxesSize.height,scaleDomain:e.fullDataFormatter.grid.valueAxis.scaleDomain,scaleRange:e.fullDataFormatter.grid.valueAxis.scaleRange});t.next(s)})}),j=c.pipe(l(o),x(t=>{let e="start",s="hanging";return t.grid.valueAxis.position==="left"?(e="end",s="middle"):t.grid.valueAxis.position==="right"?(e="start",s="middle"):t.grid.valueAxis.position==="bottom"?(e="middle",s="hanging"):t.grid.valueAxis.position==="top"&&(e="middle",s="auto"),{textAnchor:e,dominantBaseline:s}})),w=c.pipe(l(o),x(t=>{let e="start",s="hanging";return t.grid.groupAxis.position==="bottom"?s="auto":t.grid.groupAxis.position==="top"?s="hanging":t.grid.groupAxis.position==="left"?e="start":t.grid.groupAxis.position==="right"&&(e="end"),t.grid.valueAxis.position==="left"?e="end":t.grid.valueAxis.position==="right"?e="start":t.grid.valueAxis.position==="bottom"?s="hanging":t.grid.valueAxis.position==="top"&&(s="auto"),{textAnchor:e,dominantBaseline:s}}));return p({axisSelection:a,fullParams:i,tickTextAlign:j,axisLabelAlign:w,computedData:f,gridAxesSize:n,fullDataFormatter:c,fullChartParams:b,valueScale:g,textTransform:F,minAndMax:R}).pipe(l(o),d(async t=>t)).subscribe(t=>{N({selection:t.axisSelection,yAxisClassName:D,textClassName:L,fullParams:t.fullParams,tickTextAlign:t.tickTextAlign,axisLabelAlign:t.axisLabelAlign,gridAxesSize:t.gridAxesSize,fullDataFormatter:t.fullDataFormatter,fullChartParams:t.fullChartParams,valueScale:t.valueScale,textTransform:t.textTransform,minAndMax:t.minAndMax})}),()=>{o.next(void 0)}};export{oe as a,re as c};
