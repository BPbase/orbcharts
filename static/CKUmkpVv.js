import{S as G,o as h,h as w,t as u,p as v,m as S,i as _,s as F,ax as q,_ as O,aC as I}from"./PGufJ0Z3.js";import{h as M,n as N,i as E,g as z,o as H,q as J}from"./C1EDXMJI.js";const K=6;function Q({selection:b,groupingLabelClassName:k,fullParams:t,axisLabelAlign:A,gridAxesSize:m,fullDataFormatter:o,chartParams:f,textReverseTransform:R}){const g=t.tickPadding+t.labelOffset[0],c=t.tickPadding+t.labelOffset[1];let p=0,n=0;o.grid.groupAxis.position==="bottom"?(n=c,o.grid.valueAxis.position==="left"?p=g:o.grid.valueAxis.position==="right"&&(p=-g)):o.grid.groupAxis.position==="top"?(n=-c,o.grid.valueAxis.position==="left"?p=g:o.grid.valueAxis.position==="right"&&(p=-g)):o.grid.groupAxis.position==="left"?(p=-g,o.grid.valueAxis.position==="bottom"?n=-c:o.grid.valueAxis.position==="top"&&(n=c)):o.grid.groupAxis.position==="right"&&(p=g,o.grid.valueAxis.position==="bottom"?n=-c:o.grid.valueAxis.position==="top"&&(n=c)),b.selectAll(`g.${k}`).data([t]).join("g").classed(k,!0).each((l,d,y)=>{F(y[d]).selectAll("text").data([l]).join(x=>x.append("text").style("font-weight","bold"),x=>x,x=>x.remove()).attr("text-anchor",A.textAnchor).attr("dominant-baseline",A.dominantBaseline).attr("font-size",f.styles.textSize).style("fill",M(t.labelColorType,f)).style("transform",R).attr("x",p).attr("y",n).text(x=>o.grid.groupAxis.label)}).attr("transform",l=>`translate(${m.width}, 0)`)}function Z({selection:b,xAxisClassName:k,fullParams:t,tickTextAlign:A,gridAxesSize:m,fullDataFormatter:o,chartParams:f,groupScale:R,groupScaleDomain:g,groupLabels:c,textReverseTransformWithRotate:p,textSizePx:n}){const l=b.selectAll(`g.${k}`).data([t]).join("g").classed(k,!0),d=Math.floor(g[1])-Math.ceil(g[0])+1;let y=0,x=0;o.grid.groupAxis.position==="left"?(y=0,x=-t.tickPadding):o.grid.groupAxis.position==="right"?(y=0,x=t.tickPadding):o.grid.groupAxis.position==="bottom"?(y=t.tickPadding,x=0):o.grid.groupAxis.position==="top"&&(y=-t.tickPadding,x=-0);const D=N(R).scale(R).ticks(t.ticks==="all"||t.ticks>d?d:t.ticks).tickSize(t.tickFullLine==!0?m.height:-K).tickSizeOuter(0).tickFormat(P=>{const V=c[P]??"";return E(V,t.tickFormat)}).tickPadding(y),$=l.transition().duration(100).call(D).on("end",(P,V)=>{$.selectAll(".tick text").each((Y,X,B)=>{const s=(c[X]??"").split(`
`),e=F(B[X]).text(null),r=Number(e.attr("x"));let a=Number(e.attr("y"));o.grid.groupAxis.position==="top"&&(a-=(s.length-1)*n),e.selectAll("tspan").data(s).join("tspan").attr("x",r).attr("y",(T,L)=>a+L*n).text(T=>T)})});return $.selectAll("line").style("fill","none").style("stroke",t.tickLineVisible==!0?M(t.tickColorType,f):"none").style("stroke-dasharray",t.tickFullLineDasharray).attr("pointer-events","none"),$.selectAll("path").style("fill","none").style("stroke",t.axisLineVisible==!0?M(t.axisLineColorType,f):"none").style("shape-rendering","crispEdges"),l.selectAll("text").attr("font-size",f.styles.textSize).style("color",M(t.tickTextColorType,f)).attr("text-anchor",A.textAnchor).attr("dominant-baseline",A.dominantBaseline).attr("x",x).style("transform",p).attr("dy",0),l}const le=(b,{selection:k,computedData$:t,fullParams$:A,fullDataFormatter$:m,fullChartParams$:o,gridAxesTransform$:f,gridAxesReverseTransform$:R,gridAxesSize$:g,gridContainerPosition$:c,isSeriesSeprate$:p,textSizePx$:n})=>{const l=new G,d=z(b,"container"),y=z(b,"xAxisG"),x=z(b,"xAxis"),D=z(b,"groupingLabel"),$=h({computedData:t.pipe(w((e,r)=>e.length===r.length)),isSeriesSeprate:p}).pipe(u(l),v(async e=>e),S(e=>e.isSeriesSeprate?e.computedData:[e.computedData[0]]),S((e,r)=>k.selectAll(`g.${d}`).data(e,a=>a[0]?a[0].seriesIndex:r).join("g").classed(d,!0))),j=$.pipe(u(l),S((e,r)=>e.selectAll(`g.${y}`).data([y]).join("g").classed(y,!0)));h({containerSelection:$,gridContainerPosition:c}).pipe(u(l),v(async e=>e)).subscribe(e=>{e.containerSelection.attr("transform",(r,a)=>{const T=e.gridContainerPosition[a]??e.gridContainerPosition[0],L=T.translate,C=T.scale;return`translate(${L[0]}, ${L[1]}) scale(${C[0]}, ${C[1]})`})}),h({axisSelection:j,gridAxesTransform:f}).pipe(u(l),v(async e=>e)).subscribe(e=>{e.axisSelection.style("transform",e.gridAxesTransform.value)});const P=h({gridAxesReverseTransform:R,gridContainerPosition:c}).pipe(u(l),v(async e=>e),S(e=>{const r=`rotateX(${e.gridAxesReverseTransform.rotateX}deg) rotateY(${e.gridAxesReverseTransform.rotateY}deg)`,a=`rotate(${e.gridAxesReverseTransform.rotate}deg)`,T=`scale(${1/e.gridContainerPosition[0].scale[0]}, ${1/e.gridContainerPosition[0].scale[1]})`;return`${r} ${a} ${T}`}),w()),V=h({textReverseTransform:P,fullParams:A}).pipe(u(l),v(async e=>e),S(e=>`${e.textReverseTransform} rotate(${e.fullParams.tickTextRotate}deg)`)),Y=h({fullDataFormatter:m,gridAxesSize:g,computedData:t}).pipe(u(l),v(async e=>e),S(e=>{const a=e.computedData[0]?e.computedData[0].length-1:0,T=e.fullDataFormatter.grid.groupAxis.scaleDomain[0]==="auto"?0-e.fullDataFormatter.grid.groupAxis.scalePadding:e.fullDataFormatter.grid.groupAxis.scaleDomain[0]-e.fullDataFormatter.grid.groupAxis.scalePadding,L=e.fullDataFormatter.grid.groupAxis.scaleDomain[1]==="auto"?a+e.fullDataFormatter.grid.groupAxis.scalePadding:e.fullDataFormatter.grid.groupAxis.scaleDomain[1]+e.fullDataFormatter.grid.groupAxis.scalePadding;return[T,L]}),_(1)),X=h({groupScaleDomain:Y,gridAxesSize:g}).pipe(u(l),v(async e=>e),S(e=>q().domain(e.groupScaleDomain).range([0,e.gridAxesSize.width]))),B=t.pipe(S(e=>(e[0]??[]).map(r=>r.groupLabel))),i=h({fullDataFormatter:m,fullParams:A}).pipe(u(l),v(async e=>e),S(e=>{let r="middle",a="hanging";return e.fullDataFormatter.grid.groupAxis.position==="bottom"?(r=e.fullParams.tickTextRotate?"end":"middle",a="hanging"):e.fullDataFormatter.grid.groupAxis.position==="top"?(r=e.fullParams.tickTextRotate?"start":"middle",a="auto"):e.fullDataFormatter.grid.groupAxis.position==="left"?(r="end",a="middle"):e.fullDataFormatter.grid.groupAxis.position==="right"&&(r="start",a="middle"),{textAnchor:r,dominantBaseline:a}})),s=m.pipe(u(l),S(e=>{let r="start",a="hanging";return e.grid.groupAxis.position==="bottom"?a="hanging":e.grid.groupAxis.position==="top"?a="auto":e.grid.groupAxis.position==="left"?r="end":e.grid.groupAxis.position==="right"&&(r="start"),e.grid.valueAxis.position==="left"?r="start":e.grid.valueAxis.position==="right"?r="end":e.grid.valueAxis.position==="bottom"?a="auto":e.grid.valueAxis.position==="top"&&(a="hanging"),{textAnchor:r,dominantBaseline:a}}));return h({axisSelection:j,fullParams:A,tickTextAlign:i,axisLabelAlign:s,gridAxesSize:g,fullDataFormatter:m,chartParams:o,groupScale:X,groupScaleDomain:Y,groupLabels:B,textReverseTransform:P,textReverseTransformWithRotate:V,textSizePx:n}).pipe(u(l),v(async e=>e)).subscribe(e=>{Z({selection:e.axisSelection,xAxisClassName:x,fullParams:e.fullParams,tickTextAlign:e.tickTextAlign,gridAxesSize:e.gridAxesSize,fullDataFormatter:e.fullDataFormatter,chartParams:e.chartParams,groupScale:e.groupScale,groupScaleDomain:e.groupScaleDomain,groupLabels:e.groupLabels,textReverseTransformWithRotate:e.textReverseTransformWithRotate,textSizePx:e.textSizePx}),Q({selection:e.axisSelection,groupingLabelClassName:D,fullParams:e.fullParams,axisLabelAlign:e.axisLabelAlign,gridAxesSize:e.gridAxesSize,fullDataFormatter:e.fullDataFormatter,chartParams:e.chartParams,textReverseTransform:e.textReverseTransform})}),()=>{l.next(void 0)}},ee=6;function ie({selection:b,textClassName:k,fullParams:t,axisLabelAlign:A,gridAxesSize:m,fullDataFormatter:o,fullChartParams:f,textReverseTransform:R}){const g=t.tickPadding-t.labelOffset[0],c=t.tickPadding+t.labelOffset[1];let p=0,n=0;o.grid.groupAxis.position==="bottom"?(n=-c,o.grid.valueAxis.position==="left"?p=-g:o.grid.valueAxis.position==="right"&&(p=g)):o.grid.groupAxis.position==="top"?(n=c,o.grid.valueAxis.position==="left"?p=-g:o.grid.valueAxis.position==="right"&&(p=g)):o.grid.groupAxis.position==="left"?(p=g,o.grid.valueAxis.position==="bottom"?n=c:o.grid.valueAxis.position==="top"&&(n=-c)):o.grid.groupAxis.position==="right"&&(p=-g,o.grid.valueAxis.position==="bottom"?n=c:o.grid.valueAxis.position==="top"&&(n=-c)),b.selectAll(`g.${k}`).data([t]).join("g").classed(k,!0).each((l,d,y)=>{F(y[d]).selectAll("text").data([l]).join(x=>x.append("text").style("font-weight","bold"),x=>x,x=>x.remove()).attr("text-anchor",A.textAnchor).attr("dominant-baseline",A.dominantBaseline).attr("font-size",f.styles.textSize).style("fill",M(t.labelColorType,f)).style("transform",R).attr("x",p).attr("y",n).text(x=>o.grid.valueAxis.label)}).attr("transform",l=>`translate(0, ${m.height})`)}function te({selection:b,yAxisClassName:k,fullParams:t,tickTextAlign:A,gridAxesSize:m,fullDataFormatter:o,fullChartParams:f,valueScale:R,textReverseTransformWithRotate:g,minAndMax:c}){const p=b.selectAll(`g.${k}`).data([t]).join("g").classed(k,!0),n=c[1]-c[0];let l=0,d=0;o.grid.valueAxis.position==="left"?(l=t.tickPadding,d=0):o.grid.valueAxis.position==="right"?(l=-t.tickPadding,d=0):o.grid.valueAxis.position==="bottom"?(l=0,d=t.tickPadding):o.grid.valueAxis.position==="top"&&(l=0,d=-t.tickPadding);const y=H(R).scale(R).ticks(n>t.ticks?t.ticks:c[0]===0&&c[1]===0?1:Math.ceil(n)).tickFormat($=>E($,t.tickFormat)).tickSize(t.tickFullLine==!0?-m.width:ee).tickPadding(l),x=p.transition().duration(100).call(y);x.selectAll("line").style("fill","none").style("stroke",t.tickLineVisible==!0?M(t.tickColorType,f):"none").style("stroke-dasharray",t.tickFullLineDasharray).attr("pointer-events","none"),x.selectAll("path").style("fill","none").style("stroke",t.axisLineVisible==!0?M(t.axisLineColorType,f):"none").style("shape-rendering","crispEdges");const D=p.selectAll("text").attr("font-size",f.styles.textSize).style("color",M(t.tickTextColorType,f)).attr("text-anchor",A.textAnchor).attr("dominant-baseline",A.dominantBaseline).attr("y",d);return D.style("transform",g),(o.grid.valueAxis.position==="bottom"||o.grid.valueAxis.position==="top")&&D.attr("dy",0),p}const ae=(b,{selection:k,computedData$:t,fullParams$:A,fullDataFormatter$:m,fullChartParams$:o,gridAxesTransform$:f,gridAxesReverseTransform$:R,gridAxesSize$:g,gridContainerPosition$:c,isSeriesSeprate$:p})=>{const n=new G,l=z(b,"container"),d=z(b,"yAxisG"),y=z(b,"yAxis"),x=z(b,"text"),D=h({computedData:t.pipe(w((i,s)=>i.length===s.length)),isSeriesSeprate:p}).pipe(u(n),v(async i=>i),S(i=>i.isSeriesSeprate?i.computedData:[i.computedData[0]]),S((i,s)=>k.selectAll(`g.${l}`).data(i,e=>e[0]?e[0].seriesIndex:s).join("g").classed(l,!0))),$=D.pipe(u(n),S((i,s)=>i.selectAll(`g.${d}`).data([d]).join("g").classed(d,!0)));h({containerSelection:D,gridContainerPosition:c}).pipe(u(n),v(async i=>i)).subscribe(i=>{i.containerSelection.attr("transform",(s,e)=>{const r=i.gridContainerPosition[e]??i.gridContainerPosition[0],a=r.translate,T=r.scale;return`translate(${a[0]}, ${a[1]}) scale(${T[0]}, ${T[1]})`})}),h({axisSelection:$,gridAxesTransform:f}).pipe(u(n),v(async i=>i)).subscribe(i=>{i.axisSelection.style("transform",i.gridAxesTransform.value)});const j=h({gridAxesReverseTransform:R,gridContainerPosition:c}).pipe(u(n),v(async i=>i),S(i=>{const s=`rotateX(${i.gridAxesReverseTransform.rotateX}deg) rotateY(${i.gridAxesReverseTransform.rotateY}deg)`,e=`rotate(${i.gridAxesReverseTransform.rotate}deg)`,r=`scale(${1/i.gridContainerPosition[0].scale[0]}, ${1/i.gridContainerPosition[0].scale[1]})`;return`${s} ${e} ${r}`}),w()),P=h({textReverseTransform:j,fullParams:A}).pipe(u(n),v(async i=>i),S(i=>`${i.textReverseTransform} rotate(${i.fullParams.tickTextRotate}deg)`)),V=new O(i=>{h({fullDataFormatter:m,gridAxesSize:g,computedData:t}).pipe(u(n),v(async s=>s)).subscribe(s=>{const r=s.computedData[0]?s.computedData[0].length-1:0,a=s.fullDataFormatter.grid.groupAxis.scaleDomain[0]==="auto"?0-s.fullDataFormatter.grid.groupAxis.scalePadding:s.fullDataFormatter.grid.groupAxis.scaleDomain[0]-s.fullDataFormatter.grid.groupAxis.scalePadding,T=s.fullDataFormatter.grid.groupAxis.scaleDomain[1]==="auto"?r+s.fullDataFormatter.grid.groupAxis.scalePadding:s.fullDataFormatter.grid.groupAxis.scaleDomain[1]+s.fullDataFormatter.grid.groupAxis.scalePadding,L=s.computedData.map((U,se)=>U.filter((oe,W)=>W>=a&&W<=T)),C=J(L.flat());C[0]===C[1]&&(C[0]=C[1]-1),i.next(C)})}),Y=new O(i=>{h({fullDataFormatter:m,gridAxesSize:g,minAndMax:V}).pipe(u(n),v(async s=>s)).subscribe(s=>{const e=I({maxValue:s.minAndMax[1],minValue:s.minAndMax[0],axisWidth:s.gridAxesSize.height,scaleDomain:s.fullDataFormatter.grid.valueAxis.scaleDomain,scaleRange:s.fullDataFormatter.grid.valueAxis.scaleRange});i.next(e)})}),X=h({fullDataFormatter:m,fullParams:A}).pipe(u(n),v(async i=>i),S(i=>{let s="start",e="hanging";return i.fullDataFormatter.grid.valueAxis.position==="left"?(s="end",e="middle"):i.fullDataFormatter.grid.valueAxis.position==="right"?(s="start",e="middle"):i.fullDataFormatter.grid.valueAxis.position==="bottom"?(s=i.fullParams.tickTextRotate?"end":"middle",e="hanging"):i.fullDataFormatter.grid.valueAxis.position==="top"&&(s=i.fullParams.tickTextRotate?"start":"middle",e="auto"),{textAnchor:s,dominantBaseline:e}})),B=m.pipe(u(n),S(i=>{let s="start",e="hanging";return i.grid.groupAxis.position==="bottom"?e="auto":i.grid.groupAxis.position==="top"?e="hanging":i.grid.groupAxis.position==="left"?s="start":i.grid.groupAxis.position==="right"&&(s="end"),i.grid.valueAxis.position==="left"?s="end":i.grid.valueAxis.position==="right"?s="start":i.grid.valueAxis.position==="bottom"?e="hanging":i.grid.valueAxis.position==="top"&&(e="auto"),{textAnchor:s,dominantBaseline:e}}));return h({axisSelection:$,fullParams:A,tickTextAlign:X,axisLabelAlign:B,computedData:t,gridAxesSize:g,fullDataFormatter:m,fullChartParams:o,valueScale:Y,textReverseTransform:j,textReverseTransformWithRotate:P,minAndMax:V}).pipe(u(n),v(async i=>i)).subscribe(i=>{te({selection:i.axisSelection,yAxisClassName:y,fullParams:i.fullParams,tickTextAlign:i.tickTextAlign,gridAxesSize:i.gridAxesSize,fullDataFormatter:i.fullDataFormatter,fullChartParams:i.fullChartParams,valueScale:i.valueScale,textReverseTransformWithRotate:i.textReverseTransformWithRotate,minAndMax:i.minAndMax}),ie({selection:i.axisSelection,textClassName:x,fullParams:i.fullParams,axisLabelAlign:i.axisLabelAlign,gridAxesSize:i.gridAxesSize,fullDataFormatter:i.fullDataFormatter,fullChartParams:i.fullChartParams,textReverseTransform:i.textReverseTransform})}),()=>{n.next(void 0)}};export{le as a,ae as c};
