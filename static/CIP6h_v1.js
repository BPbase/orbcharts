import{at as $,az as F,b6 as P,ax as g,aE as p,aH as C,aC as b,aD as d,b7 as y,aL as L,aB as l,aN as O,aI as B,aO as T,b8 as v}from"./ZOIXw5Nq.js";const A=o=>{const e=$(o,{visibleFilter:{toBeTypes:["Function"]},sort:{toBeTypes:["Function","null"]},seriesLabels:{toBeTypes:["string[]"]},container:{toBeTypes:["object"]},separateSeries:{toBeTypes:["boolean"]},sumSeries:{toBeTypes:["boolean"]}});if(o.container){const a=$(o.container,{columnAmount:{toBeTypes:["number"]},rowAmount:{toBeTypes:["number"]},columnGap:{toBe:'"auto" | number',test:r=>r==="auto"||typeof r=="number"},rowGap:{toBe:'"auto" | number',test:r=>r==="auto"||typeof r=="number"}});if(a.status==="error")return a}return e},M=o=>{const{data:e=[],dataFormatter:a,chartParams:r}=o;if(!e.length)return[];let s=[];try{const n=(t,i,c,u)=>{const m=F(a.type,i,c),f=a.seriesLabels[i]||P("series",i),D=g(i,r);return typeof t=="number"?{id:m,index:u,seq:0,label:m,description:"",data:{},value:t,seriesIndex:i,seriesLabel:f,color:D,visible:!0}:{id:t.id?t.id:m,index:u,seq:0,label:t.label?t.label:m,description:t.description,data:t.data??{},value:t.value,seriesIndex:i,seriesLabel:f,color:D,visible:!0}};s=e.map((t,i)=>Array.isArray(t)?t.map((c,u)=>n(c,i,u,s.length+u)):n(t,i,0,s.length)).flat().sort(a.sort??void 0).map((t,i)=>(t.seq=i,t)).map(t=>(t.visible=a.visibleFilter(t,o),t)).sort((t,i)=>t.index-i.index).reduce((t,i)=>(t[i.seriesIndex]||(t[i.seriesIndex]=[]),t[i.seriesIndex].push(i),t),[])}catch(n){throw Error(n)}return s},q=o=>$({data:o},{data:{toBe:"(DataSeriesDatum | DataSeriesValue)[][] | (DataSeriesDatum | DataSeriesValue)[]",test:a=>Array.isArray(a)}}),x=({fullDataFormatter$:o})=>o.pipe(p(e=>e.separateSeries),C()),w=({computedData$:o})=>o.pipe(p(e=>e.filter(a=>a.length).map(a=>a[0].seriesLabel)),C((e,a)=>JSON.stringify(e).length===JSON.stringify(a).length)),S=({computedData$:o})=>o.pipe(p(e=>e.map(a=>a.filter(r=>r.visible!=!1)))),E=({computedData$:o,fullDataFormatter$:e})=>b({computedData:o,fullDataFormatter:e}).pipe(d(async a=>a),p(a=>{const r=a.fullDataFormatter.sumSeries==!0?a.computedData.map(s=>[s.reduce((n,t)=>n==null?t:(n.value=n.value+t.value,n),null)]):a.computedData;return a.fullDataFormatter.separateSeries==!0?r.map(s=>s.sort((n,t)=>n.seq-t.seq)):[r.flat().sort((s,n)=>s.seq-n.seq)]})),R=({computedData$:o,fullDataFormatter$:e,layout$:a})=>b({computedData:o,fullDataFormatter:e,layout:a}).pipe(d(async s=>s),p(s=>s.fullDataFormatter.separateSeries?y(s.layout,s.fullDataFormatter.container,s.computedData.length):y(s.layout,s.fullDataFormatter.container,1))),V=({seriesContainerPosition$:o,seriesLabels$:e,separateSeries$:a})=>b({seriesContainerPosition:o,seriesLabels:e,separateSeries:a}).pipe(d(async r=>r),p(r=>r.separateSeries?new Map(r.seriesLabels.map((s,n)=>[s,r.seriesContainerPosition[n]??r.seriesContainerPosition[0]])):new Map(r.seriesLabels.map((s,n)=>[s,r.seriesContainerPosition[0]])))),z=({subject:o,observer:e})=>{const a=L(e.fullChartParams$).pipe(l(1)),r=x({fullDataFormatter$:e.fullDataFormatter$}).pipe(l(1)),s=S({computedData$:e.computedData$}).pipe(l(1)),n=E({computedData$:e.computedData$,fullDataFormatter$:e.fullDataFormatter$}).pipe(l(1)),t=S({computedData$:n}).pipe(l(1)),i=e.computedData$.pipe(p(h=>h.flat())).pipe(l(1)),c=O({datumList$:i,fullChartParams$:e.fullChartParams$,event$:o.event$}).pipe(l(1)),u=w({computedData$:e.computedData$}).pipe(l(1)),m=B({datumList$:i}).pipe(l(1)),f=R({computedData$:e.computedData$,fullDataFormatter$:e.fullDataFormatter$,layout$:e.layout$}).pipe(l(1)),D=V({seriesContainerPosition$:f,seriesLabels$:u,separateSeries$:r}).pipe(l(1));return{fullParams$:e.fullParams$,fullChartParams$:e.fullChartParams$,fullDataFormatter$:e.fullDataFormatter$,computedData$:e.computedData$,layout$:e.layout$,textSizePx$:a,visibleComputedData$:s,visibleComputedSortedData$:t,separateSeries$:r,computedSortedData$:n,seriesHighlight$:c,seriesLabels$:u,SeriesDataMap$:m,seriesContainerPosition$:f,SeriesContainerPositionMap$:D}};class _ extends T{constructor(e,a){super({defaultDataFormatter:v,dataFormatterValidator:A,computedDataFn:M,dataValidator:q,contextObserverCallback:z},e,a)}}export{_ as S};
