import{a as N,p as Q,m as f,d as A,k as M,t as m,l as P,s as v,b8 as R,aT as V,bm as Z,ba as ee,g as te}from"./Cc0KHcL0.js";import{o as ie,p as re}from"./BA8G9O0Y.js";import{f as se}from"./2XqyCpLW.js";function ae(r="curveLinear"){return Z().x(o=>o.axisX).y(o=>o.axisY).curve(ee[r])}function oe(r){let o=[[]],g=0;for(let l in r){if(r[l].visible==!1||r[l].value===void 0||r[l].value===null){o[g].length&&(g++,o[g]=[]);continue}o[g].push(r[l])}return o}function ne({selection:r,pathClassName:o,segmentData:g,linePath:l,params:n}){return r.selectAll("path").data(g,(a,c)=>a.length?`${a[0].id}_${a[a.length-1].id}`:c).join(a=>a.append("path").classed(o,!0).attr("fill","none").attr("pointer-events","visibleStroke").style("vector-effect","non-scaling-stroke").style("cursor","pointer"),a=>a,a=>a.remove()).attr("stroke-width",n.lineWidth).attr("stroke",(a,c)=>a[0]&&a[0].color).attr("d",a=>l(a))}function ge({selection:r,seriesLabel:o,fullChartParams:g}){if(r.interrupt("highlight"),!o){r.transition("highlight").duration(200).style("opacity",1);return}r.each((l,n,d)=>{l===o?v(d[n]).style("opacity",1):v(d[n]).style("opacity",g.styles.unhighlightedOpacity)})}function pe({defsSelection:r,clipPathData:o,transitionDuration:g,transitionEase:l}){r.selectAll("clipPath").data(o).join(n=>n.append("clipPath"),n=>n,n=>n.remove()).attr("id",n=>n.id).each((n,d,a)=>{v(a[d]).selectAll("rect").data([n]).join(c=>{const u=c.append("rect");return u.transition().duration(g).ease(R(l)).tween("tween",(y,E,x)=>w=>{const T=y.width*w;u.attr("x",0).attr("y",0).attr("width",I=>T).attr("height",I=>I.height)}),u},c=>c.attr("x",0).attr("y",0).attr("width",u=>u.width).attr("height",u=>u.height),c=>c.remove())})}const de=(r,{selection:o,computedData$:g,computedAxesData$:l,visibleComputedData$:n,visibleComputedAxesData$:d,seriesLabels$:a,SeriesDataMap$:c,GroupDataMap$:u,fullParams$:y,fullDataFormatter$:E,fullChartParams$:x,gridAxesTransform$:w,gridGraphicTransform$:T,gridAxesSize$:I,gridHighlight$:$,gridContainerPosition$:j,allContainerPosition$:z,layout$:O,event$:G})=>{const b=new N,C=Q(r,"clipPath-box"),B=te(r,"path"),{seriesSelection$:le,axesSelection$:ce,defsSelection$:H,graphicGSelection$:F}=ie({selection:o,pluginName:r,clipPathID:C,seriesLabels$:a,gridContainerPosition$:j,gridAxesTransform$:w,gridGraphicTransform$:T}),U=new V(e=>{const p=y.pipe(m(b)).subscribe(i=>{if(!i)return;const s=ae(i.lineCurve);e.next(s)});return()=>{p.unsubscribe()}}),W=x.pipe(f(e=>e.transitionDuration),A()),X=x.pipe(f(e=>e.transitionEase),A());M({defsSelection:H,seriesLabels:a,axisSize:I,transitionDuration:W,transitionEase:X}).pipe(m(b),P(async e=>e)).subscribe(e=>{const i=[{id:C,width:e.axisSize.width,height:e.axisSize.height}].concat(e.seriesLabels.map(s=>({id:`orbcharts__clipPath_${s}`,width:e.axisSize.width,height:e.axisSize.height})));pe({defsSelection:e.defsSelection,clipPathData:i,transitionDuration:e.transitionDuration,transitionEase:e.transitionEase})});const Y=g.pipe(f(e=>{const p=new Map;return e.flat().forEach(i=>p.set(i.id,i)),p})),q=re({fullDataFormatter$:E,gridAxesSize$:I,computedData$:g,fullChartParams$:x,gridContainerPosition$:z,layout$:O}),J=x.pipe(m(b),f(e=>e.highlightTarget),A()),K=M({graphicGSelection:F,visibleComputedAxesData:d,linePath:U,params:y}).pipe(m(b),P(async e=>e),f(e=>{let p=[];return e.graphicGSelection.each((i,s,h)=>{const S=oe(e.visibleComputedAxesData[s]??[]);p[s]=ne({selection:v(h[s]),pathClassName:B,linePath:e.linePath,segmentData:S,params:e.params})}),p}));return M({pathSelectionArr:K,computedData:g,SeriesDataMap:c,GroupDataMap:u,highlightTarget:J,gridGroupPositionFn:q}).pipe(m(b),P(async e=>e)).subscribe(e=>{e.pathSelectionArr.forEach(p=>{p.on("mouseover",(i,s)=>{i.stopPropagation();const h=s[0]?s[0].seriesLabel:"",{groupIndex:S,groupLabel:D}=e.gridGroupPositionFn(i),t=e.GroupDataMap.get(D).find(L=>L.seriesLabel===h)??s[0];G.next({type:"grid",eventName:"mouseover",pluginName:r,highlightTarget:e.highlightTarget,datum:t,gridIndex:t.gridIndex,series:e.SeriesDataMap.get(t.seriesLabel),seriesIndex:t.seriesIndex,seriesLabel:t.seriesLabel,group:e.GroupDataMap.get(t.groupLabel),groupIndex:t.groupIndex,groupLabel:t.groupLabel,event:i,data:e.computedData})}).on("mousemove",(i,s)=>{i.stopPropagation();const h=s[0]?s[0].seriesLabel:"",{groupIndex:S,groupLabel:D}=e.gridGroupPositionFn(i),t=e.GroupDataMap.get(D).find(L=>L.seriesLabel===h)??s[0];G.next({type:"grid",eventName:"mousemove",pluginName:r,highlightTarget:e.highlightTarget,datum:t,gridIndex:t.gridIndex,series:e.SeriesDataMap.get(t.seriesLabel),seriesIndex:t.seriesIndex,seriesLabel:t.seriesLabel,group:e.GroupDataMap.get(t.groupLabel),groupIndex:t.groupIndex,groupLabel:t.groupLabel,event:i,data:e.computedData})}).on("mouseout",(i,s)=>{i.stopPropagation();const h=s[0]?s[0].seriesLabel:"",{groupIndex:S,groupLabel:D}=e.gridGroupPositionFn(i),t=e.GroupDataMap.get(D).find(L=>L.seriesLabel===h)??s[0];G.next({type:"grid",eventName:"mouseout",pluginName:r,highlightTarget:e.highlightTarget,datum:t,gridIndex:t.gridIndex,series:e.SeriesDataMap.get(t.seriesLabel),seriesIndex:t.seriesIndex,seriesLabel:t.seriesLabel,group:e.GroupDataMap.get(t.groupLabel),groupIndex:t.groupIndex,groupLabel:t.groupLabel,event:i,data:e.computedData})}).on("click",(i,s)=>{i.stopPropagation();const h=s[0]?s[0].seriesLabel:"",{groupIndex:S,groupLabel:D}=e.gridGroupPositionFn(i),t=e.GroupDataMap.get(D).find(L=>L.seriesLabel===h)??s[0];G.next({type:"grid",eventName:"click",pluginName:r,highlightTarget:e.highlightTarget,datum:t,gridIndex:t.gridIndex,series:e.SeriesDataMap.get(t.seriesLabel),seriesIndex:t.seriesIndex,seriesLabel:t.seriesLabel,group:e.GroupDataMap.get(t.groupLabel),groupIndex:t.groupIndex,groupLabel:t.groupLabel,event:i,data:e.computedData})})})}),x.pipe(m(b),se(e=>e.highlightTarget==="series"),P(e=>M({graphicGSelection:F,gridHighlight:$,DataMap:Y,fullChartParams:x}).pipe(m(b),P(async p=>p)))).subscribe(e=>{const p=e.gridHighlight[0]?e.gridHighlight[0].seriesLabel:null;ge({selection:e.graphicGSelection,seriesLabel:p,fullChartParams:e.fullChartParams})}),()=>{b.next(void 0)}};export{de as c};
