import{at as T,bz as re,az as le,ax as oe,bA as se,aC as M,aE as b,aD as V,aH as k,aA as ue,bu as ce,aG as me,bN as pe,bO as N,aK as j,aL as fe,aB as h,aM as xe,aN as De,bB as ye,aO as ge,bP as he,bQ as W,bR as be,bS as de,bT as ve,bU as $e,bV as Me,bW as Se,bX as Ae,O as K,S as Z,t as G,m as d,V as Xe,aQ as Ye,W as Ce,as as Ve,b as C,k as $,l as v,d as z,s as _,ar as Ie,bY as q,by as Fe,bg as Le,bZ as Pe,g as H}from"./ZOIXw5Nq.js";import{c as P,d as ee}from"./B67HsDFx.js";import{c as Oe}from"./nbwQzsGv.js";import{c as Te}from"./CenN_d2j.js";const Re=l=>{const n=T(l,{visibleFilter:{toBeTypes:["Function"]},container:{toBeTypes:["object"]},categoryLabels:{toBeTypes:["string[]"]},valueLabels:{toBeTypes:["string[]"]},xAxis:{toBeTypes:["object"]},yAxis:{toBeTypes:["object"]},separateCategory:{toBeTypes:["boolean"]}});if(n.status==="error")return n;if(l.yAxis){const t=T(l.yAxis,{scaleDomain:{toBe:'[number | "min" | "auto", number | "max" | "auto"]',test:e=>Array.isArray(e)&&e.length===2&&(typeof e[0]=="number"||e[0]==="min"||e[0]==="auto")&&(typeof e[1]=="number"||e[1]==="max"||e[1]==="auto")},scaleRange:{toBe:"[number, number]",test:e=>Array.isArray(e)&&e.length===2&&typeof e[0]=="number"&&typeof e[1]=="number"},label:{toBeTypes:["string"]},valueIndex:{toBeTypes:["number"]}});if(t.status==="error")return t}if(l.xAxis){const t=T(l.xAxis,{scaleDomain:{toBe:'[number | "min" | "auto", number | "max" | "auto"]',test:e=>Array.isArray(e)&&e.length===2&&(typeof e[0]=="number"||e[0]==="min"||e[0]==="auto")&&(typeof e[1]=="number"||e[1]==="max"||e[1]==="auto")},scaleRange:{toBe:"[number, number]",test:e=>Array.isArray(e)&&e.length===2&&typeof e[0]=="number"&&typeof e[1]=="number"},label:{toBeTypes:["string"]},valueIndex:{toBeTypes:["number"]}});if(t.status==="error")return t}if(l.container){const t=T(l.container,{columnAmount:{toBeTypes:["number"]},rowAmount:{toBeTypes:["number"]},columnGap:{toBe:'"auto" | number',test:e=>e==="auto"||typeof e=="number"},rowGap:{toBe:'"auto" | number',test:e=>e==="auto"||typeof e=="number"}});if(t.status==="error")return t}return n},Be=l=>{const{data:n,dataFormatter:t,chartParams:e}=l;if(!n.length)return[];const a=se();let s=[];try{const c=n.map((i,r)=>Array.isArray(i)?{id:"",label:"",description:"",data:{},categoryLabel:a,value:i}:re(i)?{id:i.id??"",label:i.label??"",description:i.description??"",data:i.data??{},categoryLabel:i.categoryLabel??a,value:i.value}:{id:"",label:"",description:"",data:{},categoryLabel:a,value:[]}),u=(()=>{const i=new Set(t.categoryLabels);for(let r of c){const p=r.categoryLabel??a;i.add(p)}return Array.from(i)})(),o=new Map(u.map((i,r)=>[i,r]));c.forEach((i,r)=>{const p=le(t.type,r),m=o.get(i.categoryLabel)??0,x=oe(m,e),D={id:i.id?i.id:p,index:r,label:i.label?i.label:p,description:i.description??"",data:i.data,value:i.value,categoryIndex:m,categoryLabel:i.categoryLabel,xValueIndex:t.xAxis.valueIndex,yValueIndex:t.yAxis.valueIndex,visible:!0,color:x};D.visible=t.visibleFilter(D,l),s[m]||(s[m]=[]),s[m].push(D)})}catch(c){throw Error(c)}return s},we=l=>T({data:l},{data:{toBe:"(DataMultiValueDatum | DataMultiValueValue[])[]",test:t=>Array.isArray(t)}}),He=({computedData$:l,fullDataFormatter$:n})=>M({computedData:l,fullDataFormatter:n}).pipe(b(t=>t.computedData[0]&&t.computedData[0][0]&&t.computedData[0][0].value.length?t.computedData[0][0].value.map((e,a)=>t.fullDataFormatter.valueLabels[a]??pe("multiValue",a)):[])),ke=({computedData$:l,xyValueIndex$:n})=>M({computedData:l,xyValueIndex:n}).pipe(b(t=>{const e=t.computedData.flat(),[a,s]=N(e.map(o=>o.value[t.xyValueIndex[0]])),[c,u]=N(e.map(o=>o.value[t.xyValueIndex[1]]));return{minX:a,maxX:s,minY:c,maxY:u}})),ze=({computedData$:l,xyMinMax$:n,xyValueIndex$:t,fullDataFormatter$:e,layout$:a})=>{function s(u,o){let i=u.maxX,r=u.minX;return r===i&&i===0&&(i=1),P({maxValue:i,minValue:r,axisWidth:o.width,scaleDomain:["auto","auto"],scaleRange:[0,1]})}function c(u,o){let i=u.maxY,r=u.minY;return r===i&&i===0&&(i=1),P({maxValue:i,minValue:r,axisWidth:o.height,scaleDomain:["auto","auto"],scaleRange:[0,1],reverse:!0})}return M({computedData:l,xyMinMax:n,xyValueIndex:t,fullDataFormatter:e,layout:a}).pipe(V(async u=>u),b(u=>{const o=s(u.xyMinMax,u.layout),i=c(u.xyMinMax,u.layout);return u.computedData.map((r,p)=>r.map((m,x)=>({...m,axisX:o(m.value[u.xyValueIndex[0]]??0),axisY:i(m.value[u.xyValueIndex[1]]??0)})))}))},_e=({computedData$:l,fullDataFormatter$:n})=>l.pipe(b(t=>t.map(e=>e[0]?e[0].categoryLabel:"")),k((t,e)=>JSON.stringify(t).length===JSON.stringify(e).length)),We=({computedData$:l})=>l.pipe(b(n=>n.map(t=>t.filter(e=>e.visible==!0)).filter(t=>t.length>0))),Ee=({visibleComputedData$:l,fullDataFormatter$:n})=>M({visibleComputedData:l,fullDataFormatter:n}).pipe(b(t=>{let e=t.visibleComputedData[0]&&t.visibleComputedData[0][0]&&t.visibleComputedData[0][0].value.length?t.visibleComputedData[0][0].value.length-1:0;return[t.fullDataFormatter.xAxis.scaleDomain[0]==="auto"||t.fullDataFormatter.xAxis.scaleDomain[0]==="min"?0:t.fullDataFormatter.xAxis.scaleDomain[0],t.fullDataFormatter.xAxis.scaleDomain[1]==="auto"||t.fullDataFormatter.xAxis.scaleDomain[1]==="max"?e:t.fullDataFormatter.xAxis.scaleDomain[1]]}),k((t,e)=>t[0]===e[0]&&t[1]===e[1])),Ue=({visibleComputedData$:l,ordinalScaleDomain$:n})=>M({visibleComputedData:l,ordinalScaleDomain:n}).pipe(b(t=>t.visibleComputedData.map(e=>e.map((a,s)=>{let c=a;return c.sum=c.value.filter((u,o)=>o>=t.ordinalScaleDomain[0]&&o<=t.ordinalScaleDomain[1]).reduce((u,o)=>u+o,0),c})))),Ne=({xyValueIndex$:l,isCategorySeprate$:n,visibleComputedData$:t})=>M({isCategorySeprate:n,xyValueIndex:l,visibleComputedData:t}).pipe(V(async e=>e),b(e=>{const a=e.xyValueIndex[0];return e.isCategorySeprate?e.visibleComputedData.map(s=>s.sort((c,u)=>{const o=u.value[a]??-1/0,i=c.value[a]??-1/0;return o-i})):[e.visibleComputedData.flat().sort((s,c)=>{const u=c.value[a]??-1/0,o=s.value[a]??-1/0;return u-o})]})),je=({isCategorySeprate$:l,visibleComputedSumData$:n})=>M({isCategorySeprate:l,visibleComputedSumData:n}).pipe(V(async t=>t),b(t=>t.isCategorySeprate?t.visibleComputedSumData.map(e=>e.sort((a,s)=>s.sum-a.sum)):[t.visibleComputedSumData.flat().sort((e,a)=>a.sum-e.sum)])),Ge=({computedXYData$:l})=>l.pipe(b(n=>n.map(t=>t.filter(e=>e.visible==!0)).filter(t=>t.length>0))),qe=({computedData$:l,fullDataFormatter$:n,layout$:t})=>M({computedData:l,fullDataFormatter:n,layout:t}).pipe(V(async a=>a),b(a=>{if(a.computedData.length===0)return[{slotIndex:0,rowIndex:0,columnIndex:0,translate:[0,0],scale:[1,1]}];if(a.fullDataFormatter.separateCategory)return j(a.layout,a.fullDataFormatter.container,a.computedData.length);{const s=j(a.layout,a.fullDataFormatter.container,1);return a.computedData.map((c,u)=>s[0])}})),Je=({visibleComputedXYData$:l,xyMinMax$:n,xyValueIndex$:t,fullDataFormatter$:e})=>M({visibleComputedXYData:l,xyMinMax:n,xyValueIndex:t,fullDataFormatter:e}).pipe(b(a=>{const{minX:s,maxX:c,minY:u,maxY:o}=(()=>{let{minX:D,maxX:f,minY:g,maxY:y}=a.xyMinMax;return a.fullDataFormatter.xAxis.scaleDomain[0]==="auto"&&D>0?D=0:typeof a.fullDataFormatter.xAxis.scaleDomain[0]=="number"&&(D=a.fullDataFormatter.xAxis.scaleDomain[0]),a.fullDataFormatter.xAxis.scaleDomain[1]==="auto"&&f<0?f=0:typeof a.fullDataFormatter.xAxis.scaleDomain[1]=="number"&&(f=a.fullDataFormatter.xAxis.scaleDomain[1]),a.fullDataFormatter.yAxis.scaleDomain[0]==="auto"&&g>0?g=0:typeof a.fullDataFormatter.yAxis.scaleDomain[0]=="number"&&(g=a.fullDataFormatter.yAxis.scaleDomain[0]),a.fullDataFormatter.yAxis.scaleDomain[1]==="auto"&&y<0?y=0:typeof a.fullDataFormatter.yAxis.scaleDomain[1]=="number"&&(y=a.fullDataFormatter.yAxis.scaleDomain[1]),{minX:D,maxX:f,minY:g,maxY:y}})();let i=[],r=null,p=null,m=null,x=null;for(let D of a.visibleComputedXYData)for(let f of D){const g=f.value[a.xyValueIndex[0]],y=f.value[a.xyValueIndex[1]];g>=s&&g<=c&&y>=u&&y<=o&&(i.push(f),(r==null||g<r.value[a.xyValueIndex[0]])&&(r=f),(p==null||g>p.value[a.xyValueIndex[0]])&&(p=f),(m==null||y<m.value[a.xyValueIndex[1]])&&(m=f),(x==null||y>x.value[a.xyValueIndex[1]])&&(x=f))}return{datumList:i,minXDatum:r,maxXDatum:p,minYDatum:m,maxYDatum:x}})),Qe=({xyMinMax$:l,xyValueIndex$:n,filteredXYMinMaxData$:t,fullDataFormatter$:e,layout$:a})=>{const s=new ue;function c({xyMinMax:u,xyValueIndex:o,filteredXYMinMaxData:i,xAxis:r,yAxis:p,width:m,height:x}){let D=0,f=0,g=0,y=0,{minX:Y,maxX:S,minY:I,maxY:X}=u,F=i.minXDatum.value[o[0]]??0,O=i.maxXDatum.value[o[0]]??0,R=i.minYDatum.value[o[1]]??0,L=i.maxYDatum.value[o[1]]??0;F===O&&O===0&&(O=1),R===L&&L===0&&(L=1),Y===S&&S===0&&(S=1),I===X&&X===0&&(X=1);const B=P({maxValue:O,minValue:F,axisWidth:m,scaleDomain:r.scaleDomain,scaleRange:r.scaleRange}),A=B(Y>0?0:Y),w=B(S<0?0:S);D=A,g=(w-A)/m;const E=P({maxValue:L,minValue:R,axisWidth:x,scaleDomain:p.scaleDomain,scaleRange:p.scaleRange,reverse:!0}),ie=E(I>0?0:I),U=E(X<0?0:X);return f=U,y=(ie-U)/x,{translate:[D,f],scale:[g,y],rotate:0,rotateX:0,rotateY:0,value:`translate(${D}px, ${f}px) scale(${g}, ${y})`}}return new ce(u=>(M({xyMinMax:l,xyValueIndex:n,filteredXYMinMaxData:t,fullDataFormatter:e,layout:a}).pipe(me(s),V(async o=>o)).subscribe(o=>{if(!o.filteredXYMinMaxData.minXDatum||!o.filteredXYMinMaxData.maxXDatum||o.filteredXYMinMaxData.minXDatum.value[o.xyValueIndex[0]]==null||o.filteredXYMinMaxData.maxXDatum.value[o.xyValueIndex[0]]==null||!o.filteredXYMinMaxData.minYDatum||!o.filteredXYMinMaxData.maxYDatum||o.filteredXYMinMaxData.minYDatum.value[o.xyValueIndex[1]]==null||o.filteredXYMinMaxData.maxYDatum.value[o.xyValueIndex[1]]==null)return;const i=c({xyMinMax:o.xyMinMax,xyValueIndex:o.xyValueIndex,filteredXYMinMaxData:o.filteredXYMinMaxData,xAxis:o.fullDataFormatter.xAxis,yAxis:o.fullDataFormatter.yAxis,width:o.layout.width,height:o.layout.height});u.next(i)}),function(){s.next(void 0)}))},Ke=({containerPosition$:l,graphicTransform$:n})=>M({containerPosition:l,graphicTransform:n}).pipe(V(async t=>t),b(t=>t.containerPosition.map((e,a)=>[1/t.graphicTransform.scale[0]/t.containerPosition[a].scale[0],1/t.graphicTransform.scale[1]/t.containerPosition[a].scale[1]]))),Ze=({visibleComputedSumData$:l,fullDataFormatter$:n,filteredXYMinMaxData$:t,containerSize$:e})=>M({visibleComputedSumData:l,fullDataFormatter:n,containerSize:e,filteredXYMinMaxData:t}).pipe(V(async a=>a),b(a=>{const s=a.fullDataFormatter.xAxis.valueIndex;if(!a.filteredXYMinMaxData.minXDatum||!a.filteredXYMinMaxData.maxXDatum)return;let c=a.filteredXYMinMaxData.maxXDatum.value[s],u=a.filteredXYMinMaxData.minXDatum.value[s];return c===u&&c===0&&(c=1),P({maxValue:c,minValue:u,axisWidth:a.containerSize.width,scaleDomain:a.fullDataFormatter.xAxis.scaleDomain,scaleRange:a.fullDataFormatter.xAxis.scaleRange})})),et=({fullDataFormatter$:l,filteredXYMinMaxData$:n,containerSize$:t})=>M({fullDataFormatter:l,containerSize:t,filteredXYMinMaxData:n}).pipe(V(async e=>e),b(e=>{const a=e.fullDataFormatter.yAxis.valueIndex;if(!e.filteredXYMinMaxData.minYDatum||!e.filteredXYMinMaxData.maxYDatum||e.filteredXYMinMaxData.minYDatum.value[a]==null||e.filteredXYMinMaxData.maxYDatum.value[a]==null)return;let s=e.filteredXYMinMaxData.maxYDatum.value[a],c=e.filteredXYMinMaxData.minYDatum.value[a];return s===c&&s===0&&(s=1),P({maxValue:s,minValue:c,axisWidth:e.containerSize.height,scaleDomain:e.fullDataFormatter.yAxis.scaleDomain,scaleRange:e.fullDataFormatter.yAxis.scaleRange,reverse:!0})})),tt=({ordinalScaleDomain$:l,computedData$:n,containerSize$:t})=>M({ordinalScaleDomain:l,containerSize:t,computedData:n}).pipe(V(async e=>e),b(e=>{e.computedData[0]&&e.computedData[0][0]&&e.computedData[0][0].value.length&&e.computedData[0][0].value.length-1;let a=e.containerSize.width;const s=e.ordinalScaleDomain[1]-e.ordinalScaleDomain[0];return s>=1?a/(s+1)/2:0})),at=({ordinalScaleDomain$:l,computedData$:n,containerSize$:t,ordinalPadding$:e})=>M({ordinalScaleDomain:l,computedData:n,containerSize:t,ordinalPadding:e}).pipe(V(async a=>a),b(a=>{let s=a.computedData[0]&&a.computedData[0][0]&&a.computedData[0][0].value.length?a.computedData[0][0].value.length-1:0,c=0,u=a.containerSize.width-a.ordinalPadding*2;return P({maxValue:s,minValue:c,axisWidth:u,scaleDomain:a.ordinalScaleDomain,scaleRange:[0,1]})})),nt=({subject:l,observer:n})=>{const t=fe(n.fullChartParams$).pipe(h(1)),e=n.fullDataFormatter$.pipe(b(A=>A.separateCategory),k(),h(1)),a=qe({computedData$:n.computedData$,fullDataFormatter$:n.fullDataFormatter$,layout$:n.layout$}).pipe(h(1)),s=xe({layout$:n.layout$,containerPosition$:a,container$:n.fullDataFormatter$.pipe(b(A=>A.container))}).pipe(h(1)),c=n.fullDataFormatter$.pipe(b(A=>[A.xAxis.valueIndex,A.yAxis.valueIndex]),k((A,w)=>A[0]===w[0]&&A[1]===w[1]),h(1)),u=n.computedData$.pipe(b(A=>A.flat().flat())).pipe(h(1)),o=De({datumList$:u,fullChartParams$:n.fullChartParams$,event$:l.event$}).pipe(h(1)),i=_e({computedData$:n.computedData$,fullDataFormatter$:n.fullDataFormatter$}).pipe(h(1)),r=ye({datumList$:u}).pipe(h(1)),p=He({fullDataFormatter$:n.fullDataFormatter$,computedData$:n.computedData$}).pipe(h(1)),m=ke({computedData$:n.computedData$,xyValueIndex$:c}).pipe(h(1)),x=We({computedData$:n.computedData$}).pipe(h(1)),D=Ee({fullDataFormatter$:n.fullDataFormatter$,visibleComputedData$:x}).pipe(h(1)),f=Ue({visibleComputedData$:x,ordinalScaleDomain$:D}).pipe(h(1)),g=Ne({xyValueIndex$:c,isCategorySeprate$:e,visibleComputedData$:x}).pipe(h(1)),y=je({isCategorySeprate$:e,visibleComputedSumData$:f}).pipe(h(1)),Y=ze({computedData$:n.computedData$,xyMinMax$:m,xyValueIndex$:c,fullDataFormatter$:n.fullDataFormatter$,layout$:n.layout$}).pipe(h(1)),S=Ge({computedXYData$:Y}).pipe(h(1)),I=Je({visibleComputedXYData$:S,xyMinMax$:m,xyValueIndex$:c,fullDataFormatter$:n.fullDataFormatter$}).pipe(h(1)),X=Qe({xyMinMax$:m,xyValueIndex$:c,filteredXYMinMaxData$:I,fullDataFormatter$:n.fullDataFormatter$,layout$:n.layout$}).pipe(h(1)),F=Ke({containerPosition$:a,graphicTransform$:X}).pipe(h(1)),O=Ze({visibleComputedSumData$:f,fullDataFormatter$:n.fullDataFormatter$,filteredXYMinMaxData$:I,containerSize$:s}).pipe(h(1)),R=et({fullDataFormatter$:n.fullDataFormatter$,filteredXYMinMaxData$:I,containerSize$:s}).pipe(h(1)),L=tt({ordinalScaleDomain$:D,computedData$:n.computedData$,containerSize$:s}).pipe(h(1)),B=at({ordinalScaleDomain$:D,computedData$:n.computedData$,containerSize$:s,ordinalPadding$:L}).pipe(h(1));return{fullParams$:n.fullParams$,fullChartParams$:n.fullChartParams$,fullDataFormatter$:n.fullDataFormatter$,computedData$:n.computedData$,layout$:n.layout$,textSizePx$:t,isCategorySeprate$:e,containerPosition$:a,containerSize$:s,highlight$:o,categoryLabels$:i,CategoryDataMap$:r,valueLabels$:p,xyMinMax$:m,xyValueIndex$:c,visibleComputedData$:x,visibleComputedSumData$:f,visibleComputedRankingByIndexData$:g,visibleComputedRankingBySumData$:y,visibleComputedXYData$:S,filteredXYMinMaxData$:I,graphicTransform$:X,graphicReverseScale$:F,xScale$:O,yScale$:R,ordinalScaleDomain$:D,ordinalPadding$:L,ordinalScale$:B}};class yt extends ge{constructor(n,t){super({defaultDataFormatter:he,dataFormatterValidator:Re,computedDataFn:Be,dataValidator:we,contextObserverCallback:nt},n,t)}}var it=function(l){W(n,l);function n(t,e){return l.call(this)||this}return n.prototype.schedule=function(t,e){return this},n}(be),J={setInterval:function(l,n){for(var t=[],e=2;e<arguments.length;e++)t[e-2]=arguments[e];return setInterval.apply(void 0,de([l,n],ve(t)))},clearInterval:function(l){return clearInterval(l)},delegate:void 0},rt=function(l){W(n,l);function n(t,e){var a=l.call(this,t,e)||this;return a.scheduler=t,a.work=e,a.pending=!1,a}return n.prototype.schedule=function(t,e){var a;if(e===void 0&&(e=0),this.closed)return this;this.state=t;var s=this.id,c=this.scheduler;return s!=null&&(this.id=this.recycleAsyncId(c,s,e)),this.pending=!0,this.delay=e,this.id=(a=this.id)!==null&&a!==void 0?a:this.requestAsyncId(c,this.id,e),this},n.prototype.requestAsyncId=function(t,e,a){return a===void 0&&(a=0),J.setInterval(t.flush.bind(t,this),a)},n.prototype.recycleAsyncId=function(t,e,a){if(a===void 0&&(a=0),a!=null&&this.delay===a&&this.pending===!1)return e;e!=null&&J.clearInterval(e)},n.prototype.execute=function(t,e){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var a=this._execute(t,e);if(a)return a;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},n.prototype._execute=function(t,e){var a=!1,s;try{this.work(t)}catch(c){a=!0,s=c||new Error("Scheduled action threw falsy error")}if(a)return this.unsubscribe(),s},n.prototype.unsubscribe=function(){if(!this.closed){var t=this,e=t.id,a=t.scheduler,s=a.actions;this.work=this.state=this.scheduler=null,this.pending=!1,$e(s,this),e!=null&&(this.id=this.recycleAsyncId(a,e,null)),this.delay=null,l.prototype.unsubscribe.call(this)}},n}(it),Q=function(){function l(n,t){t===void 0&&(t=l.now),this.schedulerActionCtor=n,this.now=t}return l.prototype.schedule=function(n,t,e){return t===void 0&&(t=0),new this.schedulerActionCtor(this,n).schedule(e,t)},l.now=Me.now,l}(),lt=function(l){W(n,l);function n(t,e){e===void 0&&(e=Q.now);var a=l.call(this,t,e)||this;return a.actions=[],a._active=!1,a}return n.prototype.flush=function(t){var e=this.actions;if(this._active){e.push(t);return}var a;this._active=!0;do if(a=t.execute(t.state,t.delay))break;while(t=e.shift());if(this._active=!1,a){for(;t=e.shift();)t.unsubscribe();throw a}},n}(Q),ot=new lt(rt);function te(l,n){return n===void 0&&(n=ot),Se(function(t,e){var a=null,s=null,c=null,u=function(){if(a){a.unsubscribe(),a=null;var i=s;s=null,e.next(i)}};function o(){var i=c+l,r=n.now();if(r<i){a=this.schedule(void 0,i-r),e.add(a);return}u()}t.subscribe(Ae(e,function(i){s=i,c=n.now(),a||(a=n.schedule(o,l),e.add(a))},function(){u(),e.complete()},void 0,function(){s=a=null}))})}const ae="MultiValueLegend",st={name:ae,defaultParams:Xe,layerIndex:Ye,validator:(l,{validateColumns:n})=>n(l,{placement:{toBe:'"top" | "top-start" | "top-end" | "bottom" | "bottom-start" | "bottom-end" | "left" | "left-start" | "left-end" | "right" | "right-start" | "right-end"',test:e=>["top","top-start","top-end","bottom","bottom-start","bottom-end","left","left-start","left-end","right","right-start","right-end"].includes(e)},padding:{toBeTypes:["number"]},backgroundFill:{toBeOption:"ColorType"},backgroundStroke:{toBeOption:"ColorType"},gap:{toBeTypes:["number"]},listRectWidth:{toBeTypes:["number"]},listRectHeight:{toBeTypes:["number"]},listRectRadius:{toBeTypes:["number"]},textColorType:{toBeOption:"ColorType"}})},gt=K(st)(({selection:l,rootSelection:n,observer:t,subject:e})=>{const a=new Z,s=t.CategoryDataMap$.pipe(G(a),d(o=>Array.from(o.keys()))),c=t.fullParams$.pipe(G(a),d(o=>{const i=[{listRectWidth:o.listRectWidth,listRectHeight:o.listRectHeight,listRectRadius:o.listRectRadius}];return{...o,labelList:i}})),u=Oe(ae,{rootSelection:n,legendLabels$:s,fullParams$:c,layout$:t.layout$,fullChartParams$:t.fullChartParams$,textSizePx$:t.textSizePx$});return()=>{a.next(void 0),u()}}),ne="MultiValueTooltip",ut={name:ne,defaultParams:Ce,layerIndex:Ve,validator:(l,{validateColumns:n})=>n(l,{backgroundColorType:{toBeOption:"ColorType"},backgroundOpacity:{toBeTypes:["number"]},strokeColorType:{toBeOption:"ColorType"},offset:{toBe:"[number, number]",test:e=>Array.isArray(e)&&e.length===2&&typeof e[0]=="number"&&typeof e[1]=="number"},padding:{toBeTypes:["number"]},textColorType:{toBeOption:"ColorType"},renderFn:{toBeTypes:["Function"]}})},ht=K(ut)(({selection:l,rootSelection:n,name:t,subject:e,observer:a})=>{const s=new Z,c=Te(ne,{rootSelection:n,fullParams$:a.fullParams$,fullChartParams$:a.fullChartParams$,layout$:a.layout$,event$:e.event$});return()=>{s.next(void 0),c()}}),bt=({selection:l,pluginName:n,clipPathID:t,categoryLabels$:e,containerPosition$:a,graphicTransform$:s})=>{const c=H(n,"category"),u=H(n,"axes"),o=H(n,"graphic"),i=e.pipe(d((x,D)=>l.selectAll(`g.${c}`).data(x,f=>f).join(f=>f.append("g").classed(c,!0).each((g,y,Y)=>{_(Y[y]).selectAll(`g.${u}`).data([y]).join(S=>S.append("g").classed(u,!0).attr("clip-path",`url(#${t})`).each((I,X,F)=>{_(F[X]).selectAll("defs").data([X]).join("defs"),_(F[X]).selectAll("g").data([X]).join("g").classed(o,!0)}),S=>S,S=>S.remove())}),f=>f,f=>f.remove())),C(1));$({categorySelection:i,containerPosition:a}).pipe(v(async x=>x)).subscribe(x=>{x.categorySelection.transition().attr("transform",(D,f)=>{const g=x.containerPosition[f]??x.containerPosition[0],y=g.translate,Y=g.scale;return`translate(${y[0]}, ${y[1]}) scale(${Y[0]}, ${Y[1]})`})});const r=i.pipe(d(x=>x.select(`g.${u}`)),C(1)),p=r.pipe(d(x=>x.select("defs")),C(1)),m=$({axesSelection:r,graphicTransform:s}).pipe(v(async x=>x),d(x=>{const D=x.axesSelection.select(`g.${o}`);return D.transition().duration(50).style("transform",x.graphicTransform.value),D}),C(1));return{categorySelection$:i,axesSelection$:r,defsSelection$:p,graphicGSelection$:m}},dt=({selection:l,pluginName:n,clipPathID:t,computedData$:e,containerPosition$:a,isCategorySeprate$:s})=>{const c=H(n,"container"),u=$({computedData:e.pipe(z((o,i)=>o.length===i.length)),isCategorySeprate:s}).pipe(v(async o=>o),d(o=>o.isCategorySeprate?o.computedData:[o.computedData[0]]),d((o,i)=>l.selectAll(`g.${c}`).data(o,r=>r&&r[0]?r[0].categoryIndex:i).join("g").classed(c,!0).attr("clip-path",r=>t?`url(#${t})`:"none")),C(1));return $({containerSelection:u,gridContainerPosition:a}).pipe(v(async o=>o)).subscribe(o=>{o.containerSelection.attr("transform",(i,r)=>{const p=o.gridContainerPosition[r]??o.gridContainerPosition[0],m=p.translate;return p.scale,`translate(${m[0]}, ${m[1]})`})}),u},vt=({rootSelection:l,fullDataFormatter$:n,filteredXYMinMaxData$:t,containerPosition$:e,containerSize$:a,layout$:s})=>{const c=ee(l,"mousemove").pipe(te(2)),u=new Ie(i=>{$({containerSize:a,filteredXYMinMaxData:t,fullDataFormatter:n}).pipe(v(async r=>r)).subscribe(r=>{const p=r.fullDataFormatter.xAxis.valueIndex,m=r.fullDataFormatter.yAxis.valueIndex;if(!r.filteredXYMinMaxData.minXDatum||!r.filteredXYMinMaxData.maxXDatum||r.filteredXYMinMaxData.minXDatum.value[p]==null||r.filteredXYMinMaxData.maxXDatum.value[p]==null||!r.filteredXYMinMaxData.minYDatum||!r.filteredXYMinMaxData.maxYDatum||r.filteredXYMinMaxData.minYDatum.value[m]==null||r.filteredXYMinMaxData.maxYDatum.value[m]==null)return;const x=q({maxValue:r.filteredXYMinMaxData.maxXDatum.value[p],minValue:r.filteredXYMinMaxData.minXDatum.value[p],axisWidth:r.containerSize.width,scaleDomain:r.fullDataFormatter.xAxis.scaleDomain,scaleRange:r.fullDataFormatter.xAxis.scaleRange}),D=q({maxValue:r.filteredXYMinMaxData.maxYDatum.value[m],minValue:r.filteredXYMinMaxData.minYDatum.value[m],axisWidth:r.containerSize.height,scaleDomain:r.fullDataFormatter.yAxis.scaleDomain,scaleRange:r.fullDataFormatter.yAxis.scaleRange,reverse:!0});i.next({xScale:x,yScale:D})})}),o=$({rootMousemove:c,layout:s,containerPosition:e}).pipe(v(async i=>i),d(i=>{const r=(()=>{let m=i.rootMousemove.offsetX;const D=i.containerPosition.map((f,g)=>{var y;return[f.translate[0],((y=i.containerPosition[g+1])==null?void 0:y.translate[0])??i.layout.rootWidth]}).filter(f=>f[0]<f[1]).find(f=>m>=f[0]&&m<=f[1]);return D&&(m=m-D[0]),m-i.layout.left})(),p=(()=>{let m=i.rootMousemove.offsetY;const D=i.containerPosition.map((f,g)=>{var y;return[f.translate[1],((y=i.containerPosition[g+1])==null?void 0:y.translate[1])??i.layout.rootHeight]}).filter(f=>f[0]<f[1]).find(f=>m>=f[0]&&m<=f[1]);return D&&(m=m-D[0]),m-i.layout.top})();return{x:r,y:p}}));return $({xyScale:u,axisValue:o,containerPosition:e}).pipe(v(async i=>i),d(i=>({x:i.axisValue.x/i.containerPosition[0].scale[0],y:i.axisValue.y/i.containerPosition[0].scale[1],xValue:i.xyScale.xScale(i.axisValue.x),yValue:i.xyScale.yScale(i.axisValue.y)})))},$t=({rootSelection:l,ordinalScaleDomain$:n,ordinalScale$:t,ordinalPadding$:e,containerSize$:a,containerPosition$:s,layout$:c})=>{const u=ee(l,"mousemove").pipe(te(2)),o=$({rootMousemove:u,layout:c,containerPosition:s}).pipe(v(async r=>r),d(r=>{let p=r.rootMousemove.offsetX;const x=r.containerPosition.map((D,f)=>{var g;return[D.translate[0],((g=r.containerPosition[f+1])==null?void 0:g.translate[0])??r.layout.rootWidth]}).filter(D=>D[0]<D[1]).find(D=>p>=D[0]&&p<=D[1]);return x&&(p=p-x[0]),p-r.layout.left})),i=n.pipe(d(r=>{const p=r[1]-r[0]+1;return new Array(p).fill(0).map((m,x)=>String(x+r[0]))}));return $({scaleRangeLabels:i,containerSize:a,axisX:o,ordinalScale:t,ordinalPadding:e,ordinalScaleDomain:n,containerPosition:s}).pipe(v(async r=>r),d(r=>{const x=Fe({axisLabels:r.scaleRangeLabels,axisWidth:r.containerSize.width,padding:.5,reverse:!1})(r.axisX)+r.ordinalScaleDomain[0];return{x:(r.ordinalScale(x)+r.ordinalPadding)/r.containerPosition[0].scale[0],xValue:x}}))},Mt=({containerSize$:l,visibleComputedData$:n,textSizePx$:t,rankingAmount$:e})=>{const a=({textSizePx$:r})=>r.pipe(d(p=>p*2),C(1)),s=({minLineHeight$:r,containerSize$:p})=>$({minLineHeight:r,containerSize:p}).pipe(v(async m=>m),d(m=>m.containerSize.height>m.minLineHeight?m.containerSize.height:m.minLineHeight),z(),C(1)),c=({minLineHeight$:r,containerHeight$:p})=>$({minLineHeight:r,containerHeight:p}).pipe(v(async m=>m),d(m=>Math.floor(m.containerHeight/m.minLineHeight)),z(),C(1)),u=a({textSizePx$:t}),o=s({minLineHeight$:u,containerSize$:l}),i=c({containerHeight$:o,minLineHeight$:u});return e.pipe(v(r=>Le(()=>r==="auto",$({visibleComputedData:n,rankingAmountLimit:i}).pipe(v(async p=>p),d(p=>{const m=p.visibleComputedData.map(x=>Math.min(p.rankingAmountLimit,x.length));return Math.max(...m)})),e)))},St=({containerSize$:l,textSizePx$:n,computedRankingAmount$:t})=>{const e=({textSizePx$:u})=>u.pipe(d(o=>o*2),C(1)),a=({minLineHeight$:u,containerSize$:o})=>$({minLineHeight:u,containerSize:o}).pipe(v(async i=>i),d(i=>i.containerSize.height>i.minLineHeight?i.containerSize.height:i.minLineHeight),z(),C(1)),s=e({textSizePx$:n}),c=a({minLineHeight$:s,containerSize$:l});return $({containerHeight:c,computedRankingAmount:t}).pipe(v(async u=>u),d(u=>u.containerHeight/u.computedRankingAmount))},At=({visibleComputedRankingData$:l,rankingItemHeight$:n})=>$({visibleComputedRankingData:l,rankingItemHeight:n}).pipe(v(async t=>t),d(t=>t.visibleComputedRankingData.map((e,a)=>{const s=e.length,c=t.rankingItemHeight*s;return Pe({axisLabels:e.map(u=>u.label),axisWidth:c,padding:.5})})));export{gt as M,ht as a,yt as b,vt as c,dt as d,Mt as e,At as f,bt as m,$t as o,St as r};
