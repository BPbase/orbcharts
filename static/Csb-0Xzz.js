import{u as D}from"./CWBAyBLC.js";import{s as L}from"./08ME7XgU.js";import{S as y}from"./BDfp3Xtn.js";import"./DimhisTc.js";import{D as T,a as C,S as b,t as h,s as v,m as S,d as E,c as F,b as _}from"./Bj-Bl9V3.js";import{B as w}from"./shoOv0bZ.js";import{s as A,P as N}from"./CPnZa-8b.js";import{g as M}from"./wVpfmAyl.js";import{P as R,R as k,a as j}from"./otmx9MIU.js";import{S as U}from"./C-4_TVQ7.js";import B from"./0eJhi8kD.js";import{e as H,f as I,g as O,o as q,c as V}from"./D8ccWnmM.js";import"./CLcyYSDM.js";import"./C6aT9cyB.js";const $="PieEventTexts",P=M($,"text");function g(u,r){const s=u.selectAll(`text.${P}`).data(r),t=s.enter().append("text").classed(P,!0),n=s.merge(t);return n.each((e,l,o)=>{const i=v(o[l]).text(e.text);Object.keys(e.attr).forEach(a=>{i.attr(a,e.attr[a])}),Object.keys(e.style).forEach(a=>{i.style(a,e.style[a])})}),s.exit().remove(),n}function d({eventData:u,eventName:r,t:s,eventFn:t,textAttrs:n,textStyles:e}){return t(u,r,s).map((o,i)=>({text:o,attr:n[i],style:e[i]}))}function X(u,r){const s=new b;let t;const n=r.fullChartParams$.pipe(h(s),S(e=>e.highlightTarget),E());return F({computedData:r.computedData$,fullParams:r.fullParams$,fullChartParams:r.fullChartParams$,highlightTarget:n}).pipe(h(s),_(async e=>e)).subscribe(e=>{r.containerSelection.transition("move").duration(e.fullChartParams.transitionDuration).tween("move",(l,o)=>i=>{const a=d({eventData:{type:"series",pluginName:u,eventName:"transitionMove",event:l,highlightTarget:e.highlightTarget,data:e.computedData,series:[],seriesIndex:-1,seriesLabel:"",datum:null},eventName:"transitionMove",t:i,eventFn:e.fullParams.eventFn,textAttrs:e.fullParams.textAttrs,textStyles:e.fullParams.textStyles});g(r.containerSelection,a)}).on("end",(l,o)=>{const i=d({eventData:{type:"series",pluginName:u,eventName:"transitionEnd",event:l,highlightTarget:e.highlightTarget,data:e.computedData,series:[],seriesIndex:-1,seriesLabel:"",datum:null},eventName:"transitionMove",t:1,eventFn:e.fullParams.eventFn,textAttrs:e.fullParams.textAttrs,textStyles:e.fullParams.textStyles});g(r.containerSelection,i),t&&t.unsubscribe(),t=r.event$.subscribe(a=>{const c=d({eventData:a,eventName:a.eventName,t:1,eventFn:e.fullParams.eventFn,textAttrs:e.fullParams.textAttrs,textStyles:e.fullParams.textStyles});g(r.containerSelection,c)})})}),()=>{s.next(void 0)}}const z=T($,C)(({selection:u,name:r,observer:s,subject:t})=>{const n=new b,{seriesCenterSelection$:e}=A({selection:u,pluginName:$,separateSeries$:s.separateSeries$,seriesLabels$:s.seriesLabels$,seriesContainerPosition$:s.seriesContainerPosition$}),l=[];return e.pipe(h(n)).subscribe(o=>{l.forEach(i=>i()),o.each((i,a,c)=>{const m=v(c[a]),p=s.computedLayoutData$.pipe(h(n),S(f=>f[a]??f[0])),x=s.seriesContainerPosition$.pipe(h(n),S(f=>f[a]??f[0]));l[a]=X($,{containerSelection:m,computedData$:s.computedData$,containerComputedLayoutData$:p,SeriesDataMap$:s.SeriesDataMap$,fullParams$:s.fullParams$,fullChartParams$:s.fullChartParams$,seriesHighlight$:s.seriesHighlight$,seriesContainerPosition$:x,event$:t.event$})})}),()=>{n.next(void 0),l.forEach(o=>o())}}),G={id:"chart",style:{width:"100%",height:"100%"}},oe=H({__name:"index",setup(u){D({title:"Demo 1"});let r;return I(()=>{const s=document.querySelector("#chart"),t=new y(s,{}),n=new N,e=new R,l=new k,o=new j,i=new z,a=new w,c=new U;e.params$.next({outerRadius:1.2}),o.params$.next({outerRadius:1.2}),t.chartParams$.next({padding:{top:200,right:200,bottom:200,left:200}}),t.plugins$.next([a,c]),t.dataFormatter$.next({sumSeries:!1,separateSeries:!1,seriesLabels:["關鍵字","組織團體","地點","人物","企業品牌"]});let m=0,p=0;const x=4,f=1;r=L(()=>{m==0?(p==1&&(t.plugins$.next([n,e,c]),n.params$.next({innerRadius:0})),t.dataFormatter$.next({sumSeries:!1,separateSeries:!0,seriesLabels:["關鍵字","組織團體","地點","人物","企業品牌"]})):m==1?p==1?t.plugins$.next([l,o,c]):t.dataFormatter$.next({sumSeries:!0,separateSeries:!0,seriesLabels:["關鍵字","組織團體","地點","人物","企業品牌"]}):m==2?t.dataFormatter$.next({sumSeries:!0,separateSeries:!1,seriesLabels:["關鍵字","組織團體","地點","人物","企業品牌"]}):m==3?t.dataFormatter$.next({sumSeries:!1,separateSeries:!1,seriesLabels:["關鍵字","組織團體","地點","人物","企業品牌"]}):m==4&&(t.dataFormatter$.next({sumSeries:!1,separateSeries:!1,seriesLabels:["關鍵字","組織團體","地點","人物","企業品牌"]}),p==0?(n.params$.next({innerRadius:.5}),t.plugins$.next([n,e,i,c])):p==1&&t.plugins$.next([a,c])),m++,m>x&&(m=0,p++),p>f&&(p=0)},2e3),t.data$.next(B)}),O(()=>{clearInterval(r)}),(s,t)=>(q(),V("div",G))}});export{oe as default};
