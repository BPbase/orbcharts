import{S as G,k as S,b as Y,t as u,l as k,m as y,c as I,s as w,aT as U,aE as q,aV as F}from"./CJz0rwbW.js";import{j as V,n as H,g as C,h as E,o as J}from"./D7qTWgnP.js";import{b as K}from"./DdT0iQQs.js";const Q=6;function Z(m,T){return m.map((t,f)=>{const A=E(t,T),s=typeof A=="string"?A.split(`
`):[A];return{text:A,textArr:s}})}function _({selection:m,groupingLabelClassName:T,fullParams:t,axisLabelAlign:f,gridAxesSize:A,fullDataFormatter:s,chartParams:v,textReverseTransform:R}){const g=t.tickPadding+t.labelOffset[0],r=t.tickPadding+t.labelOffset[1];let a=0,x=0;s.grid.groupAxis.position==="bottom"?(x=r,s.grid.valueAxis.position==="left"?a=g:s.grid.valueAxis.position==="right"&&(a=-g)):s.grid.groupAxis.position==="top"?(x=-r,s.grid.valueAxis.position==="left"?a=g:s.grid.valueAxis.position==="right"&&(a=-g)):s.grid.groupAxis.position==="left"?(a=-g,s.grid.valueAxis.position==="bottom"?x=-r:s.grid.valueAxis.position==="top"&&(x=r)):s.grid.groupAxis.position==="right"&&(a=g,s.grid.valueAxis.position==="bottom"?x=-r:s.grid.valueAxis.position==="top"&&(x=r)),m.selectAll(`g.${T}`).data([t]).join("g").classed(T,!0).each((o,h,b)=>{w(b[h]).selectAll("text").data([o]).join(c=>c.append("text").style("font-weight","bold"),c=>c,c=>c.remove()).attr("text-anchor",f.textAnchor).attr("dominant-baseline",f.dominantBaseline).attr("font-size",v.styles.textSize).style("fill",V(t.labelColorType,v)).style("transform",R).attr("x",a).attr("y",x).text(c=>s.grid.groupAxis.label)}).attr("transform",o=>`translate(${A.width}, 0)`)}function N({selection:m,xAxisClassName:T,fullParams:t,tickTextAlign:f,gridAxesSize:A,fullDataFormatter:s,chartParams:v,groupScale:R,groupScaleDomain:g,groupLabelData:r,textReverseTransformWithRotate:a,textSizePx:x}){const o=m.selectAll(`g.${T}`).data([t]).join("g").classed(T,!0),h=Math.floor(g[1])-Math.ceil(g[0])+1;let b=0,c=0;s.grid.groupAxis.position==="left"?(b=0,c=-t.tickPadding):s.grid.groupAxis.position==="right"?(b=0,c=t.tickPadding):s.grid.groupAxis.position==="bottom"?(b=t.tickPadding,c=0):s.grid.groupAxis.position==="top"&&(b=-t.tickPadding,c=-0);const L=H(R).scale(R).ticks(t.ticks==="all"||t.ticks>h?h:t.ticks).tickSize(t.tickFullLine==!0?A.height:-Q).tickSizeOuter(0).tickFormat(z=>{var D;return((D=r[z])==null?void 0:D.text)??""}).tickPadding(b),$=o.transition().duration(100).call(L).on("end",(z,D)=>{o.selectAll(".tick text").each((j,M,X)=>{var n;const i=((n=r[j])==null?void 0:n.textArr)??[];K(w(X[M]),{textArr:i,textSizePx:x,groupAxisPosition:s.grid.groupAxis.position})})});return $.selectAll("line").style("fill","none").style("stroke",t.tickLineVisible==!0?V(t.tickColorType,v):"none").style("stroke-dasharray",t.tickFullLineDasharray).attr("pointer-events","none"),$.selectAll("path").style("fill","none").style("stroke",t.axisLineVisible==!0?V(t.axisLineColorType,v):"none").style("shape-rendering","crispEdges"),o.selectAll("text").attr("font-size",v.styles.textSize).attr("fill",V(t.tickTextColorType,v)).attr("text-anchor",f.textAnchor).attr("dominant-baseline",f.dominantBaseline).attr("x",c).style("transform",a).attr("dy",0),o}const re=(m,{selection:T,computedData$:t,fullParams$:f,fullDataFormatter$:A,fullChartParams$:s,gridAxesTransform$:v,gridAxesReverseTransform$:R,gridAxesSize$:g,gridContainerPosition$:r,isSeriesSeprate$:a,textSizePx$:x})=>{const o=new G,h=C(m,"container"),b=C(m,"xAxisG"),c=C(m,"xAxis"),L=C(m,"groupingLabel"),$=S({computedData:t.pipe(Y((e,l)=>e.length===l.length)),isSeriesSeprate:a}).pipe(u(o),k(async e=>e),y(e=>e.isSeriesSeprate?e.computedData:[e.computedData[0]]),y((e,l)=>T.selectAll(`g.${h}`).data(e,p=>p[0]?p[0].seriesIndex:l).join("g").classed(h,!0))),P=$.pipe(u(o),y((e,l)=>e.selectAll(`g.${b}`).data([b]).join("g").classed(b,!0)));S({containerSelection:$,gridContainerPosition:r}).pipe(u(o),k(async e=>e)).subscribe(e=>{e.containerSelection.attr("transform",(l,p)=>{const B=e.gridContainerPosition[p]??e.gridContainerPosition[0],W=B.translate,O=B.scale;return`translate(${W[0]}, ${W[1]}) scale(${O[0]}, ${O[1]})`})}),S({axisSelection:P,gridAxesTransform:v}).pipe(u(o),k(async e=>e)).subscribe(e=>{e.axisSelection.style("transform",e.gridAxesTransform.value)});const z=S({gridAxesReverseTransform:R,gridContainerPosition:r}).pipe(u(o),k(async e=>e),y(e=>{const l=`rotateX(${e.gridAxesReverseTransform.rotateX}deg) rotateY(${e.gridAxesReverseTransform.rotateY}deg)`,p=`rotate(${e.gridAxesReverseTransform.rotate}deg)`,B=`scale(${1/e.gridContainerPosition[0].scale[0]}, ${1/e.gridContainerPosition[0].scale[1]})`;return`${l} ${p} ${B}`}),Y()),D=S({textReverseTransform:z,fullParams:f}).pipe(u(o),k(async e=>e),y(e=>`${e.textReverseTransform} rotate(${e.fullParams.tickTextRotate}deg)`)),j=S({fullDataFormatter:A,gridAxesSize:g,computedData:t}).pipe(u(o),k(async e=>e),y(e=>{const l=e.computedData[0]?e.computedData[0].length-1:0,p=e.fullDataFormatter.grid.groupAxis.scaleDomain[0]-e.fullDataFormatter.grid.groupAxis.scalePadding,B=e.fullDataFormatter.grid.groupAxis.scaleDomain[1]==="max"?l+e.fullDataFormatter.grid.groupAxis.scalePadding:e.fullDataFormatter.grid.groupAxis.scaleDomain[1]+e.fullDataFormatter.grid.groupAxis.scalePadding;return[p,B]}),I(1)),M=S({groupScaleDomain:j,gridAxesSize:g}).pipe(u(o),k(async e=>e),y(e=>U().domain(e.groupScaleDomain).range([0,e.gridAxesSize.width]))),X=t.pipe(y(e=>(e[0]??[]).map(l=>l.groupLabel))),i=S({fullDataFormatter:A,fullParams:f}).pipe(u(o),k(async e=>e),y(e=>{let l="middle",p="hanging";return e.fullDataFormatter.grid.groupAxis.position==="bottom"?(l=e.fullParams.tickTextRotate?"end":"middle",p="hanging"):e.fullDataFormatter.grid.groupAxis.position==="top"?(l=e.fullParams.tickTextRotate?"start":"middle",p="auto"):e.fullDataFormatter.grid.groupAxis.position==="left"?(l="end",p="middle"):e.fullDataFormatter.grid.groupAxis.position==="right"&&(l="start",p="middle"),{textAnchor:l,dominantBaseline:p}})),n=A.pipe(u(o),y(e=>{let l="start",p="hanging";return e.grid.groupAxis.position==="bottom"?p="hanging":e.grid.groupAxis.position==="top"?p="auto":e.grid.groupAxis.position==="left"?l="end":e.grid.groupAxis.position==="right"&&(l="start"),e.grid.valueAxis.position==="left"?l="start":e.grid.valueAxis.position==="right"?l="end":e.grid.valueAxis.position==="bottom"?p="auto":e.grid.valueAxis.position==="top"&&(p="hanging"),{textAnchor:l,dominantBaseline:p}})),d=S({groupLabels:X,fullParams:f}).pipe(u(o),k(async e=>e),y(e=>Z(e.groupLabels,e.fullParams.tickFormat)));return S({axisSelection:P,fullParams:f,tickTextAlign:i,axisLabelAlign:n,gridAxesSize:g,fullDataFormatter:A,chartParams:s,groupScale:M,groupScaleDomain:j,groupLabelData:d,textReverseTransform:z,textReverseTransformWithRotate:D,textSizePx:x}).pipe(u(o),k(async e=>e)).subscribe(e=>{N({selection:e.axisSelection,xAxisClassName:c,fullParams:e.fullParams,tickTextAlign:e.tickTextAlign,gridAxesSize:e.gridAxesSize,fullDataFormatter:e.fullDataFormatter,chartParams:e.chartParams,groupScale:e.groupScale,groupScaleDomain:e.groupScaleDomain,groupLabelData:e.groupLabelData,textReverseTransformWithRotate:e.textReverseTransformWithRotate,textSizePx:e.textSizePx}),_({selection:e.axisSelection,groupingLabelClassName:L,fullParams:e.fullParams,axisLabelAlign:e.axisLabelAlign,gridAxesSize:e.gridAxesSize,fullDataFormatter:e.fullDataFormatter,chartParams:e.chartParams,textReverseTransform:e.textReverseTransform})}),()=>{o.next(void 0)}},ee=6;function ie({selection:m,textClassName:T,fullParams:t,axisLabelAlign:f,gridAxesSize:A,fullDataFormatter:s,fullChartParams:v,textReverseTransform:R}){const g=t.tickPadding-t.labelOffset[0],r=t.tickPadding+t.labelOffset[1];let a=0,x=0;s.grid.groupAxis.position==="bottom"?(x=-r,s.grid.valueAxis.position==="left"?a=-g:s.grid.valueAxis.position==="right"&&(a=g)):s.grid.groupAxis.position==="top"?(x=r,s.grid.valueAxis.position==="left"?a=-g:s.grid.valueAxis.position==="right"&&(a=g)):s.grid.groupAxis.position==="left"?(a=g,s.grid.valueAxis.position==="bottom"?x=r:s.grid.valueAxis.position==="top"&&(x=-r)):s.grid.groupAxis.position==="right"&&(a=-g,s.grid.valueAxis.position==="bottom"?x=r:s.grid.valueAxis.position==="top"&&(x=-r)),m.selectAll(`g.${T}`).data([t]).join("g").classed(T,!0).each((o,h,b)=>{w(b[h]).selectAll("text").data([o]).join(c=>c.append("text").style("font-weight","bold"),c=>c,c=>c.remove()).attr("text-anchor",f.textAnchor).attr("dominant-baseline",f.dominantBaseline).attr("font-size",v.styles.textSize).style("fill",V(t.labelColorType,v)).style("transform",R).attr("x",a).attr("y",x).text(c=>s.grid.valueAxis.label)}).attr("transform",o=>`translate(0, ${A.height})`)}function te({selection:m,yAxisClassName:T,fullParams:t,tickTextAlign:f,gridAxesSize:A,fullDataFormatter:s,fullChartParams:v,valueScale:R,textReverseTransformWithRotate:g,filteredMinMaxValue:r}){const a=m.selectAll(`g.${T}`).data([t]).join("g").classed(T,!0),x=r[1]-r[0];let o=0,h=0;s.grid.valueAxis.position==="left"?(o=t.tickPadding,h=0):s.grid.valueAxis.position==="right"?(o=-t.tickPadding,h=0):s.grid.valueAxis.position==="bottom"?(o=0,h=t.tickPadding):s.grid.valueAxis.position==="top"&&(o=0,h=-t.tickPadding);const b=J(R).scale(R).ticks(x>t.ticks?t.ticks:r[0]===0&&r[1]===0?1:Math.ceil(x)).tickFormat($=>E($,t.tickFormat)).tickSize(t.tickFullLine==!0?-A.width:ee).tickPadding(o),c=a.transition().duration(100).call(b);c.selectAll("line").style("fill","none").style("stroke",t.tickLineVisible==!0?V(t.tickColorType,v):"none").style("stroke-dasharray",t.tickFullLineDasharray).attr("pointer-events","none"),c.selectAll("path").style("fill","none").style("stroke",t.axisLineVisible==!0?V(t.axisLineColorType,v):"none").style("shape-rendering","crispEdges");const L=a.selectAll("text").attr("font-size",v.styles.textSize).style("color",V(t.tickTextColorType,v)).attr("text-anchor",f.textAnchor).attr("dominant-baseline",f.dominantBaseline).attr("y",h).attr("dy",0);return L.style("transform",g),(s.grid.valueAxis.position==="bottom"||s.grid.valueAxis.position==="top")&&L.attr("dy",0),a}const le=(m,{selection:T,computedData$:t,filteredMinMaxValue$:f,fullParams$:A,fullDataFormatter$:s,fullChartParams$:v,gridAxesTransform$:R,gridAxesReverseTransform$:g,gridAxesSize$:r,gridContainerPosition$:a,isSeriesSeprate$:x})=>{const o=new G,h=C(m,"container"),b=C(m,"yAxisG"),c=C(m,"yAxis"),L=C(m,"text"),$=S({computedData:t.pipe(Y((i,n)=>i.length===n.length)),isSeriesSeprate:x}).pipe(u(o),k(async i=>i),y(i=>i.isSeriesSeprate?i.computedData:[i.computedData[0]]),y((i,n)=>T.selectAll(`g.${h}`).data(i,d=>d[0]?d[0].seriesIndex:n).join("g").classed(h,!0))),P=$.pipe(u(o),y((i,n)=>i.selectAll(`g.${b}`).data([b]).join("g").classed(b,!0)));S({containerSelection:$,gridContainerPosition:a}).pipe(u(o),k(async i=>i)).subscribe(i=>{i.containerSelection.attr("transform",(n,d)=>{const e=i.gridContainerPosition[d]??i.gridContainerPosition[0],l=e.translate,p=e.scale;return`translate(${l[0]}, ${l[1]}) scale(${p[0]}, ${p[1]})`})}),S({axisSelection:P,gridAxesTransform:R}).pipe(u(o),k(async i=>i)).subscribe(i=>{i.axisSelection.style("transform",i.gridAxesTransform.value)});const z=S({gridAxesReverseTransform:g,gridContainerPosition:a}).pipe(u(o),k(async i=>i),y(i=>{const n=`rotateX(${i.gridAxesReverseTransform.rotateX}deg) rotateY(${i.gridAxesReverseTransform.rotateY}deg)`,d=`rotate(${i.gridAxesReverseTransform.rotate}deg)`,e=`scale(${1/i.gridContainerPosition[0].scale[0]}, ${1/i.gridContainerPosition[0].scale[1]})`;return`${n} ${d} ${e}`}),Y()),D=S({textReverseTransform:z,fullParams:A}).pipe(u(o),k(async i=>i),y(i=>`${i.textReverseTransform} rotate(${i.fullParams.tickTextRotate}deg)`)),j=new q(i=>{S({fullDataFormatter:s,gridAxesSize:r,filteredMinMaxValue:f}).pipe(u(o),k(async n=>n)).subscribe(n=>{const d=F({maxValue:n.filteredMinMaxValue[1],minValue:n.filteredMinMaxValue[0],axisWidth:n.gridAxesSize.height,scaleDomain:n.fullDataFormatter.grid.valueAxis.scaleDomain,scaleRange:n.fullDataFormatter.grid.valueAxis.scaleRange});i.next(d)})}),M=S({fullDataFormatter:s,fullParams:A}).pipe(u(o),k(async i=>i),y(i=>{let n="start",d="hanging";return i.fullDataFormatter.grid.valueAxis.position==="left"?(n="end",d="middle"):i.fullDataFormatter.grid.valueAxis.position==="right"?(n="start",d="middle"):i.fullDataFormatter.grid.valueAxis.position==="bottom"?(n=i.fullParams.tickTextRotate?"end":"middle",d="hanging"):i.fullDataFormatter.grid.valueAxis.position==="top"&&(n=i.fullParams.tickTextRotate?"start":"middle",d="auto"),{textAnchor:n,dominantBaseline:d}})),X=s.pipe(u(o),y(i=>{let n="start",d="hanging";return i.grid.groupAxis.position==="bottom"?d="auto":i.grid.groupAxis.position==="top"?d="hanging":i.grid.groupAxis.position==="left"?n="start":i.grid.groupAxis.position==="right"&&(n="end"),i.grid.valueAxis.position==="left"?n="end":i.grid.valueAxis.position==="right"?n="start":i.grid.valueAxis.position==="bottom"?d="hanging":i.grid.valueAxis.position==="top"&&(d="auto"),{textAnchor:n,dominantBaseline:d}}));return S({axisSelection:P,fullParams:A,tickTextAlign:M,axisLabelAlign:X,computedData:t,gridAxesSize:r,fullDataFormatter:s,fullChartParams:v,valueScale:j,textReverseTransform:z,textReverseTransformWithRotate:D,filteredMinMaxValue:f}).pipe(u(o),k(async i=>i)).subscribe(i=>{te({selection:i.axisSelection,yAxisClassName:c,fullParams:i.fullParams,tickTextAlign:i.tickTextAlign,gridAxesSize:i.gridAxesSize,fullDataFormatter:i.fullDataFormatter,fullChartParams:i.fullChartParams,valueScale:i.valueScale,textReverseTransformWithRotate:i.textReverseTransformWithRotate,filteredMinMaxValue:i.filteredMinMaxValue}),ie({selection:i.axisSelection,textClassName:L,fullParams:i.fullParams,axisLabelAlign:i.axisLabelAlign,gridAxesSize:i.gridAxesSize,fullDataFormatter:i.fullDataFormatter,fullChartParams:i.fullChartParams,textReverseTransform:i.textReverseTransform})}),()=>{o.next(void 0)}};export{re as a,le as c};
