import{a as G,k as S,d as j,t as d,l as T,m as k,b as q,s as w,bd as L,bo as I,bp as E,be as Z,g as V,bg as F,bc as U,bq as H,aT as J,bk as K}from"./Bh8imPUI.js";import{t as Q}from"./CorttYm4.js";const _=6;function N(v,h){return v.map((i,u)=>{const A=U(i,h),s=typeof A=="string"?A.split(`
`):[A];return{text:A,textArr:s}})}function ee({selection:v,groupingLabelClassName:h,fullParams:i,axisLabelAlign:u,gridAxesSize:A,fullDataFormatter:s,chartParams:m,textReverseTransform:R}){const c=i.tickPadding+i.labelOffset[0],g=i.tickPadding+i.labelOffset[1];let r=0,n=0;s.groupAxis.position==="bottom"?(n=g,s.valueAxis.position==="left"?r=c:s.valueAxis.position==="right"&&(r=-c)):s.groupAxis.position==="top"?(n=-g,s.valueAxis.position==="left"?r=c:s.valueAxis.position==="right"&&(r=-c)):s.groupAxis.position==="left"?(r=-c,s.valueAxis.position==="bottom"?n=-g:s.valueAxis.position==="top"&&(n=g)):s.groupAxis.position==="right"&&(r=c,s.valueAxis.position==="bottom"?n=-g:s.valueAxis.position==="top"&&(n=g)),v.selectAll(`g.${h}`).data([i]).join("g").classed(h,!0).each((o,y,b)=>{w(b[y]).selectAll("text").data([o]).join(l=>l.append("text").style("font-weight","bold"),l=>l,l=>l.remove()).attr("text-anchor",u.textAnchor).attr("dominant-baseline",u.dominantBaseline).attr("font-size",m.styles.textSize).style("fill",L(i.labelColorType,m)).style("transform",R).attr("x",r).attr("y",n).text(l=>s.groupAxis.label)}).attr("transform",o=>`translate(${A.width}, 0)`)}function te({selection:v,xAxisClassName:h,fullParams:i,tickTextAlign:u,gridAxesSize:A,fullDataFormatter:s,chartParams:m,groupScale:R,groupScaleDomain:c,groupLabelData:g,textReverseTransformWithRotate:r,textSizePx:n}){const o=v.selectAll(`g.${h}`).data([i]).join("g").classed(h,!0),y=Math.floor(c[1])-Math.ceil(c[0])+1;let b=0,l=0;s.groupAxis.position==="left"?(b=0,l=-i.tickPadding):s.groupAxis.position==="right"?(b=0,l=i.tickPadding):s.groupAxis.position==="bottom"?(b=i.tickPadding,l=0):s.groupAxis.position==="top"&&(b=-i.tickPadding,l=-0);const M=I(R).scale(R).ticks(i.ticks==="all"||i.ticks>y?y:i.ticks).tickSize(i.tickFullLine==!0?A.height:-_).tickSizeOuter(0).tickFormat(z=>{var C;return((C=g[z])==null?void 0:C.text)??""}).tickPadding(b),$=o.transition().duration(100).ease(E).call(M).on("end",(z,C)=>{o.selectAll(".tick text").each((P,Y,t)=>{var p;const a=((p=g[P])==null?void 0:p.textArr)??[];Z(w(t[Y]),{textArr:a,textSizePx:n,groupAxisPosition:s.groupAxis.position})})});return $.selectAll("line").style("fill","none").style("stroke",i.tickLineVisible==!0?L(i.tickColorType,m):"none").style("stroke-dasharray",i.tickFullLineDasharray).style("vector-effect","non-scaling-stroke").attr("pointer-events","none"),$.selectAll("path").style("fill","none").style("stroke",i.axisLineVisible==!0?L(i.axisLineColorType,m):"none").style("shape-rendering","crispEdges"),o.selectAll("text").attr("font-size",m.styles.textSize).attr("fill",L(i.tickTextColorType,m)).attr("text-anchor",u.textAnchor).attr("dominant-baseline",u.dominantBaseline).attr("x",l).style("transform",r).attr("dy",0),o}const le=(v,{selection:h,computedData$:i,fullParams$:u,fullDataFormatter$:A,fullChartParams$:s,gridAxesTransform$:m,gridAxesReverseTransform$:R,gridAxesSize$:c,gridContainerPosition$:g,isSeriesSeprate$:r,textSizePx$:n})=>{const o=new G,y=V(v,"container"),b=V(v,"xAxisG"),l=V(v,"xAxis"),M=V(v,"groupingLabel"),$=S({computedData:i.pipe(j((e,x)=>e.length===x.length)),isSeriesSeprate:r}).pipe(d(o),T(async e=>e),k(e=>e.isSeriesSeprate?e.computedData:[e.computedData[0]]),k((e,x)=>h.selectAll(`g.${y}`).data(e,f=>f[0]?f[0].seriesIndex:x).join("g").classed(y,!0))),D=$.pipe(d(o),k((e,x)=>e.selectAll(`g.${b}`).data([b]).join("g").classed(b,!0)));S({containerSelection:$,gridContainerPosition:g}).pipe(d(o),T(async e=>e)).subscribe(e=>{e.containerSelection.attr("transform",(x,f)=>{const X=e.gridContainerPosition[f]??e.gridContainerPosition[0],W=X.translate,O=X.scale;return`translate(${W[0]}, ${W[1]}) scale(${O[0]}, ${O[1]})`})}),S({axisSelection:D,gridAxesTransform:m}).pipe(d(o),T(async e=>e)).subscribe(e=>{e.axisSelection.style("transform",e.gridAxesTransform.value)});const z=S({gridAxesReverseTransform:R,gridContainerPosition:g}).pipe(d(o),T(async e=>e),k(e=>{const x=`rotateX(${e.gridAxesReverseTransform.rotateX}deg) rotateY(${e.gridAxesReverseTransform.rotateY}deg)`,f=`rotate(${e.gridAxesReverseTransform.rotate}deg)`,X=`scale(${1/e.gridContainerPosition[0].scale[0]}, ${1/e.gridContainerPosition[0].scale[1]})`;return`${x} ${f} ${X}`}),j()),C=S({textReverseTransform:z,fullParams:u}).pipe(d(o),T(async e=>e),k(e=>`${e.textReverseTransform} rotate(${e.fullParams.tickTextRotate}deg)`)),P=S({fullDataFormatter:A,gridAxesSize:c,computedData:i}).pipe(d(o),T(async e=>e),k(e=>{const x=e.computedData[0]?e.computedData[0].length-1:0,f=e.fullDataFormatter.groupAxis.scaleDomain[0]-e.fullDataFormatter.groupAxis.scalePadding,X=e.fullDataFormatter.groupAxis.scaleDomain[1]==="max"?x+e.fullDataFormatter.groupAxis.scalePadding:e.fullDataFormatter.groupAxis.scaleDomain[1]+e.fullDataFormatter.groupAxis.scalePadding;return[f,X]}),q(1)),Y=S({groupScaleDomain:P,gridAxesSize:c}).pipe(d(o),T(async e=>e),k(e=>F().domain(e.groupScaleDomain).range([0,e.gridAxesSize.width]))),t=i.pipe(k(e=>(e[0]??[]).map(x=>x.groupLabel))),a=S({fullDataFormatter:A,fullParams:u}).pipe(d(o),T(async e=>e),k(e=>{let x="middle",f="hanging";return e.fullDataFormatter.groupAxis.position==="bottom"?(x=e.fullParams.tickTextRotate?"end":"middle",f="hanging"):e.fullDataFormatter.groupAxis.position==="top"?(x=e.fullParams.tickTextRotate?"start":"middle",f="auto"):e.fullDataFormatter.groupAxis.position==="left"?(x="end",f="middle"):e.fullDataFormatter.groupAxis.position==="right"&&(x="start",f="middle"),{textAnchor:x,dominantBaseline:f}})),p=A.pipe(d(o),k(e=>{let x="start",f="hanging";return e.groupAxis.position==="bottom"?f="hanging":e.groupAxis.position==="top"?f="auto":e.groupAxis.position==="left"?x="end":e.groupAxis.position==="right"&&(x="start"),e.valueAxis.position==="left"?x="start":e.valueAxis.position==="right"?x="end":e.valueAxis.position==="bottom"?f="auto":e.valueAxis.position==="top"&&(f="hanging"),{textAnchor:x,dominantBaseline:f}})),B=S({groupLabels:t,fullParams:u}).pipe(d(o),T(async e=>e),k(e=>N(e.groupLabels,e.fullParams.tickFormat)));return S({axisSelection:D,fullParams:u,tickTextAlign:a,axisLabelAlign:p,gridAxesSize:c,fullDataFormatter:A,chartParams:s,groupScale:Y,groupScaleDomain:P,groupLabelData:B,textReverseTransform:z,textReverseTransformWithRotate:C,textSizePx:n}).pipe(d(o),T(async e=>e)).subscribe(e=>{te({selection:e.axisSelection,xAxisClassName:l,fullParams:e.fullParams,tickTextAlign:e.tickTextAlign,gridAxesSize:e.gridAxesSize,fullDataFormatter:e.fullDataFormatter,chartParams:e.chartParams,groupScale:e.groupScale,groupScaleDomain:e.groupScaleDomain,groupLabelData:e.groupLabelData,textReverseTransformWithRotate:e.textReverseTransformWithRotate,textSizePx:e.textSizePx}),ee({selection:e.axisSelection,groupingLabelClassName:M,fullParams:e.fullParams,axisLabelAlign:e.axisLabelAlign,gridAxesSize:e.gridAxesSize,fullDataFormatter:e.fullDataFormatter,chartParams:e.chartParams,textReverseTransform:e.textReverseTransform})}),()=>{o.next(void 0)}},ie=6;function se({selection:v,textClassName:h,fullParams:i,axisLabelAlign:u,gridAxesSize:A,fullDataFormatter:s,fullChartParams:m,textReverseTransform:R}){const c=i.tickPadding-i.labelOffset[0],g=i.tickPadding+i.labelOffset[1];let r=0,n=0;s.groupAxis.position==="bottom"?(n=-g,s.valueAxis.position==="left"?r=-c:s.valueAxis.position==="right"&&(r=c)):s.groupAxis.position==="top"?(n=g,s.valueAxis.position==="left"?r=-c:s.valueAxis.position==="right"&&(r=c)):s.groupAxis.position==="left"?(r=c,s.valueAxis.position==="bottom"?n=g:s.valueAxis.position==="top"&&(n=-g)):s.groupAxis.position==="right"&&(r=-c,s.valueAxis.position==="bottom"?n=g:s.valueAxis.position==="top"&&(n=-g)),v.selectAll(`g.${h}`).data([i]).join("g").classed(h,!0).each((o,y,b)=>{w(b[y]).selectAll("text").data([o]).join(l=>l.append("text").style("font-weight","bold"),l=>l,l=>l.remove()).attr("text-anchor",u.textAnchor).attr("dominant-baseline",u.dominantBaseline).attr("font-size",m.styles.textSize).style("fill",L(i.labelColorType,m)).style("transform",R).attr("x",r).attr("y",n).text(l=>s.valueAxis.label)}).attr("transform",o=>`translate(0, ${A.height})`)}function oe({selection:v,yAxisClassName:h,fullParams:i,tickTextAlign:u,gridAxesSize:A,fullDataFormatter:s,fullChartParams:m,valueScale:R,textReverseTransformWithRotate:c,filteredMinMaxValue:g}){const r=v.selectAll(`g.${h}`).data([i]).join("g").classed(h,!0);let n=0,o=0;s.valueAxis.position==="left"?(n=i.tickPadding,o=0):s.valueAxis.position==="right"?(n=-i.tickPadding,o=0):s.valueAxis.position==="bottom"?(n=0,o=i.tickPadding):s.valueAxis.position==="top"&&(n=0,o=-i.tickPadding);const y=H(R).scale(R).ticks(i.ticks).tickFormat(M=>U(M,i.tickFormat)).tickSize(i.tickFullLine==!0?-A.width:ie).tickPadding(n),b=r.transition().duration(100).ease(E).call(y);b.selectAll("line").style("fill","none").style("stroke",i.tickLineVisible==!0?L(i.tickColorType,m):"none").style("stroke-dasharray",i.tickFullLineDasharray).style("vector-effect","non-scaling-stroke").attr("pointer-events","none"),b.selectAll("path").style("fill","none").style("stroke",i.axisLineVisible==!0?L(i.axisLineColorType,m):"none").style("shape-rendering","crispEdges");const l=r.selectAll("text").attr("font-size",m.styles.textSize).style("color",L(i.tickTextColorType,m)).attr("text-anchor",u.textAnchor).attr("dominant-baseline",u.dominantBaseline).attr("y",o).attr("dy",0);return l.style("transform",c),(s.valueAxis.position==="bottom"||s.valueAxis.position==="top")&&l.attr("dy",0),r}const ae=(v,{selection:h,computedData$:i,filteredMinMaxValue$:u,fullParams$:A,fullDataFormatter$:s,fullChartParams$:m,gridAxesSize$:R,gridAxesTransform$:c,gridAxesReverseTransform$:g,gridContainerPosition$:r,isSeriesSeprate$:n})=>{const o=new G,y=V(v,"yAxisG"),b=V(v,"yAxis"),l=V(v,"text"),$=Q({selection:h,pluginName:v,computedData$:i,gridContainerPosition$:r,isSeriesSeprate$:n}).pipe(d(o),k((t,a)=>t.selectAll(`g.${y}`).data([y]).join("g").classed(y,!0)));S({axisSelection:$,gridAxesTransform:c}).pipe(d(o),T(async t=>t)).subscribe(t=>{t.axisSelection.style("transform",t.gridAxesTransform.value)});const D=S({gridAxesReverseTransform:g,gridContainerPosition:r}).pipe(d(o),T(async t=>t),k(t=>{const a=`rotateX(${t.gridAxesReverseTransform.rotateX}deg) rotateY(${t.gridAxesReverseTransform.rotateY}deg)`,p=`rotate(${t.gridAxesReverseTransform.rotate}deg)`,B=`scale(${1/t.gridContainerPosition[0].scale[0]}, ${1/t.gridContainerPosition[0].scale[1]})`;return`${a} ${p} ${B}`}),j()),z=S({textReverseTransform:D,fullParams:A}).pipe(d(o),T(async t=>t),k(t=>`${t.textReverseTransform} rotate(${t.fullParams.tickTextRotate}deg)`)),C=new J(t=>{S({fullDataFormatter:s,gridAxesSize:R,filteredMinMaxValue:u}).pipe(d(o),T(async a=>a)).subscribe(a=>{let p=a.filteredMinMaxValue[1],B=a.filteredMinMaxValue[0];p===B&&p===0&&(p=1);const e=K({maxValue:p,minValue:B,axisWidth:a.gridAxesSize.height,scaleDomain:a.fullDataFormatter.valueAxis.scaleDomain,scaleRange:a.fullDataFormatter.valueAxis.scaleRange});t.next(e)})}),P=S({fullDataFormatter:s,fullParams:A}).pipe(d(o),T(async t=>t),k(t=>{let a="start",p="hanging";return t.fullDataFormatter.valueAxis.position==="left"?(a="end",p="middle"):t.fullDataFormatter.valueAxis.position==="right"?(a="start",p="middle"):t.fullDataFormatter.valueAxis.position==="bottom"?(a=t.fullParams.tickTextRotate?"end":"middle",p="hanging"):t.fullDataFormatter.valueAxis.position==="top"&&(a=t.fullParams.tickTextRotate?"start":"middle",p="auto"),{textAnchor:a,dominantBaseline:p}})),Y=s.pipe(d(o),k(t=>{let a="start",p="hanging";return t.groupAxis.position==="bottom"?p="auto":t.groupAxis.position==="top"?p="hanging":t.groupAxis.position==="left"?a="start":t.groupAxis.position==="right"&&(a="end"),t.valueAxis.position==="left"?a="end":t.valueAxis.position==="right"?a="start":t.valueAxis.position==="bottom"?p="hanging":t.valueAxis.position==="top"&&(p="auto"),{textAnchor:a,dominantBaseline:p}}));return S({axisSelection:$,fullParams:A,tickTextAlign:P,axisLabelAlign:Y,computedData:i,gridAxesSize:R,fullDataFormatter:s,fullChartParams:m,valueScale:C,textReverseTransform:D,textReverseTransformWithRotate:z,filteredMinMaxValue:u}).pipe(d(o),T(async t=>t)).subscribe(t=>{oe({selection:t.axisSelection,yAxisClassName:b,fullParams:t.fullParams,tickTextAlign:t.tickTextAlign,gridAxesSize:t.gridAxesSize,fullDataFormatter:t.fullDataFormatter,fullChartParams:t.fullChartParams,valueScale:t.valueScale,textReverseTransformWithRotate:t.textReverseTransformWithRotate,filteredMinMaxValue:t.filteredMinMaxValue}),se({selection:t.axisSelection,textClassName:l,fullParams:t.fullParams,axisLabelAlign:t.axisLabelAlign,gridAxesSize:t.gridAxesSize,fullDataFormatter:t.fullDataFormatter,fullChartParams:t.fullChartParams,textReverseTransform:t.textReverseTransform})}),()=>{o.next(void 0)}};export{le as a,ae as c};
