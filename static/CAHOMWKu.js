import{e as B,_ as H,i as X,f as q,O as R,g as L,d as z,S as C,t as D,m as v,b as E,c as M,s as G,j as J,a as U,r as Q}from"./C8v8pqyL.js";import{c as Y,d as K,e as Z,f as j}from"./D847ITmk.js";import{m as ee,a as te,c as re,b as ae}from"./DOxCyvvz.js";import{z as ie,g as N,c as I,p as oe,d as ne}from"./DupVaP3I.js";import{f as se}from"./CD1OHH6o.js";import{g as le}from"./BUC-jAqX.js";import{f as ue}from"./DDEp8uPc.js";var ge=["addListener","removeListener"],pe=["addEventListener","removeEventListener"],me=["on","off"];function b(a,l,r,o){if(L(r)&&(o=r,r=void 0),o)return b(a,l,r).pipe(B(o));var n=H(xe(a)?pe.map(function(s){return function(d){return a[s](l,d,r)}}):ce(a)?ge.map(_(a,l)):de(a)?me.map(_(a,l)):[],2),u=n[0],m=n[1];if(!u&&X(a))return ee(function(s){return b(s,l,r)})(q(a));if(!u)throw new TypeError("Invalid event target");return new R(function(s){var d=function(){for(var t=[],f=0;f<arguments.length;f++)t[f]=arguments[f];return s.next(1<t.length?t:t[0])};return u(d),function(){return m(d)}})}function _(a,l){return function(r){return function(o){return a[r](l,o)}}}function ce(a){return L(a.addListener)&&L(a.removeListener)}function de(a){return L(a.on)&&L(a.off)}function xe(a){return L(a.addEventListener)&&L(a.removeEventListener)}const V="GroupAxis",Ce=z(V,Y)(({selection:a,name:l,observer:r,subject:o})=>{const n=new C,u=te(V,{selection:a,computedData$:r.computedData$,fullParams$:r.fullParams$,fullDataFormatter$:r.fullDataFormatter$,fullChartParams$:r.fullChartParams$,gridAxesTransform$:r.gridAxesTransform$,gridAxesReverseTransform$:r.gridAxesReverseTransform$,gridAxesSize$:r.gridAxesSize$,gridContainer$:r.gridContainer$,isSeriesPositionSeprate$:r.isSeriesPositionSeprate$});return()=>{n.next(void 0),u()}}),O="ValueAxis",Ne=z(O,K)(({selection:a,name:l,observer:r,subject:o})=>{const n=new C,u=re(O,{selection:a,computedData$:r.computedData$,fullParams$:r.fullParams$,fullDataFormatter$:r.fullDataFormatter$,fullChartParams$:r.fullChartParams$,gridAxesTransform$:r.gridAxesTransform$,gridAxesReverseTransform$:r.gridAxesReverseTransform$,gridAxesSize$:r.gridAxesSize$,gridContainer$:r.gridContainer$,isSeriesPositionSeprate$:r.isSeriesPositionSeprate$});return()=>{n.next(void 0),u()}}),W="ScalingArea",fe=N(W,"rect"),Ee=z(W,Z)(({selection:a,rootSelection:l,name:r,observer:o,subject:n})=>{const u=new C,m=l.insert("rect","g").classed(fe,!0).attr("opacity",0);let s={k:1,x:0,y:0};o.layout$.pipe(D(u)).subscribe(t=>{m.attr("width",t.width).attr("height",t.height).attr("x",t.left).attr("y",t.top)});const d=o.computedData$.pipe(v(t=>t[0]?t[0].length-1:0),E());return M({initGroupAxis:o.fullDataFormatter$.pipe(v(t=>t.grid.groupAxis),se()),fullDataFormatter:o.fullDataFormatter$,groupMaxIndex:d,layout:o.layout$,axisSize:o.gridAxesSize$}).pipe(D(u),G(async t=>t)).subscribe(t=>{const S=t.groupMaxIndex,e=t.initGroupAxis.scaleDomain[0]==="auto"?0-t.initGroupAxis.scalePadding:t.initGroupAxis.scaleDomain[0]-t.initGroupAxis.scalePadding,i=t.initGroupAxis.scaleDomain[1]==="auto"?S+t.initGroupAxis.scalePadding:t.initGroupAxis.scaleDomain[1]+t.initGroupAxis.scalePadding,h=t.fullDataFormatter.grid.valueAxis.position==="left"||t.fullDataFormatter.grid.valueAxis.position==="top"?[0,1]:[1,0],p=J({maxValue:t.groupMaxIndex,minValue:0,axisWidth:t.axisSize.width,scaleDomain:[e,i],scaleRange:h}).copy(),c=ie().on("zoom",function($){const g=$.transform,T=F=>{const y=Math.round(F);return Math.min(S,Math.max(0,y))},P=t.fullDataFormatter.grid.groupAxis.position==="bottom"||t.fullDataFormatter.grid.groupAxis.position==="top"?g.rescaleX(p).domain().map(T):g.rescaleY(p).domain().map(T);P[0]<=0&&P[1]>=S?g.k<s.k&&(g.k=s.k,g.x=s.x,g.y=s.y):P[1]-P[0]<=1&&g.k>s.k&&(g.k=s.k,g.x=s.x,g.y=s.y),s.k=g.k,s.x=g.x,s.y=g.y,n.dataFormatter$.next({...t.fullDataFormatter,grid:{...t.fullDataFormatter.grid,groupAxis:{...t.fullDataFormatter.grid.groupAxis,scaleDomain:P}}})});l.call(c)}),()=>{u.next(void 0),m.remove()}});function he(a,l){let r=new R(()=>{});return a.each(function(){const o=b(this,l);r=ae(r,o)}),r}const w="GroupAux",k=N(w,"label-box");function $e({groupLabel:a,axisX:l,axisHeight:r,fullParams:o}){return o.showLine&&a?[{id:a,x1:l,x2:l,y1:0,y2:r}]:[]}function Ae({selection:a,pluginName:l,lineData:r,fullParams:o,fullChartParams:n}){const u=N(l,"auxline"),m=a.selectAll(`line.${u}`).data(r),s=m.enter().append("line").classed(u,!0).style("stroke",t=>I(o.lineColorType,n)).style("stroke-width",1).style("stroke-dasharray",o.lineDashArray??"none").style("pointer-events","none"),d=m.merge(s);return m.exit().remove(),s.attr("x1",t=>t.x1).attr("y1",t=>t.y1).attr("x2",t=>t.x2).attr("y2",t=>t.y2),m.transition().duration(50).attr("x1",t=>t.x1).attr("y1",t=>t.y1).attr("x2",t=>t.x2).attr("y2",t=>t.y2),d}function De(a){a.selectAll("line").data([]).exit().remove()}function ye({groupLabel:a,axisX:l,fullParams:r}){return r.showLabel&&a?[{id:a,x:l,y:-r.labelPadding,text:oe(a,r.labelTextFormat)}]:[]}function Se({selection:a,labelData:l,fullParams:r,fullChartParams:o,gridAxesReverseTransformValue:n}){const u=o.styles.textSize+4,m=a.selectAll(`g.${k}`).data(l),s=m.enter().append("g").classed(k,!0).style("cursor","pointer"),d=s.merge(m);return s.attr("transform",(t,f)=>`translate(${t.x}, ${t.y})`),m.transition().duration(50).attr("transform",(t,f)=>`translate(${t.x}, ${t.y})`),m.exit().remove(),d.each((t,f,S)=>{const e=ne(t.text,o.styles.textSize)+12,i=-e/2,h=U(S[f]).selectAll("rect").data([t]),x=h.enter().append("rect").attr("height",`${u}px`).attr("fill",A=>I(r.labelColorType,o)).attr("x",i).attr("y",-2).attr("rx",5).attr("ry",5).style("cursor","pointer");h.merge(x).attr("width",A=>`${e}px`).style("transform",n),h.exit().remove();const p=U(S[f]).selectAll("text").data([t]),c=p.enter().append("text").style("dominant-baseline","hanging").style("cursor","pointer");p.merge(c).text(A=>A.text).style("transform",n).attr("fill",A=>I(r.labelTextColorType,o)).attr("font-size",o.styles.textSize).attr("x",i+6),p.exit().remove()}),d}function Pe(a){a.selectAll(`g.${k}`).data([]).exit().remove()}const Ie=z(w,j)(({selection:a,rootSelection:l,name:r,subject:o,observer:n})=>{const u=new C,m=l.insert("rect","g").classed(N(w,"rect"),!0).attr("opacity",0),s=a.append("g");n.layout$.pipe(D(u)).subscribe(e=>{m.attr("width",e.rootWidth).attr("height",e.rootHeight)}),n.gridAxesTransform$.pipe(D(u),v(e=>e.value),E()).subscribe(e=>{s.style("transform",e)});const d=new R(e=>{M({fullDataFormatter:n.fullDataFormatter$,gridAxesSize:n.gridAxesSize$,computedData:n.computedData$}).pipe(D(u),G(async i=>i)).subscribe(i=>{const x=i.computedData[0]?i.computedData[0].length-1:0,p=i.fullDataFormatter.grid.groupAxis.scaleDomain[0]==="auto"?0-i.fullDataFormatter.grid.groupAxis.scalePadding:i.fullDataFormatter.grid.groupAxis.scaleDomain[0]-i.fullDataFormatter.grid.groupAxis.scalePadding,c=i.fullDataFormatter.grid.groupAxis.scaleDomain[1]==="auto"?x+i.fullDataFormatter.grid.groupAxis.scalePadding:i.fullDataFormatter.grid.groupAxis.scaleDomain[1]+i.fullDataFormatter.grid.groupAxis.scalePadding,A=i.computedData[0]?i.computedData[0].length:0;let $=i.fullDataFormatter.grid.gridData.seriesDirection==="row"?(i.computedData[0]??[]).map(F=>F.groupLabel):i.computedData.map(F=>F[0].groupLabel);const g=new Array(A).fill(0).map((F,y)=>$[y]!=null?$[y]:String(y)).filter((F,y)=>y>=p&&y<=c),T=i.fullDataFormatter.grid.groupAxis.scalePadding,P=Q({axisLabels:g,axisWidth:i.gridAxesSize.width,padding:T});e.next(P)})}),t=le({fullDataFormatter$:n.fullDataFormatter$,gridAxesSize$:n.gridAxesSize$,computedData$:n.computedData$,fullChartParams$:n.fullChartParams$}),f=n.fullChartParams$.pipe(D(u),v(e=>e.highlightTarget),E());return M({computedData:n.computedData$,gridAxesSize:n.gridAxesSize$,fullParams:n.fullParams$,fullChartParams:n.fullChartParams$,highlightTarget:f,SeriesDataMap:n.SeriesDataMap$,GroupDataMap:n.GroupDataMap$,gridGroupPositionFn:t,groupScale:d}).pipe(D(u),G(async e=>e)).subscribe(e=>{l.on("mouseover",(i,h)=>{const{groupIndex:x,groupLabel:p}=e.gridGroupPositionFn(i);o.event$.next({type:"grid",pluginName:r,eventName:"mouseover",highlightTarget:e.highlightTarget,datum:null,series:[],seriesIndex:-1,seriesLabel:"",groups:e.GroupDataMap.get(p)??[],groupIndex:x,groupLabel:p,event:i,data:e.computedData})}).on("mousemove",(i,h)=>{const{groupIndex:x,groupLabel:p}=e.gridGroupPositionFn(i);o.event$.next({type:"grid",pluginName:r,eventName:"mousemove",highlightTarget:e.highlightTarget,datum:null,series:[],seriesIndex:-1,seriesLabel:"",groups:e.GroupDataMap.get(p)??[],groupIndex:x,groupLabel:p,event:i,data:e.computedData})}).on("mouseout",(i,h)=>{const{groupIndex:x,groupLabel:p}=e.gridGroupPositionFn(i);o.event$.next({type:"grid",pluginName:r,eventName:"mouseout",highlightTarget:e.highlightTarget,datum:null,series:[],seriesIndex:-1,seriesLabel:"",groups:e.GroupDataMap.get(p)??[],groupIndex:x,groupLabel:p,event:i,data:e.computedData})}).on("click",(i,h)=>{i.stopPropagation();const{groupIndex:x,groupLabel:p}=e.gridGroupPositionFn(i);o.event$.next({type:"grid",pluginName:r,eventName:"click",highlightTarget:e.highlightTarget,datum:null,series:[],seriesIndex:-1,seriesLabel:"",groups:e.GroupDataMap.get(p)??[],groupIndex:x,groupLabel:p,event:i,data:e.computedData})})}),M({event:o.event$.pipe(ue(e=>e.eventName==="mouseover"||e.eventName==="mousemove")),computedData:n.computedData$,groupScale:d,gridAxesSize:n.gridAxesSize$,fullParams:n.fullParams$,fullChartParams:n.fullChartParams$,highlightTarget:f,gridAxesReverseTransform:n.gridAxesReverseTransform$,GroupDataMap:n.GroupDataMap$,gridGroupPositionFn:t}).pipe(D(u),G(async e=>e)).subscribe(e=>{const i=e.groupScale(e.event.groupLabel)??0,h=$e({groupLabel:e.event.groupLabel,axisX:i,axisHeight:e.gridAxesSize.height,fullParams:e.fullParams});Ae({selection:s,pluginName:r,lineData:h,fullParams:e.fullParams,fullChartParams:e.fullChartParams});const x=ye({groupLabel:e.event.groupLabel,axisX:i,fullParams:e.fullParams});Se({selection:s,labelData:x,fullParams:e.fullParams,fullChartParams:e.fullChartParams,gridAxesReverseTransformValue:e.gridAxesReverseTransform.value}).on("mouseover",(c,A)=>{const{groupIndex:$,groupLabel:g}=e.gridGroupPositionFn(c);o.event$.next({type:"grid",pluginName:r,eventName:"mouseover",highlightTarget:e.highlightTarget,datum:null,series:[],seriesIndex:-1,seriesLabel:"",groups:e.event.groups,groupIndex:$,groupLabel:g,event:c,data:e.computedData})}).on("mousemove",(c,A)=>{const{groupIndex:$,groupLabel:g}=e.gridGroupPositionFn(c);o.event$.next({type:"grid",pluginName:r,eventName:"mousemove",highlightTarget:e.highlightTarget,datum:null,series:[],seriesIndex:-1,seriesLabel:"",groups:e.event.groups,groupIndex:$,groupLabel:g,event:c,data:e.computedData})}).on("mouseout",(c,A)=>{const{groupIndex:$,groupLabel:g}=e.gridGroupPositionFn(c);o.event$.next({type:"grid",pluginName:r,eventName:"mouseout",highlightTarget:e.highlightTarget,datum:null,series:[],seriesIndex:-1,seriesLabel:"",groups:e.event.groups,groupIndex:$,groupLabel:g,event:c,data:e.computedData})}).on("click",(c,A)=>{const{groupIndex:$,groupLabel:g}=e.gridGroupPositionFn(c);o.event$.next({type:"grid",pluginName:r,eventName:"click",highlightTarget:e.highlightTarget,datum:null,series:[],seriesIndex:-1,seriesLabel:"",groups:e.event.groups,groupIndex:$,groupLabel:g,event:c,data:e.computedData})})}),he(m,"mouseout").pipe(D(u)).subscribe(e=>{console.log("rootMouseout"),De(s),Pe(s)}),()=>{u.next(void 0),m.remove()}}),be=[[55,80,50,11,150],[35,40,15,65,120],[75,90,600,50,120],[50,60,445,80,110]];export{Ce as G,Ee as S,Ne as V,Ie as a,be as g};
