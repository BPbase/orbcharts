import{_ as y,N as C,S as x,t as m,s as S,m as f,h as E,o as b,p as d}from"./DV8HSiku.js";import{g as N}from"./B_K1eqUP.js";import{s as A}from"./C5ay_BAq.js";const h="PieEventTexts",P=N(h,"text");function $(c,a){const t=c.selectAll(`text.${P}`).data(a),l=t.enter().append("text").classed(P,!0),r=t.merge(l);return r.each((e,i,o)=>{const n=S(o[i]).text(e.text);Object.keys(e.attr).forEach(s=>{n.attr(s,e.attr[s])}),Object.keys(e.style).forEach(s=>{n.style(s,e.style[s])})}),t.exit().remove(),r}function g({eventData:c,eventName:a,t,eventFn:l,textAttrs:r,textStyles:e}){return l(c,a,t).map((o,n)=>({text:o,attr:r[n],style:e[n]}))}function F(c,a){const t=new x;let l;const r=a.fullChartParams$.pipe(m(t),f(e=>e.highlightTarget),E());return b({computedData:a.computedData$,fullParams:a.fullParams$,fullChartParams:a.fullChartParams$,highlightTarget:r}).pipe(m(t),d(async e=>e)).subscribe(e=>{a.containerSelection.transition("move").duration(e.fullChartParams.transitionDuration).tween("move",(i,o)=>n=>{const s=g({eventData:{type:"series",pluginName:c,eventName:"transitionMove",event:i,highlightTarget:e.highlightTarget,data:e.computedData,series:[],seriesIndex:-1,seriesLabel:"",datum:null},eventName:"transitionMove",t:n,eventFn:e.fullParams.eventFn,textAttrs:e.fullParams.textAttrs,textStyles:e.fullParams.textStyles});$(a.containerSelection,s)}).on("end",(i,o)=>{const n=g({eventData:{type:"series",pluginName:c,eventName:"transitionEnd",event:i,highlightTarget:e.highlightTarget,data:e.computedData,series:[],seriesIndex:-1,seriesLabel:"",datum:null},eventName:"transitionMove",t:1,eventFn:e.fullParams.eventFn,textAttrs:e.fullParams.textAttrs,textStyles:e.fullParams.textStyles});$(a.containerSelection,n),l&&l.unsubscribe(),l=a.event$.subscribe(s=>{const p=g({eventData:s,eventName:s.eventName,t:1,eventFn:e.fullParams.eventFn,textAttrs:e.fullParams.textAttrs,textStyles:e.fullParams.textStyles});$(a.containerSelection,p)})})}),()=>{t.next(void 0)}}const k=y(h,C)(({selection:c,name:a,observer:t,subject:l})=>{const r=new x,{seriesCenterSelection$:e}=A({selection:c,pluginName:h,separateSeries$:t.separateSeries$,seriesLabels$:t.seriesLabels$,seriesContainerPosition$:t.seriesContainerPosition$}),i=[];return e.pipe(m(r)).subscribe(o=>{i.forEach(n=>n()),o.each((n,s,p)=>{const v=S(p[s]),D=t.computedLayoutData$.pipe(m(r),f(u=>u[s]??u[0])),T=t.seriesContainerPosition$.pipe(m(r),f(u=>u[s]??u[0]));i[s]=F(h,{containerSelection:v,computedData$:t.computedData$,containerComputedLayoutData$:D,SeriesDataMap$:t.SeriesDataMap$,fullParams$:t.fullParams$,fullChartParams$:t.fullChartParams$,seriesHighlight$:t.seriesHighlight$,seriesContainerPosition$:T,event$:l.event$})})}),()=>{r.next(void 0),i.forEach(o=>o())}});export{k as P};
