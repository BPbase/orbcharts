import{S as H,t as m,m as S,d as E,n as R,o as I,s as O,at as ue,Z as V,H as ge,j as ce,z as de,ar as me,a1 as he,l as xe,e as $e,E as fe,aH as ye,aI as De}from"./D0O9ZvbE.js";import{c as ee,d as Ae,e as Se,f as Te,g as X,h as Le,i as Pe,j as q}from"./CLAZhRXT.js";import{m as ae,n as be,o as te,p as Ce}from"./CFQBDtsv.js";import{f as Ie}from"./GqbKohf6.js";import{c as Ge}from"./BdDsiTOs.js";import{c as Re}from"./sGXoH8me.js";import{b as Me}from"./DdT0iQQs.js";import{i as Be}from"./DHGdw7qu.js";function Fe(o="curveLinear",s){return Se().x(t=>t.axisX).y0(t=>s).y1(t=>t.axisY).curve(Te[o])}function _e(o){let s=[[]],t=0;for(let r in o){if(o[r].visible==!1||o[r].value===void 0||o[r].value===null){s[t].length&&(t++,s[t]=[]);continue}s[t].push(o[r])}return s}function we({selection:o,pathClassName:s,segmentData:t,areaPath:r,linearGradientIds:a,params:n}){return o.selectAll("path").data(t,(l,x)=>l.length?`${l[0].id}_${l[l.length-1].id}`:x).join(l=>l.append("path").classed(s,!0).attr("fill","none").style("vector-effect","non-scaling-stroke").style("cursor","pointer"),l=>l,l=>l.remove()).attr("fill",(l,x)=>l[0]?`url(#${a[l[0].seriesIndex]})`:"").attr("d",l=>r(l))}function ze({selection:o,seriesLabel:s,fullChartParams:t}){if(o.interrupt("highlight"),!s){o.transition("highlight").duration(200).style("opacity",1);return}o.each((r,a,n)=>{r===s?O(n[a]).style("opacity",1):O(n[a]).style("opacity",t.styles.unhighlightedOpacity)})}function Ee({defsSelection:o,computedData:s,linearGradientIds:t,params:r}){o.selectAll("linearGradient").data(s??[]).join(a=>a.append("linearGradient").attr("x1","0%").attr("x2","0%").attr("y1","100%").attr("y2","0%").attr("spreadMethod","pad"),a=>a,a=>a.remove()).attr("id",(a,n)=>a[0]?t[a[0].seriesIndex]:"").html((a,n)=>{const d=a[0]?a[0].color:"";return`
        <stop offset="0%"   stop-color="${d}" stop-opacity="${r.linearGradientOpacity[0]}"/>
        <stop offset="100%" stop-color="${d}" stop-opacity="${r.linearGradientOpacity[1]}"/>
      `})}function Oe({defsSelection:o,clipPathData:s,transitionDuration:t,transitionEase:r}){o.selectAll("clipPath").data(s).join(a=>a.append("clipPath"),a=>a,a=>a.remove()).attr("id",a=>a.id).each((a,n,d)=>{O(d[n]).selectAll("rect").data([a]).join(l=>{const x=l.append("rect");return x.transition().duration(t).ease(Ae(r)).tween("tween",(u,f,b)=>F=>{const T=u.width*F;x.attr("x",0).attr("y",0).attr("width",L=>T).attr("height",L=>L.height)}),x},l=>l.attr("x",0).attr("y",0).attr("width",x=>x.width).attr("height",x=>x.height),l=>l.remove())})}const ke=(o,{selection:s,computedData$:t,computedLayoutData$:r,visibleComputedData$:a,visibleComputedLayoutData$:n,seriesLabels$:d,SeriesDataMap$:l,GroupDataMap$:x,fullParams$:u,fullDataFormatter$:f,fullChartParams$:b,gridAxesTransform$:F,gridGraphicTransform$:T,gridAxesSize$:L,gridHighlight$:M,gridContainerPosition$:G,layout$:$,event$:_})=>{const P=new H,U=ee(o,"clipPath-box"),W=X(o,"path"),{seriesSelection$:e,axesSelection$:D,defsSelection$:g,graphicGSelection$:A}=ae({selection:s,pluginName:o,clipPathID:U,seriesLabels$:d,gridContainerPosition$:G,gridAxesTransform$:F,gridGraphicTransform$:T}),Y=T.pipe(m(P),S(i=>-i.translate[1]/i.scale[1])),j=new ue(i=>{const y=R({fullParams:u,valueAxisStart:Y}).pipe(m(P)).subscribe(h=>{const c=Fe(h.fullParams.lineCurve,h.valueAxisStart);i.next(c)});return()=>{y.unsubscribe()}}),Q=b.pipe(S(i=>i.transitionDuration),E()),C=b.pipe(S(i=>i.transitionEase),E());R({defsSelection:g,seriesLabels:d,axisSize:L,transitionDuration:Q,transitionEase:C}).pipe(m(P),I(async i=>i)).subscribe(i=>{const h=[{id:U,width:i.axisSize.width,height:i.axisSize.height}].concat(i.seriesLabels.map(c=>({id:`orbcharts__clipPath_${c}`,width:i.axisSize.width,height:i.axisSize.height})));Oe({defsSelection:i.defsSelection,clipPathData:h,transitionDuration:i.transitionDuration,transitionEase:i.transitionEase})});const k=t.pipe(S(i=>{const y=new Map;return i.flat().forEach(h=>y.set(h.id,h)),y})),se=be({fullDataFormatter$:f,gridAxesSize$:L,computedData$:t,fullChartParams$:b,gridContainerPosition$:G,layout$:$}),ne=b.pipe(m(P),S(i=>i.highlightTarget),E()),le=d.pipe(m(P),S(i=>i.map((y,h)=>ee(o,`lineargradient-${y}`)))),pe=R({graphicGSelection:A,defsSelection:g,visibleComputedLayoutData:n,linearGradientIds:le,areaPath:j,params:u}).pipe(m(P),I(async i=>i),S(i=>{let y=[];return i.graphicGSelection.each((h,c,B)=>{const N=_e(i.visibleComputedLayoutData[c]??[]);y[c]=we({selection:O(B[c]),pathClassName:W,areaPath:i.areaPath,segmentData:N,linearGradientIds:i.linearGradientIds,params:i.params}),Ee({defsSelection:i.defsSelection,computedData:i.visibleComputedLayoutData,linearGradientIds:i.linearGradientIds,params:i.params})}),y}));return R({pathSelectionArr:pe,computedData:t,SeriesDataMap:l,GroupDataMap:x,highlightTarget:ne,gridGroupPositionFn:se}).pipe(m(P),I(async i=>i)).subscribe(i=>{i.pathSelectionArr.forEach(y=>{y.on("mouseover",(h,c)=>{const B=c[0]?c[0].seriesLabel:"",{groupIndex:N,groupLabel:w}=i.gridGroupPositionFn(h),p=i.GroupDataMap.get(w).find(z=>z.seriesLabel===B)??c[0];_.next({type:"grid",eventName:"mouseover",pluginName:o,highlightTarget:i.highlightTarget,datum:p,gridIndex:p.gridIndex,series:i.SeriesDataMap.get(p.seriesLabel),seriesIndex:p.seriesIndex,seriesLabel:p.seriesLabel,groups:i.GroupDataMap.get(p.groupLabel),groupIndex:p.groupIndex,groupLabel:p.groupLabel,event:h,data:i.computedData})}).on("mousemove",(h,c)=>{const B=c[0]?c[0].seriesLabel:"",{groupIndex:N,groupLabel:w}=i.gridGroupPositionFn(h),p=i.GroupDataMap.get(w).find(z=>z.seriesLabel===B)??c[0];_.next({type:"grid",eventName:"mousemove",pluginName:o,highlightTarget:i.highlightTarget,datum:p,gridIndex:p.gridIndex,series:i.SeriesDataMap.get(p.seriesLabel),seriesIndex:p.seriesIndex,seriesLabel:p.seriesLabel,groups:i.GroupDataMap.get(p.groupLabel),groupIndex:p.groupIndex,groupLabel:p.groupLabel,event:h,data:i.computedData})}).on("mouseout",(h,c)=>{const B=c[0]?c[0].seriesLabel:"",{groupIndex:N,groupLabel:w}=i.gridGroupPositionFn(h),p=i.GroupDataMap.get(w).find(z=>z.seriesLabel===B)??c[0];_.next({type:"grid",eventName:"mouseout",pluginName:o,highlightTarget:i.highlightTarget,datum:p,gridIndex:p.gridIndex,series:i.SeriesDataMap.get(p.seriesLabel),seriesIndex:p.seriesIndex,seriesLabel:p.seriesLabel,groups:i.GroupDataMap.get(p.groupLabel),groupIndex:p.groupIndex,groupLabel:p.groupLabel,event:h,data:i.computedData})}).on("click",(h,c)=>{const B=c[0]?c[0].seriesLabel:"",{groupIndex:N,groupLabel:w}=i.gridGroupPositionFn(h),p=i.GroupDataMap.get(w).find(z=>z.seriesLabel===B)??c[0];_.next({type:"grid",eventName:"click",pluginName:o,highlightTarget:i.highlightTarget,datum:p,gridIndex:p.gridIndex,series:i.SeriesDataMap.get(p.seriesLabel),seriesIndex:p.seriesIndex,seriesLabel:p.seriesLabel,groups:i.GroupDataMap.get(p.groupLabel),groupIndex:p.groupIndex,groupLabel:p.groupLabel,event:h,data:i.computedData})})})}),b.pipe(m(P),Ie(i=>i.highlightTarget==="series"),I(i=>R({graphicGSelection:A,gridHighlight:M,DataMap:k,fullChartParams:b}).pipe(m(P),I(async y=>y)))).subscribe(i=>{const y=i.gridHighlight[0]?i.gridHighlight[0].seriesLabel:null;ze({selection:i.graphicGSelection,seriesLabel:y,fullChartParams:i.fullChartParams})}),()=>{P.next(void 0)}},ie="LineAreas",Ne={name:ie,defaultParams:ge,layerIndex:ce,validator:(o,{validateColumns:s})=>s(o,{lineCurve:{toBeTypes:["string"]},linearGradientOpacity:{toBe:"[number, number]",test:r=>Array.isArray(r)&&r.length===2&&typeof r[0]=="number"&&typeof r[1]=="number"}})},rt=V(Ne)(({selection:o,name:s,observer:t,subject:r})=>{const a=new H,n=ke(ie,{selection:o,computedData$:t.computedData$,visibleComputedData$:t.visibleComputedData$,computedLayoutData$:t.computedLayoutData$,visibleComputedLayoutData$:t.visibleComputedLayoutData$,seriesLabels$:t.seriesLabels$,SeriesDataMap$:t.SeriesDataMap$,GroupDataMap$:t.GroupDataMap$,fullParams$:t.fullParams$,fullDataFormatter$:t.fullDataFormatter$,fullChartParams$:t.fullChartParams$,gridAxesTransform$:t.gridAxesTransform$,gridGraphicTransform$:t.gridGraphicTransform$,gridAxesSize$:t.gridAxesSize$,gridHighlight$:t.gridHighlight$,gridContainerPosition$:t.gridContainerPosition$,allContainerPosition$:t.gridContainerPosition$,layout$:t.layout$,event$:r.event$});return()=>{a.next(void 0),n()}}),re="Dots",He={name:re,defaultParams:de,layerIndex:me,validator:(o,{validateColumns:s})=>s(o,{radius:{toBeTypes:["number"]},fillColorType:{toBeOption:"ColorType"},strokeColorType:{toBeOption:"ColorType"},strokeWidth:{toBeTypes:["number"]},onlyShowHighlighted:{toBeTypes:["boolean"]}})},ot=V(He)(({selection:o,name:s,subject:t,observer:r})=>{const a=new H,n=Ge(re,{selection:o,computedData$:r.computedData$,computedLayoutData$:r.computedLayoutData$,visibleComputedData$:r.visibleComputedData$,visibleComputedLayoutData$:r.visibleComputedLayoutData$,seriesLabels$:r.seriesLabels$,SeriesDataMap$:r.SeriesDataMap$,GroupDataMap$:r.GroupDataMap$,fullParams$:r.fullParams$,fullChartParams$:r.fullChartParams$,gridAxesTransform$:r.gridAxesTransform$,gridGraphicTransform$:r.gridGraphicTransform$,gridGraphicReverseScale$:r.gridGraphicReverseScale$,gridAxesSize$:r.gridAxesSize$,gridHighlight$:r.gridHighlight$,gridContainerPosition$:r.gridContainerPosition$,event$:t.event$});return()=>{a.next(void 0),n()}}),oe="ValueStackAxis",Ue={name:oe,defaultParams:he,layerIndex:xe,validator:(o,{validateColumns:s})=>s(o,{labelOffset:{toBe:"[number, number]",test:r=>Array.isArray(r)&&r.length===2&&typeof r[0]=="number"&&typeof r[1]=="number"},labelColorType:{toBeOption:"ColorType"},axisLineVisible:{toBeTypes:["boolean"]},axisLineColorType:{toBeOption:"ColorType"},ticks:{toBeTypes:["number","null"]},tickFormat:{toBeTypes:["string","Function"]},tickLineVisible:{toBeTypes:["boolean"]},tickPadding:{toBeTypes:["number"]},tickFullLine:{toBeTypes:["boolean"]},tickFullLineDasharray:{toBeTypes:["string"]},tickColorType:{toBeOption:"ColorType"},tickTextRotate:{toBeTypes:["number"]},tickTextColorType:{toBeOption:"ColorType"}})},st=V(Ue)(({selection:o,name:s,observer:t,subject:r})=>{const a=new H,n=Re(oe,{selection:o,computedData$:t.computedStackedData$,fullParams$:t.fullParams$,fullDataFormatter$:t.fullDataFormatter$,fullChartParams$:t.fullChartParams$,gridAxesTransform$:t.gridAxesTransform$,gridAxesReverseTransform$:t.gridAxesReverseTransform$,gridAxesSize$:t.gridAxesSize$,gridContainerPosition$:t.gridContainerPosition$,isSeriesSeprate$:t.isSeriesSeprate$});return()=>{a.next(void 0),n()}}),v="GroupAux",J=X(v,"label-box"),ve={name:v,defaultParams:fe,layerIndex:ye,validator:(o,{validateColumns:s})=>s(o,{showLine:{toBeTypes:["boolean"]},showLabel:{toBeTypes:["boolean"]},lineDashArray:{toBeTypes:["string"]},lineColorType:{toBeOption:"ColorType"},labelColorType:{toBeOption:"ColorType"},labelTextColorType:{toBeOption:"ColorType"},labelTextFormat:{toBeTypes:["string","Function"]},labelPadding:{toBeTypes:["number"]},labelRotate:{toBeTypes:["number"]}})};function Ve({groupLabel:o,axisX:s,axisHeight:t,fullParams:r}){return r.showLine&&o?[{id:o,x1:s,x2:s,y1:0,y2:t}]:[]}function Xe({groupLabel:o,axisX:s,fullParams:t,textSizePx:r}){const a=Le(o,t.labelTextFormat),n=a.split(`
`),d=n.reduce((u,f)=>f.length>u.length?f:u,""),l=Pe(d,r),x=r*n.length;return t.showLabel&&o?[{id:o,x:s,y:-t.labelPadding,text:a,textArr:n,textWidth:l,textHeight:x}]:[]}function We({selection:o,pluginName:s,lineData:t,fullParams:r,fullChartParams:a}){const n=X(s,"auxline"),d=o.selectAll(`line.${n}`).data(t),l=d.enter().append("line").classed(n,!0).style("stroke",u=>q(r.lineColorType,a)).style("stroke-width",1).style("stroke-dasharray",r.lineDashArray??"none").style("pointer-events","none"),x=d.merge(l);return d.exit().remove(),l.attr("x1",u=>u.x1).attr("y1",u=>u.y1).attr("x2",u=>u.x2).attr("y2",u=>u.y2),d.transition().duration(50).attr("x1",u=>u.x1).attr("y1",u=>u.y1).attr("x2",u=>u.x2).attr("y2",u=>u.y2),x}function Ye(o){o.selectAll("line").data([]).exit().remove()}function je({selection:o,labelData:s,fullParams:t,fullDataFormatter:r,fullChartParams:a,textReverseTransformWithRotate:n,textSizePx:d}){const l=o.selectAll(`g.${J}`).data(s),x=l.enter().append("g").classed(J,!0).style("cursor","pointer"),u=x.merge(l);return x.attr("transform",(f,b)=>`translate(${f.x}, ${f.y})`),l.transition().duration(50).attr("transform",(f,b)=>`translate(${f.x}, ${f.y})`),l.exit().remove(),u.each((f,b,F)=>{const T=f.textWidth+12,L=f.textHeight+6;let M=-T/2,G=-2;r.grid.groupAxis.position==="bottom"?(M=t.labelRotate?-T+L:-T/2,G=2):r.grid.groupAxis.position==="left"?(M=-T+2,G=-L/2):r.grid.groupAxis.position==="right"?(M=-2,G=-L/2):r.grid.groupAxis.position==="top"&&(M=t.labelRotate?-T+L:-T/2,G=-L+2),O(F[b]).selectAll("rect").data([f]).join($=>$.append("rect").style("cursor","pointer").attr("rx",5).attr("ry",5),$=>$,$=>$.remove()).attr("width",$=>`${T}px`).attr("height",`${L}px`).attr("fill",$=>q(t.labelColorType,a)).attr("x",M).attr("y",G-3).style("transform",n),O(F[b]).selectAll("text").data([f]).join($=>$.append("text").style("dominant-baseline","hanging").style("cursor","pointer"),$=>$,$=>$.remove()).style("transform",n).attr("fill",$=>q(t.labelTextColorType,a)).attr("font-size",a.styles.textSize).attr("x",M+6).attr("y",G).each(($,_,P)=>{Me(O(P[_]),{textArr:f.textArr,textSizePx:d,groupAxisPosition:r.grid.groupAxis.position})})}),u}function Ze(o){o.selectAll(`g.${J}`).data([]).exit().remove()}const nt=V(ve)(({selection:o,rootSelection:s,name:t,subject:r,observer:a})=>{const n=new H;let d=!1;const l=s.insert("rect","g").classed(X(v,"rect"),!0).attr("opacity",0),{seriesSelection$:x,axesSelection$:u,defsSelection$:f,graphicGSelection$:b}=ae({selection:o,pluginName:v,clipPathID:"test",seriesLabels$:a.isSeriesSeprate$.pipe(I(e=>Be(()=>e,a.seriesLabels$,a.seriesLabels$.pipe(S(D=>[D[0]]))))),gridContainerPosition$:a.gridContainerPosition$,gridAxesTransform$:a.gridAxesTransform$,gridGraphicTransform$:a.gridGraphicTransform$});a.layout$.pipe(m(n)).subscribe(e=>{l.attr("width",e.rootWidth).attr("height",e.rootHeight)});const F=R({fullDataFormatter:a.fullDataFormatter$,gridAxesSize:a.gridAxesSize$,computedData:a.computedData$}).pipe(m(n),I(async e=>e),S(e=>{const D=e.computedData[0]?e.computedData[0].length-1:0,g=e.fullDataFormatter.grid.groupAxis.scaleDomain[0]-e.fullDataFormatter.grid.groupAxis.scalePadding,A=e.fullDataFormatter.grid.groupAxis.scaleDomain[1]==="max"?D+e.fullDataFormatter.grid.groupAxis.scalePadding:e.fullDataFormatter.grid.groupAxis.scaleDomain[1]+e.fullDataFormatter.grid.groupAxis.scalePadding;return[g,A]}),$e(1)),T=R({groupScaleDomain:F,gridAxesSize:a.gridAxesSize$}).pipe(m(n),I(async e=>e),S(e=>De().domain(e.groupScaleDomain).range([0,e.gridAxesSize.width]))),L=a.fullChartParams$.pipe(m(n),S(e=>e.highlightTarget),E()),M=te(s,"mousemove").pipe(m(n)),G=R({gridAxesReverseTransform:a.gridAxesReverseTransform$,gridContainerPosition:a.gridContainerPosition$}).pipe(m(n),I(async e=>e),S(e=>{const D=`rotateX(${e.gridAxesReverseTransform.rotateX}deg) rotateY(${e.gridAxesReverseTransform.rotateY}deg)`,g=`rotate(${e.gridAxesReverseTransform.rotate}deg)`,A=`scale(${1/e.gridContainerPosition[0].scale[0]}, ${1/e.gridContainerPosition[0].scale[1]})`;return`${D} ${g} ${A}`}),E()),$=R({textReverseTransform:G,fullParams:a.fullParams$}).pipe(m(n),I(async e=>e),S(e=>`${e.textReverseTransform} rotate(${e.fullParams.labelRotate}deg)`)),_=a.gridContainerPosition$.pipe(m(n),S(e=>e.reduce((g,A)=>A.columnIndex>g?A.columnIndex:g,0)+1),E()),P=a.gridContainerPosition$.pipe(m(n),S(e=>e.reduce((g,A)=>A.rowIndex>g?A.rowIndex:g,0)+1),E()),U=Ce({rootSelection:s,fullDataFormatter$:a.fullDataFormatter$,gridAxesSize$:a.gridAxesSize$,computedData$:a.computedData$,fullChartParams$:a.fullChartParams$,gridContainerPosition$:a.gridContainerPosition$,layout$:a.layout$}).pipe(m(n));R({axesSelection:u,columnAmount:_,rowAmount:P,layout:a.layout$,rootMousemove:M,gridGroupPosition:U,computedData:a.computedData$,groupScale:T,gridAxesSize:a.gridAxesSize$,fullParams:a.fullParams$,fullDataFormatter:a.fullDataFormatter$,fullChartParams:a.fullChartParams$,highlightTarget:L,textReverseTransformWithRotate:$,GroupDataMap:a.GroupDataMap$,textSizePx:a.textSizePx$}).pipe(m(n),I(async e=>e)).subscribe(e=>{const{groupIndex:D,groupLabel:g}=e.gridGroupPosition,A=e.groupScale(D)??0,Y=Ve({groupLabel:g,axisX:A,axisHeight:e.gridAxesSize.height,fullParams:e.fullParams});We({selection:e.axesSelection,pluginName:t,lineData:Y,fullParams:e.fullParams,fullChartParams:e.fullChartParams});const j=Xe({groupLabel:g,axisX:A,fullParams:e.fullParams,textSizePx:e.textSizePx});je({selection:e.axesSelection,labelData:j,fullParams:e.fullParams,fullDataFormatter:e.fullDataFormatter,fullChartParams:e.fullChartParams,textReverseTransformWithRotate:e.textReverseTransformWithRotate,textSizePx:e.textSizePx}).on("mouseover",(C,k)=>{C.stopPropagation(),d=!0,r.event$.next({type:"grid",pluginName:t,eventName:"mouseover",highlightTarget:e.highlightTarget,datum:null,gridIndex:0,series:[],seriesIndex:-1,seriesLabel:"",groups:e.GroupDataMap.get(g)??[],groupIndex:D,groupLabel:g,event:C,data:e.computedData})}).on("mousemove",(C,k)=>{C.stopPropagation(),r.event$.next({type:"grid",pluginName:t,eventName:"mousemove",highlightTarget:e.highlightTarget,datum:null,gridIndex:0,series:[],seriesIndex:-1,seriesLabel:"",groups:e.GroupDataMap.get(g)??[],groupIndex:D,groupLabel:g,event:C,data:e.computedData})}).on("mouseout",(C,k)=>{C.stopPropagation(),d=!1,r.event$.next({type:"grid",pluginName:t,eventName:"mouseout",highlightTarget:e.highlightTarget,datum:null,gridIndex:0,series:[],seriesIndex:-1,seriesLabel:"",groups:e.GroupDataMap.get(g)??[],groupIndex:D,groupLabel:g,event:C,data:e.computedData})}).on("click",(C,k)=>{C.stopPropagation(),r.event$.next({type:"grid",pluginName:t,eventName:"click",highlightTarget:e.highlightTarget,datum:null,gridIndex:0,series:[],seriesIndex:-1,seriesLabel:"",groups:e.GroupDataMap.get(g)??[],groupIndex:D,groupLabel:g,event:C,data:e.computedData})})});const W=te(l,"mouseout").pipe(m(n));return R({rootRectMouseout:W,axesSelection:u}).pipe(m(n),I(async e=>e)).subscribe(e=>{setTimeout(()=>{d!=!0&&(Ye(e.axesSelection),Ze(e.axesSelection))})}),()=>{n.next(void 0),l.remove()}});export{ot as D,nt as G,rt as L,st as V,ke as c};
